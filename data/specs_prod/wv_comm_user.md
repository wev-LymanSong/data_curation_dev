we_mart.wv_comm_user
====================

# BASIC INFO

|**About**| ë‹´ë‹¹ì ìˆ˜ê¸° ì…ë ¥ í•„ìš” |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**|`part_comm_id`, `part_date`|
|**Created/ Last Updated At**|2021-11-29 / 2024-07-22|
|**Created By**|ë°•ìƒë¯¼|
|**Last Updated By**|ìœ¤ìƒí˜|
|**Collaborators**|ìœ¤ìƒí˜[26], ë°•ìƒë¯¼[4], ì†¡ì¬ì˜[1], êµ¬ë¯¼ì„œ[1], ì´í˜„ì§€[1], ë°•ìƒë¯¼[1]|

#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2021-12-01|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/cc3cd0becda316e17d965e85bf6078d2de2fd217)|
|2021-12-09|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/e478ed7251f53863117a62580a9e9fc5c4694a5c)|
|2021-12-16|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/0eda7844400d0d7ab9cb0347029458c261174d8f)|
|2022-04-28|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/d7ef6f089505e1f5918001186b58b1d393a03d2d)|
|2022-06-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/4de5d0a511e4aea4096e4e68957053d954f979fb)|
|2022-07-18|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/f904a4924014252117ed33e97eb44565e25c7186)|
|2022-07-18|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/51e647354a0ca91f0567a102beee8797aec7eb49)|
|2022-07-19|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/d76256a496a40bb26428e0b172318e7fc2a090ff)|
|2022-07-19|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/4424e92ab0877a1e6c56fb28464fe2de89ebfe31)|
|2022-07-20|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/40e894d22d6fa8c7190a6f539aef69a89f7590c6)|
|2022-07-25|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/74b40d6c2cf899abb4b76cc5de7e482e20264ae5)|
|2022-08-05|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/58c64e69ea83eb3c585e8db66ef4ade46a29c40c)|
|2022-08-09|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/f73a5e14d09ab45719699418dc8d77cd0189a995)|
|2022-08-12|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/5cc3acc9f9284d510f0ce11970abe956b0bfb548)|
|2022-08-30|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/b987b78d88d58887819fef19370408764e183ef1)|
|2022-08-30|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/dec092e701cf45cc2ccdca418aa5999b12e01550)|
|2022-08-31|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/f64511691950d282d3a5224d072ef9400ea7b47f)|
|2022-08-31|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/501fec065832bac2c8495203afd6c6f552fbcc62)|
|2022-09-21|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/e773e4e847a26521a3adfb8836a48f1a7300ab31)|
|2022-09-22|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/f5ab46373c03662ad7ef6533bc6b39fbee9ced60)|
|2022-10-04|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/a31e0649bb87b99eecefaa1967b43a3e68825b15)|
|2022-10-05|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/a0bd7450977a7100cb954f70581fa55ff97b98b0)|
|2022-10-14|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/c0f3d80ab02475bd28d2f87c43604934279294e1)|
|2022-12-02|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/bf50526b544385ab544c6f14dc51111d1f1bea5d)|
|2022-12-09|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2023-03-10|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/9df24d9741cea14704ae1965644c754ad98831d9)|
|2023-10-16|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/6d3501e175a20e6423e7320054e6a58d3c0f0fdd)|
|2024-01-19|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/e00fdff1f6ec822a540acebdffd7b4f8a386e67f)|
|2024-03-20|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/3f08ce4d6aed1bca75a7df13a2bcce930c7e54eb)|
|2024-06-07|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/9e6c37efe5459afb405531aa17364cddf27da233)|
|2024-06-24|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/70b8472ec486d111ac44d49ae8faf57060f751a6)|
|2024-07-03|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/69b36d8e869e328cb096dbcf7e8a90a9520fcbe3)|
|2024-07-22|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/d983591076e2211d2592fc576f2893c13f8a7ffe)|


# TABLE NOTICE

### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì •ë³´ ë° í™œë™ ì´ë ¥ì„ ë‹´ê³  ìˆëŠ” í…Œì´ë¸”
* **ë°ì´í„° ë ˆë²¨**: TRANSACTIONAL DATA
* **íŒŒí‹°ì…˜ í‚¤**: `part_comm_id`, `part_date`
* **ì£¼ìš” í‚¤**: `comm_user_id`

### í…Œì´ë¸” íŠ¹ì§•
* ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° íšŒì›ì˜ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ
* `comm_user_id`ë¥¼ í†µí•´ íšŒì› ì •ë³´ë¥¼ ì‹ë³„ ê°€ëŠ¥
* `comm_id`ë¥¼ í†µí•´ ì»¤ë®¤ë‹ˆí‹° ì •ë³´ë¥¼ ì‹ë³„ ê°€ëŠ¥
* `wv_user_id`ë¥¼ í†µí•´ ìœ„ë²„ìŠ¤ í”Œë«í¼ íšŒì› IDë¥¼ ì‹ë³„ ê°€ëŠ¥
* `we_member_id`ë¥¼ í†µí•´ ìœ„ë²„ìŠ¤ í”Œë«í¼ íšŒì› IDë¥¼ ì‹ë³„ ê°€ëŠ¥
* `is_fc`, `fc_id`ë¥¼ í†µí•´ íŒ¬í´ëŸ½ ê°€ì… ì—¬ë¶€ ë° íŒ¬í´ëŸ½ ID ì •ë³´ë¥¼ ì œê³µ

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1. **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    * `wev_prod.weverse2.community_log_member_status_log`: ì»¤ë®¤ë‹ˆí‹° íšŒì› ìƒíƒœ ë³€ê²½ ì´ë ¥
    * `wev_prod.weverse2.community_member_special_member`: ì»¤ë®¤ë‹ˆí‹° ìŠ¤í˜ì…œ ë©¤ë²„ ì •ë³´
    * `wev_prod.we_mart.we_user`: ìœ„ë²„ìŠ¤ í”Œë«í¼ íšŒì› ì •ë³´
    * `wev_prod.we_mart.ods_wv_member_profile`: ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° íšŒì› í”„ë¡œí•„ ì •ë³´
    * `wev_prod.we_mart.ws_fc_user_history`: íŒ¬í´ëŸ½ ê°€ì… ì´ë ¥
    * `wev_prod.we_mart.we_artist`: ì•„í‹°ìŠ¤íŠ¸ ì •ë³´
    * `wev_prod.we_mart.wv1_join_info`: ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° íšŒì› ê°€ì… ì •ë³´(WV1)
    * `wev_prod.weverse2.notification_push_config`: ì•Œë¦¼ ì„¤ì • ì •ë³´(WV2)
    * `wev_prod.we_mart.wv_user_ctry_history`: íšŒì› êµ­ê°€ ë³€ê²½ ì´ë ¥
2. **ë°ì´í„° ì „ì²˜ë¦¬**:
    * `community_log_member_status_log` í…Œì´ë¸”ì—ì„œ `type` ì»¬ëŸ¼ ê°’ì´ `subscribe` ë˜ëŠ” `unsubscribe` ì¸ ë°ì´í„°ë§Œ ì¶”ì¶œ
    * `community_member_special_member` í…Œì´ë¸”ì—ì„œ `special_member_type` ì»¬ëŸ¼ ê°’ì´ `ARTIST` ë˜ëŠ” `OTHER_COMMUNITY_ARTIST` ì¸ ë°ì´í„°ë§Œ ì¶”ì¶œ
    * `ods_wv_member_profile` í…Œì´ë¸”ì—ì„œ `part_date` ì»¬ëŸ¼ ê°’ì´ `bef_key` ì™€ `key` ì‚¬ì´ì˜ ë°ì´í„°ë§Œ ì¶”ì¶œ
    * `ws_fc_user_history` í…Œì´ë¸”ì—ì„œ `part_date` ì»¬ëŸ¼ ê°’ì´ `key` ì´ê³ , `ord_status` ì»¬ëŸ¼ ê°’ì´ `PAYMENT_FAILED`ê°€ ì•„ë‹Œ ë°ì´í„°ë§Œ ì¶”ì¶œ
    * `we_user` í…Œì´ë¸”ì—ì„œ `part_date` ì»¬ëŸ¼ ê°’ì´ `key` ì¸ ë°ì´í„°ë§Œ ì¶”ì¶œ
3. **ë°ì´í„° í†µí•©**:
    * ìœ„ì—ì„œ ì¶”ì¶œí•œ ë°ì´í„°ë¥¼ `join` ì—°ì‚°ì„ í†µí•´ í†µí•©
    * `wv_user_id` ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì—¬ëŸ¬ í…Œì´ë¸”ì„ `left join`
4. **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    * í†µí•©ëœ ë°ì´í„°ë¥¼ `we_mart.wv_comm_user` í…Œì´ë¸”ì— ì €ì¥
    * `part_comm_id`ì™€ `part_date` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ ì‚¬ìš©

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    * ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì •ë³´ ë¶„ì„
    * íšŒì› í™œë™ ì´ë ¥ ë¶„ì„
    * íŒ¬í´ëŸ½ ê°€ì… ì •ë³´ ë¶„ì„
    * ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ ë¶„ì„
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    * `wv_user_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸
    * `comm_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸
    * `we_member_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸
    * `part_date` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸
    * `comm_user_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸

### ì¶”ê°€ ì •ë³´

* í•´ë‹¹ í…Œì´ë¸”ì€ ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì •ë³´ ë° í™œë™ ì´ë ¥ì„ ë‹´ê³  ìˆëŠ” TRANSACTIONAL DATA í…Œì´ë¸”
* `part_comm_id` ì™€ `part_date` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬
* `comm_user_id` ì»¬ëŸ¼ì„ í†µí•´ íšŒì› ì •ë³´ë¥¼ ì‹ë³„ ê°€ëŠ¥
* `comm_id` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° ì •ë³´ë¥¼ ì‹ë³„ ê°€ëŠ¥
* `wv_user_id` ì»¬ëŸ¼ì„ í†µí•´ ìœ„ë²„ìŠ¤ í”Œë«í¼ íšŒì› IDë¥¼ ì‹ë³„ ê°€ëŠ¥
* `we_member_id` ì»¬ëŸ¼ì„ í†µí•´ ìœ„ë²„ìŠ¤ í”Œë«í¼ íšŒì› IDë¥¼ ì‹ë³„ ê°€ëŠ¥
* `is_fc`, `fc_id` ì»¬ëŸ¼ì„ í†µí•´ íŒ¬í´ëŸ½ ê°€ì… ì—¬ë¶€ ë° íŒ¬í´ëŸ½ ID ì •ë³´ë¥¼ ì œê³µ
* `is_official` ì»¬ëŸ¼ì„ í†µí•´ ì•„í‹°ìŠ¤íŠ¸ ê³µì‹ ê³„ì • ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `wv_user_status` ì»¬ëŸ¼ì„ í†µí•´ ìœ„ë²„ìŠ¤ í”Œë«í¼ íšŒì› ìƒíƒœë¥¼ í™•ì¸ ê°€ëŠ¥
* `comm_user_status` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° íšŒì› ìƒíƒœë¥¼ í™•ì¸ ê°€ëŠ¥
* `comm_user_grade` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° íšŒì› ë“±ê¸‰ì„ í™•ì¸ ê°€ëŠ¥
* `ip_ctry` ì»¬ëŸ¼ì„ í†µí•´ íšŒì›ì˜ ìµœê·¼ ì ‘ì† êµ­ê°€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `comm_user_first_dt` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° ìµœì´ˆ ê°€ì… ì¼ì‹œë¥¼ í™•ì¸ ê°€ëŠ¥
* `tot_comm_user_first_dt` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° ì²« ê°€ì… ì¼ìë¥¼ í™•ì¸ ê°€ëŠ¥
* `is_first_user_comm` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° ì²« ê°€ì… ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `comm_user_cre_dt` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° íšŒì› ìƒì„± ì¼ì‹œë¥¼ í™•ì¸ ê°€ëŠ¥
* `comm_user_end_dt` ì»¬ëŸ¼ì„ í†µí•´ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì¢…ë£Œ ì¼ì‹œë¥¼ í™•ì¸ ê°€ëŠ¥
* `is_profile_created` ì»¬ëŸ¼ì„ í†µí•´ í”„ë¡œí•„ ìƒì„± ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `is_profile_private` ì»¬ëŸ¼ì„ í†µí•´ í”„ë¡œí•„ ë¹„ê³µê°œ ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `is_upload_profile_img` ì»¬ëŸ¼ì„ í†µí•´ í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `is_upload_profile_background_img` ì»¬ëŸ¼ì„ í†µí•´ í”„ë¡œí•„ ë°°ê²½ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
* `notification_type`, `like_on_comment_alarm`, `hot_post_alarm` ë“±ì˜ ì»¬ëŸ¼ì„ í†µí•´ ì•Œë¦¼ ì„¤ì • ì •ë³´ë¥¼ í™•ì¸ ê°€ëŠ¥
* `v_ch_join_dt` ì»¬ëŸ¼ì„ í†µí•´ Vì±„ë„ ê°€ì… ì‹œì ì„ í™•ì¸ ê°€ëŠ¥
* `is_v_user` ì»¬ëŸ¼ì„ í†µí•´ Vì´ê´€ ì—¬ë¶€ë¥¼ í™•ì¸ ê°€ëŠ¥
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|key_date|date|key_date|
|1|wv_user_id|bigint|wv_user_id|
|2|we_member_id|bigint|we_member_id|
|3|comm_id|bigint|community_id|
|4|we_art_id|int|we ì•„í‹°ìŠ¤íŠ¸ id|
|5|we_art_name|string|we ì•„í‹°ìŠ¤íŠ¸ name|
|6|is_fc|int|ë©¤ë²„ì‰½ ì—¬ë¶€|
|7|fc_id|bigint|ë©¤ë²„ì‰½ id|
|8|art_indi_id|string|ì•„í‹°ìŠ¤íŠ¸ ë©¤ë²„ id|
|9|art_indi_type|string|ì•„í‹°ìŠ¤íŠ¸ íƒ€ì…|
|10|art_indi_name|string|ì•„í‹°ìŠ¤íŠ¸ ë©¤ë²„ ëª…|
|11|ip_ctry|string|ì‚¬ìš©ì ìµœê·¼ ì ‘ì† êµ­ê°€|
|12|wv_user_status|string|ìœ„ë²„ì‹€ íšŒì› ìƒíƒœ|
|13|comm_user_first_dt|timestamp|ì»¤ë®¤ë‹ˆí‹° ìµœì´ˆ ê°€ì… ì¼ì‹œ|
|14|tot_comm_user_first_dt|timestamp|ì»¤ë®¤ë‹ˆí‹° ì²« ê°€ì…ì¼ì|
|15|is_first_user_comm|int|ì»¤ë®¤ë‹ˆí‹° ì²« ê°€ì…ì—¬ë¶€|
|16|comm_user_status|string|ì»¤ë®¤ë‹ˆí‹° íšŒì› ìƒíƒœ|
|17|comm_user_grade|string|ì»¤ë®¤ë‹ˆí‹° íšŒì› êµ¬ë¶„|
|18|comm_user_cre_dt|timestamp|í˜„ì¬ ì»¤ë®¤ë‹ˆí‹° íšŒì› ìƒì„± ì¼ì‹œ|
|19|comm_user_end_dt|timestamp|í˜„ì¬ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì¢…ë£Œ ì¼ì‹œ|
|20|is_profile_created|bigint|í”„ë¡œí•„ ìƒì„±ì—¬ë¶€|
|21|profile_name|string|í”„ë¡œí•„ ë‹‰ë„¤ì„|
|22|is_profile_private|bigint|í”„ë¡œí•„ ë¹„ê³µê°œì—¬ë¶€|
|23|is_upload_profile_img|int|í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì—¬ë¶€|
|24|is_upload_profile_background_img|int|í”„ë¡œí•„ ë°±ê·¸ë¼ìš´ë“œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì—¬ë¶€|
|25|is_official|bigint|ê³µì‹ ê³„ì •ì—¬ë¶€|
|26|comm_user_id|string|comm_user_id|
|27|cnt_comm_user_id|bigint|ê°€ì… comm_user_id ìˆ˜|
|28|sum_report_count|bigint|ì‹ ê³  ì—¬ë¶€|
|29|comm_user_seq|int|ì»¤ë®¤ë‹ˆí‹° íšŒì› ì‹œí€€ìŠ¤|
|30|notification_type|string|ì•Œë¦¼ ìˆ˜ì‹  ì„¤ì • íƒ€ì… (WV1)|
|31|like_on_comment_alarm|tinyint|ë‚´ ëŒ“ê¸€ì— ëŠë‚Œì´ ë‹¬ë ¸ì„ ë•Œ ì•ŒëŒ (WV1)|
|32|hot_post_alarm|tinyint|ë‚´ ê¸€ì´ í•«í¬ìŠ¤íŠ¸ì— ë…¸ì¶œì‹œ ì•ŒëŒ|
|33|new_fc_alarm|tinyint|ìƒˆë¡œìš´ fc only ì•ŒëŒ (WV1)|
|34|new_media_alarm|tinyint|ìƒˆë¡œìš´ ë¯¸ë””ì–´ ì•ŒëŒ (WV1)|
|35|new_community_notice_alarm|tinyint|ì»¤ë®¤ë‹ˆí‹° ê³µì§€ ì•ŒëŒ (WV1)|
|36|artist_to_fans_post_alarm|tinyint|ì•„í‹°ìŠ¤íŠ¸ ìƒˆë¡œìš´ íˆ¬íŒ¬ì¦ˆ í¬ìŠ¤íŠ¸ ì•ŒëŒ (WV1)|
|37|artist_post_alarm|tinyint|ì•„í‹°ìŠ¤íŠ¸ ìƒˆë¡œìš´ í¬ìŠ¤íŠ¸ ì•ŒëŒ (WV1)|
|38|artist_like_on_my_post_alarm|tinyint|ë‚´ê°€ ì‘ì„±í•œ í¬ìŠ¤íŠ¸ > ì•„í‹°ìŠ¤íŠ¸ ëŠë‚Œ ì•ŒëŒ (WV1)|
|39|artist_comment_on_my_post_alarm|tinyint|ë‚´ê°€ ì‘ì„±í•œ í¬ìŠ¤íŠ¸ > ì•„í‹°ìŠ¤íŠ¸ ëŒ“ê¸€ ì•ŒëŒ (WV1)|
|40|like_on_my_post_alarm|tinyint|ë‚´ê°€ ì‘ì„±í•œ í¬ìŠ¤íŠ¸ > ëŠë‚Œ ì•ŒëŒ (WV1)|
|41|comment_on_my_post_alarm|tinyint|ë‚´ê°€ ì‘ì„±í•œ í¬ìŠ¤íŠ¸ > ëŒ“ê¸€ ì•ŒëŒ (WV1)|
|42|after_receiving_artist_comment_alarm|tinyint|ì•„í‹°ìŠ¤íŠ¸ ëŒ“ê¸€ ë°›ì€ ì´í›„ ì•Œë¦¼ ë°›ê¸° (WV1)|
|43|artist_cheering_me_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ í™œë™ ì•Œë¦¼ > ë‚˜ë¥¼ ì‘ì›í•˜ê¸° ì•Œë¦¼ (WV2)|
|44|artist_comment_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ í™œë™ ì•Œë¦¼ > ë‚˜ë¥¼ ëŒ“ê¸€ ì•Œë¦¼ (WV2)|
|45|artist_live_on_air_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ í™œë™ ì•Œë¦¼ > ë¼ì´ë¸Œ ì‹œì‘ (WV2)|
|46|artist_live_reservation_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ í™œë™ ì•Œë¦¼ > ë¼ì´ë¸Œ ì˜ˆì•½ (WV2)|
|47|artist_moment_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ í™œë™ ì•Œë¦¼ > ëª¨ë¨¼íŠ¸ ì‘ì„± (WV2)|
|48|artist_post_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ í™œë™ ì•Œë¦¼ > í¬ìŠ¤íŠ¸ ì‘ì„± (WV2)|
|49|comment_push_enabled|tinyint|ë‚´ í™œë™ > ëŒ“ê¸€ ì•Œë¦¼ (WV2)|
|50|community_anniversary_push_enabled|tinyint|ì»¤ë®¤ë‹ˆí‹° ì•Œë¦¼ > ê¸°ë…ì¼ ì•Œë¦¼ (WV2)|
|51|community_media_push_enabled|tinyint|ì•„í‹°ìŠ¤íŠ¸ ì•Œë¦¼ > ë¯¸ë””ì–´ ë“±ë¡ (WV2)|
|52|community_notice_push_enabled|tinyint|ì»¤ë®¤ë‹ˆí‹° ì•Œë¦¼ > ê³µì§€ì‚¬í•­ ë“±ë¡ (WV2)|
|53|following_push_enabled|tinyint|ë‚´ í™œë™ ì•Œë¦¼ > ë‚˜ë¥¼ íŒ”ë¡œìš° (WV2)|
|54|v_ch_join_dt|timestamp|Vì±„ë„ ê°€ì… ì‹œì |
|55|is_v_user|int|Vì´ê´€ ìœ ë¬´|
|56|part_comm_id|bigint|partition_community_id|
|57|part_date|string|partition_date|
|58|run_timestamp|timestamp|run_timestamp|


---
# HOW TO USE

`
### Downstream Table/View
- ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì €ìˆ˜ë¥¼ ê¸°ì¤€ì¼ì, ì•„í‹°ìŠ¤íŠ¸ ID, êµ­ê°€ë³„ë¡œ ì§‘ê³„í•œ í…Œì´ë¸”ì„ ìƒì„±
    - ```sql
      select
        part_date,
        we_art_id,
        ip_ctry,
        count(distinct we_member_id) as cnt_user
      from wev_prod.we_mart.wv_comm_user
      where comm_user_status = 'NORMAL'
        and wv_user_status = 'NORMAL'
      group by 1, 2, 3
      ```
- ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì €ìˆ˜ë¥¼ ê¸°ì¤€ì¼ì, ì•„í‹°ìŠ¤íŠ¸ ID, êµ­ê°€ë³„ë¡œ ì§‘ê³„í•œ í…Œì´ë¸”ì„ ìƒì„± (íŒŒí‹°ì…˜ í‚¤ í™œìš©)
    - ```sql
      create or replace table wev_prod.we_mart.stats_wv_comm_user_cnt
      (
        part_date date comment 'ê¸°ì¤€ì¼ì',
        we_art_id int comment 'ì•„í‹°ìŠ¤íŠ¸ ID',
        ip_ctry string comment 'êµ­ê°€ ì½”ë“œ',
        cnt_user bigint comment 'ê°€ì… ìœ ì €ìˆ˜'
      )
      using delta
      partitioned by (part_date, we_art_id, ip_ctry)
      comment 'ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì €ìˆ˜ í†µê³„'
      as
      select
        part_date,
        we_art_id,
        ip_ctry,
        count(distinct we_member_id) as cnt_user
      from wev_prod.we_mart.wv_comm_user
      where comm_user_status = 'NORMAL'
        and wv_user_status = 'NORMAL'
      group by 1, 2, 3
      ```
- ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì € ì •ë³´ë¥¼ ê¸°ì¤€ì¼ì, ì•„í‹°ìŠ¤íŠ¸ ID, êµ­ê°€ë³„ë¡œ ì§‘ê³„í•œ í…Œì´ë¸”ì„ ìƒì„± (íŒŒí‹°ì…˜ í‚¤ í™œìš©)
    - ```sql
      create or replace table wev_prod.we_mart.stats_wv_comm_user_info
      (
        part_date date comment 'ê¸°ì¤€ì¼ì',
        we_art_id int comment 'ì•„í‹°ìŠ¤íŠ¸ ID',
        ip_ctry string comment 'êµ­ê°€ ì½”ë“œ',
        cnt_user bigint comment 'ê°€ì… ìœ ì €ìˆ˜',
        avg_comm_user_cre_dt timestamp comment 'ê°€ì… ìœ ì € í‰ê·  ìƒì„± ì‹œê°„',
        avg_comm_user_end_dt timestamp comment 'ê°€ì… ìœ ì € í‰ê·  ì¢…ë£Œ ì‹œê°„'
      )
      using delta
      partitioned by (part_date, we_art_id, ip_ctry)
      comment 'ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì € ì •ë³´ í†µê³„'
      as
      select
        part_date,
        we_art_id,
        ip_ctry,
        count(distinct we_member_id) as cnt_user,
        avg(comm_user_cre_dt) as avg_comm_user_cre_dt,
        avg(comm_user_end_dt) as avg_comm_user_end_dt
      from wev_prod.we_mart.wv_comm_user
      where comm_user_status = 'NORMAL'
        and wv_user_status = 'NORMAL'
      group by 1, 2, 3
      ```
- ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì € ì •ë³´ë¥¼ ê¸°ì¤€ì¼ì, ì•„í‹°ìŠ¤íŠ¸ ID, êµ­ê°€ë³„ë¡œ ì§‘ê³„í•œ í…Œì´ë¸”ì„ ìƒì„± (íŒŒí‹°ì…˜ í‚¤ í™œìš©, we_user í…Œì´ë¸”ê³¼ ì¡°ì¸)
    - ```sql
      create or replace table wev_prod.we_mart.stats_wv_comm_user_detail
      (
        part_date date comment 'ê¸°ì¤€ì¼ì',
        we_art_id int comment 'ì•„í‹°ìŠ¤íŠ¸ ID',
        ip_ctry string comment 'êµ­ê°€ ì½”ë“œ',
        cnt_user bigint comment 'ê°€ì… ìœ ì €ìˆ˜',
        avg_comm_user_cre_dt timestamp comment 'ê°€ì… ìœ ì € í‰ê·  ìƒì„± ì‹œê°„',
        avg_comm_user_end_dt timestamp comment 'ê°€ì… ìœ ì € í‰ê·  ì¢…ë£Œ ì‹œê°„',
        avg_wv_last_access_dt timestamp comment 'ê°€ì… ìœ ì € í‰ê·  ë§ˆì§€ë§‰ ì ‘ì† ì‹œê°„'
      )
      using delta
      partitioned by (part_date, we_art_id, ip_ctry)
      comment 'ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì € ìƒì„¸ ì •ë³´ í†µê³„'
      as
      select
        a.part_date,
        a.we_art_id,
        a.ip_ctry,
        count(distinct a.we_member_id) as cnt_user,
        avg(a.comm_user_cre_dt) as avg_comm_user_cre_dt,
        avg(a.comm_user_end_dt) as avg_comm_user_end_dt,
        avg(b.wv_last_access_dt) as avg_wv_last_access_dt
      from wev_prod.we_mart.wv_comm_user a
      left join wev_prod.we_mart.we_user b on a.we_member_id = b.we_member_id and a.part_date = b.part_date
      where a.comm_user_status = 'NORMAL'
        and a.wv_user_status = 'NORMAL'
      group by 1, 2, 3
      ```

### Data Extraction
- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ì»¤ë®¤ë‹ˆí‹°ì— ê°€ì…í•œ ìœ ì € ì¤‘, ìµœê·¼ 3ê°œì›” ì´ë‚´ì— ë§ˆì§€ë§‰ ì ‘ì†í•œ ìœ ì € ëª©ë¡ì„ ì¶”ì¶œ
    - ```sql
      select
        we_member_id,
        wv_user_id,
        comm_user_status,
        wv_user_status,
        wv_last_access_dt
      from wev_prod.we_mart.wv_comm_user
      inner join wev_prod.we_mart.we_user on wv_comm_user.we_member_id = we_user.we_member_id and wv_comm_user.part_date = we_user.part_date
      where we_art_id = ARTIST
        and part_date = '2024-01-01'
        and date(wv_last_access_dt) >= '2023-10-01'
      ```
- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ, íŠ¹ì • êµ­ê°€ì˜ ìœ ì €ê°€ ê°€ì…í•œ ì»¤ë®¤ë‹ˆí‹° ëª©ë¡ì„ ì¶”ì¶œ
    - ```sql
      select
        we_art_id,
        we_art_name,
        comm_id,
        comm_user_first_dt
      from wev_prod.we_mart.wv_comm_user
      where part_date >= '2023-10-01'
        and part_date <= '2023-12-31'
        and ip_ctry = 'KR'
      ```
- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ì»¤ë®¤ë‹ˆí‹°ì— ê°€ì…í•œ ìœ ì € ì¤‘, ë©¤ë²„ì‹­ ê°€ì… ì—¬ë¶€, í”„ë¡œí•„ ìƒì„± ì—¬ë¶€, í”„ë¡œí•„ ê³µê°œ ì—¬ë¶€, ì•Œë¦¼ ì„¤ì • ì •ë³´ë¥¼ ì¶”ì¶œ
    - ```sql
      select
        we_member_id,
        wv_user_id,
        is_fc,
        is_profile_created,
        is_profile_private,
        like_on_comment_alarm,
        hot_post_alarm,
        new_fc_alarm,
        new_media_alarm,
        new_community_notice_alarm,
        artist_to_fans_post_alarm,
        artist_post_alarm,
        artist_like_on_my_post_alarm,
        artist_comment_on_my_post_alarm,
        like_on_my_post_alarm,
        comment_on_my_post_alarm,
        after_receiving_artist_comment_alarm
      from wev_prod.we_mart.wv_comm_user
      where we_art_id = ARTIST
        and part_date = '2024-01-01'
      ```
- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ, ì»¤ë®¤ë‹ˆí‹° ê°€ì… ìœ ì € ì¤‘, ë©¤ë²„ì‹­ ê°€ì… ìœ ì € ë¹„ìœ¨, í”„ë¡œí•„ ìƒì„± ìœ ì € ë¹„ìœ¨, í”„ë¡œí•„ ê³µê°œ ìœ ì € ë¹„ìœ¨ì„ ê³„ì‚°
    - ```sql
      select
        part_date,
        count(distinct we_member_id) as total_user,
        count(distinct case when is_fc = 1 then we_member_id end) as fc_user,
        count(distinct case when is_profile_created = 1 then we_member_id end) as profile_created_user,
        count(distinct case when is_profile_private = 1 then we_member_id end) as profile_private_user
      from wev_prod.we_mart.wv_comm_user
      where part_date >= '2023-10-01'
        and part_date <= '2023-12-31'
      group by 1
      ```
- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ì»¤ë®¤ë‹ˆí‹°ì— ê°€ì…í•œ ìœ ì € ì¤‘, ë©¤ë²„ì‹­ ê°€ì… ìœ ì €ì™€ ì¼ë°˜ ìœ ì €ì˜ ê°€ì… ë‚ ì§œ ë¶„í¬ë¥¼ ë¹„êµ
    - ```sql
      select
        part_date,
        'FC' as user_type,
        count(distinct we_member_id) as user_cnt
      from wev_prod.we_mart.wv_comm_user
      where we_art_id = ARTIST
        and part_date >= '2023-10-01'
        and part_date <= '2023-12-31'
        and is_fc = 1
      group by 1
      union all
      select
        part_date,
        'GENERAL' as user_type,
        count(distinct we_member_id) as user_cnt
      from wev_prod.we_mart.wv_comm_user
      where we_art_id = ARTIST
        and part_date >= '2023-10-01'
        and part_date <= '2023-12-31'
        and is_fc = 0
      group by 1
      ```
- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ì»¤ë®¤ë‹ˆí‹°ì— ê°€ì…í•œ ìœ ì € ì¤‘, ì•Œë¦¼ ì„¤ì •ë³„ ê°€ì… ìœ ì €ìˆ˜ë¥¼ ì§‘ê³„
    - ```sql
      select
        part_date,
        'LIKE_ON_COMMENT_ALARM' as alarm_type,
        count(distinct case when like_on_comment_alarm = 1 then we_member_id end) as user_cnt
      from wev_prod.we_mart.wv_comm_user
      where we_art_id = ARTIST
        and part_date >= '2023-10-01'
        and part_date <= '2023-12-31'
      group by 1
      union all
      select
        part_date,
        'HOT_POST_ALARM' as alarm_type,
        count(distinct case when hot_post_alarm = 1 then we_member_id end) as user_cnt
      from wev_prod.we_mart.wv_comm_user
      where we_art_id = ARTIST
        and part_date >= '2023-10-01'
        and part_date <= '2023-12-31'
      group by 1
      -- ë‹¤ë¥¸ ì•Œë¦¼ ìœ í˜•ì— ëŒ€í•œ ì¿¼ë¦¬ ì¶”ê°€
      ```
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_we_mart_priority_daily`

### Update Interval: DAILY

### Update Type: OVERWRITE

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/wv_comm_user.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_priority_daily.py)


---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|we_mart.ods_wv_member_profile|we_mart.stats_wv_d_comm_cross_join|
|we_mart.we_artist|we_mart.stats_wv_d_comm_cross_join_agg|
|we_mart.we_user|we_mart.stats_wv_d_comm_engage_usr|
|we_mart.ws_fc_user_history|we_mart.stats_wv_d_comm_join|
|we_mart.wv1_join_info|we_mart.stats_wv_d_live_agg|
|we_mart.wv_user_ctry_history|we_mart.stats_wv_d_pop_post|
|we_meta.v_to_wv_comm_mapping|we_mart.stats_wv_d_user_setting|
|weverse2.community_common_report|we_mart.stats_wv_m_comm_engage_usr|
|weverse2.community_log_member_status_log|we_mart.stats_wv_m_pop_post|
|weverse2.community_log_v_member_migration|we_mart.stats_wv_w_comm_engage_usr|
|weverse2.community_member_special_member|we_mart.stats_wv_w_pop_post|
|weverse2.notification_push_config|we_mart.we_sale|
| |we_mart.we_user_dic_engaged_by_project|
| |we_mart.wv_comm_user_update|
| |we_mart.wv_dm_msg_fan|
| |we_mart.wv_dm_subscr_daily|
| |we_mart.wv_dm_subscr_history|
| |we_mart.wv_post_view|
| |we_mart.wv_sess_daily|

## ğŸ¤ Downstream Tables Info

### Downstream Tables
- **wv_comm_user_update** : ì»¤ë®¤ë‹ˆí‹° íšŒì›ì˜ ìµœì‹  ìƒíƒœ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” í…Œì´ë¸”. `wv_comm_user` í…Œì´ë¸”ì„ ê¸°ë°˜ìœ¼ë¡œ ë§¤ì¼ ìƒì„±ë˜ë©°, íšŒì›ì˜ ê°€ì…, íƒˆí‡´, ìƒíƒœ ë³€ê²½ ì´ë ¥ì„ ì¶”ì .
    - `wv_comm_user` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ íšŒì›ì˜ ìµœì‹  ìƒíƒœ ì •ë³´ë¥¼ ì¶”ì¶œ.
    - íšŒì›ì˜ ê°€ì…, íƒˆí‡´, ìƒíƒœ ë³€ê²½ ì´ë ¥ì„ íŒŒì•…í•˜ê¸° ìœ„í•´ `update_type` ì»¬ëŸ¼ì„ ì‚¬ìš©.
    - `update_part_date` ì»¬ëŸ¼ì€ ìƒíƒœê°’ì´ ë§ˆì§€ë§‰ìœ¼ë¡œ ì—…ë°ì´íŠ¸ëœ íŒŒí‹°ì…˜ ë‚ ì§œë¥¼ ë‚˜íƒ€ëƒ„.
    - ì˜ˆì‹œ: íŠ¹ì • ë‚ ì§œì— íŠ¹ì • ì»¤ë®¤ë‹ˆí‹°ì— ê°€ì…í•œ íšŒì› ì •ë³´ë¥¼ ì¶”ì¶œí•˜ë ¤ë©´ `wv_comm_user_update` í…Œì´ë¸”ì—ì„œ `comm_id`, `wv_user_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ê³  `update_type` ì»¬ëŸ¼ì´ `'c'`ì¸ ë°ì´í„°ë§Œ í•„í„°ë§.
- **stats_wv_d_comm_engage_usr** : ì»¤ë®¤ë‹ˆí‹° ì ê·¹ í™œë™ ìœ ì € í†µê³„ë¥¼ ì¼ë³„ë¡œ ì§‘ê³„í•˜ëŠ” í…Œì´ë¸”. `wv_comm_user` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì¶”ì¶œ.
    - `wv_post_view`, `wv_post_reaction`, `wv_media_reaction` í…Œì´ë¸”ê³¼ í•¨ê»˜ í™œë™ ìœ ì € ìˆ˜ë¥¼ ê³„ì‚°.
    - `wv_comm_user` í…Œì´ë¸”ì—ì„œ `we_member_id`, `we_art_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ ì»¤ë®¤ë‹ˆí‹° ê°€ì… ì •ë³´ë¥¼ ì¶”ì¶œ.
    - ì˜ˆì‹œ: íŠ¹ì • ë‚ ì§œì˜ ì»¤ë®¤ë‹ˆí‹° ì ê·¹ í™œë™ ìœ ì € ìˆ˜ë¥¼ êµ­ê°€ë³„ë¡œ ì§‘ê³„í•˜ë ¤ë©´ `key_date`, `ctry_code` ì»¬ëŸ¼ì„ ì‚¬ìš©.
- **stats_wv_w_comm_engage_usr** : ì»¤ë®¤ë‹ˆí‹° ì ê·¹ í™œë™ ìœ ì € í†µê³„ë¥¼ ì£¼ë³„ë¡œ ì§‘ê³„í•˜ëŠ” í…Œì´ë¸”. `wv_comm_user` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì¶”ì¶œ.
    - `wv_post_view`, `wv_post_reaction`, `wv_media_reaction` í…Œì´ë¸”ê³¼ í•¨ê»˜ í™œë™ ìœ ì € ìˆ˜ë¥¼ ê³„ì‚°.
    - `wv_comm_user` í…Œì´ë¸”ì—ì„œ `we_member_id`, `we_art_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ ì»¤ë®¤ë‹ˆí‹° ê°€ì… ì •ë³´ë¥¼ ì¶”ì¶œ.
    - ì˜ˆì‹œ: íŠ¹ì • ì£¼ì˜ ì»¤ë®¤ë‹ˆí‹° ì ê·¹ í™œë™ ìœ ì € ìˆ˜ë¥¼ êµ­ê°€ë³„ë¡œ ì§‘ê³„í•˜ë ¤ë©´ `key_date`, `ctry_code` ì»¬ëŸ¼ì„ ì‚¬ìš©.
- **stats_wv_m_comm_engage_usr** : ì»¤ë®¤ë‹ˆí‹° ì ê·¹ í™œë™ ìœ ì € í†µê³„ë¥¼ ì›”ë³„ë¡œ ì§‘ê³„í•˜ëŠ” í…Œì´ë¸”. `wv_comm_user` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì¶”ì¶œ.
    - `wv_post_view`, `wv_post_reaction`, `wv_media_reaction` í…Œì´ë¸”ê³¼ í•¨ê»˜ í™œë™ ìœ ì € ìˆ˜ë¥¼ ê³„ì‚°.
    - `wv_comm_user` í…Œì´ë¸”ì—ì„œ `we_member_id`, `we_art_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ ì»¤ë®¤ë‹ˆí‹° ê°€ì… ì •ë³´ë¥¼ ì¶”ì¶œ.
    - ì˜ˆì‹œ: íŠ¹ì • ì›”ì˜ ì»¤ë®¤ë‹ˆí‹° ì ê·¹ í™œë™ ìœ ì € ìˆ˜ë¥¼ êµ­ê°€ë³„ë¡œ ì§‘ê³„í•˜ë ¤ë©´ `key_date`, `ctry_code` ì»¬ëŸ¼ì„ ì‚¬ìš©.
- **wv_dm_subscr** : WDM êµ¬ë… í˜„í™©ì„ ë‹´ê³  ìˆëŠ” í…Œì´ë¸”. `wv_comm_user` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì—¬ë¶€ë¥¼ íŒë‹¨.
    - `weverse2.community_member_purchase`, `we_mart.wv_jelly_order`, `weverse2.wdm_common_dm`, `weverse2.wdm_subscription`, `we_meta.we_digital_product`, `ws_fc_user_history` í…Œì´ë¸”ê³¼ í•¨ê»˜ êµ¬ë… ì •ë³´ë¥¼ ì¶”ì¶œ.
    - `wv_comm_user` í…Œì´ë¸”ì—ì„œ `wv_user_id`, `comm_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ ì»¤ë®¤ë‹ˆí‹° íšŒì› ì—¬ë¶€ë¥¼ íŒë‹¨.
    - ì˜ˆì‹œ: íŠ¹ì • ë‚ ì§œì— WDM êµ¬ë…ì„ ì‹œì‘í•œ ìœ ì € ì¤‘ ì»¤ë®¤ë‹ˆí‹° íšŒì›ì¸ ìœ ì €ë¥¼ ì¶”ì¶œí•˜ë ¤ë©´ `start_dt` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ê³  `is_comm_user` ì»¬ëŸ¼ì´ `1`ì¸ ë°ì´í„°ë§Œ í•„í„°ë§.

### Downstream View Tables
- **[ì—†ìŒ]**
---