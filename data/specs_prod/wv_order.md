
we_mart.wv_order
================

# BASIC INFO

|**About**| |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**| |
|**Created/ Last Updated At**|2021-11-29 / 2024-08-02|
|**Created By**|박상민|
|**Last Updated By**|송재영|
|**Collaborators**|송재영[70], 이현지[5], 구민서[1], 박상민[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|박상민|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2021-12-02|송재영|[PR](https://github.com/benxcorp/databricks/commit/3dc908757dc22cc71a5c03f3eb50e4814c6780de)|
|2021-12-02|송재영|[PR](https://github.com/benxcorp/databricks/commit/78b32586086e2f5693131462873709d6ce55004d)|
|2021-12-08|송재영|[PR](https://github.com/benxcorp/databricks/commit/240f3a7f93dbe8ed1909e353811c09624e494bc2)|
|2021-12-09|이현지|[PR](https://github.com/benxcorp/databricks/commit/a0c16623d4d93e8580660e07a05bcdb9d834b2f5)|
|2021-12-16|송재영|[PR](https://github.com/benxcorp/databricks/commit/18a0ca2a761594a21a4d23f29b9a5094fc591492)|
|2021-12-16|송재영|[PR](https://github.com/benxcorp/databricks/commit/c98a923573d201e2d4b854cb4878f3de267045c5)|
|2021-12-16|송재영|[PR](https://github.com/benxcorp/databricks/commit/24bbee68caef08935edcc121857771062e2cb7fe)|
|2022-01-03|송재영|[PR](https://github.com/benxcorp/databricks/commit/c40703e87e5a75b2be2085bd7b86a8fd49e31980)|
|2022-01-03|송재영|[PR](https://github.com/benxcorp/databricks/commit/f368f5071602a3fcc11070012c8ec788822af400)|
|2022-01-06|송재영|[PR](https://github.com/benxcorp/databricks/commit/e426de9b1387e2cbbd7c2daddbefdacc975d4cc6)|
|2022-01-06|송재영|[PR](https://github.com/benxcorp/databricks/commit/7b12ee1243ef29d0e266f71d46ee89a58e294fbd)|
|2022-01-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/ecf2b9c150b165d72df05ae543dea8eb76c3cf77)|
|2022-01-28|송재영|[PR](https://github.com/benxcorp/databricks/commit/88d56b496d1e6a4f9e619a6893ef466927c21f6b)|
|2022-03-17|송재영|[PR](https://github.com/benxcorp/databricks/commit/39fee16ecfa66b94a860e633a6bf63ff07920977)|
|2022-03-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/6a34bcfa1c473b85f69eccaf92f55c3cb480905d)|
|2022-03-31|송재영|[PR](https://github.com/benxcorp/databricks/commit/945d1c0c5ca331ae000e130bcff338540d816556)|
|2022-04-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/b5409fdf9f8c40c1a4fd4472958c3a2cfd6068dd)|
|2022-06-21|이현지|[PR](https://github.com/benxcorp/databricks/commit/4de5d0a511e4aea4096e4e68957053d954f979fb)|
|2022-07-04|이현지|[PR](https://github.com/benxcorp/databricks/commit/b33b293999a93a3966c6b94c919b26de2c1173b5)|
|2022-07-04|이현지|[PR](https://github.com/benxcorp/databricks/commit/f20547c57a3c2eb877ea7c9b24a05324338ae1da)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/6431d379d2f752681926c82ca894169fcba52e82)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/fb813b8af5247d3c0dfdf1f96bab08afe0c8ceb4)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/efd64885f4879826fa359f0d482817c41e8d124f)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/6c380688a5f4f1ba2490b1639833d425698d8dce)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/d93442b341ce83dba80a709e35186174235d12df)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/4f0d9990dab48f84d64430fe277f97d90629dba3)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/7a07813310ee72dc50b8e12cb200bd07fc4f9dcb)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/8d533fbfb8bff7e7ea4709869b4f58316a68257e)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/c9c8d3c345863d76a112bc3f54d6b8ff85e8ce99)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/b7f11df2a981ba8bece5a2ac2f223cd227d08cef)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/24022091500c619ad4b06cb36d2e232522c4272e)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/a1ac4daae7bc343c1423c57f7e3a70e2c557099a)|
|2022-07-22|송재영|[PR](https://github.com/benxcorp/databricks/commit/8b40148eaece2e97100f283b840fb5e006ba7d82)|
|2022-07-25|이현지|[PR](https://github.com/benxcorp/databricks/commit/30f9196bb50dc5a16a9a8698bf3197edb1dc78b7)|
|2022-07-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/a4b30c75b75036da4cf4b3422dc68718d9796613)|
|2022-07-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/1de80a357ac41657ee9ed6ddd0f01fb105e4d1cb)|
|2022-07-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/3de048601b9020fc4d69a5a55b5723b57f89d5ce)|
|2022-07-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/1abbd3443b48cb9cbd739fb8ca6290889410ac86)|
|2022-07-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/7e8385b0288822fa5dba79b25bafe1b37e6bf508)|
|2022-07-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/96c133709c815ef65c9864bf7e2fbd478a7a524b)|
|2022-10-05|송재영|[PR](https://github.com/benxcorp/databricks/commit/f52639fc216d0f0de3f541a79bb027ab81a9bb58)|
|2022-10-05|송재영|[PR](https://github.com/benxcorp/databricks/commit/ad7a5e7a3807ba368295dd351570629420fc6501)|
|2022-11-03|송재영|[PR](https://github.com/benxcorp/databricks/commit/ce4fbc5a20a16bf23f78afcb2d0572ffe155957a)|
|2022-11-03|송재영|[PR](https://github.com/benxcorp/databricks/commit/e0d1da87162e31a84eae9f7a98620b9dd3dd683c)|
|2022-11-23|송재영|[PR](https://github.com/benxcorp/databricks/commit/e833469c89dce2452ac22b7b029c2f2483cc4155)|
|2022-11-24|송재영|[PR](https://github.com/benxcorp/databricks/commit/d7b056c34114d77bf0ba7dd8a1435145739ec73d)|
|2022-12-09|구민서|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2023-03-13|송재영|[PR](https://github.com/benxcorp/databricks/commit/759e922afbb9f92d2e9fba0f37e492c7ee2c4661)|
|2023-04-12|송재영|[PR](https://github.com/benxcorp/databricks/commit/bbb80f358652792b8efa0b5a46034468078c2b6d)|
|2023-04-27|송재영|[PR](https://github.com/benxcorp/databricks/commit/07154e9ff926d600423820ea8e605cf5a569a1cb)|
|2023-05-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/600a8828283884bf213d05ee8f092e0170282b68)|
|2023-06-12|송재영|[PR](https://github.com/benxcorp/databricks/commit/92d52fded71d7111678382b27e880f317933ae55)|
|2023-06-15|송재영|[PR](https://github.com/benxcorp/databricks/commit/cb5fae3bce7a33d2a4419f0c60fa1f22d59f193d)|
|2023-06-15|송재영|[PR](https://github.com/benxcorp/databricks/commit/32093eda71286fae55645f0787a204f872161d72)|
|2023-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/302e1fba9446244f923b91b1e3f774e24bb041b1)|
|2023-07-24|송재영|[PR](https://github.com/benxcorp/databricks/commit/ccd503a9ff46ddae0243f8162790b9b19269e09f)|
|2023-07-24|송재영|[PR](https://github.com/benxcorp/databricks/commit/552913b3f3b63007bd4c54461312ff3d8a3521c2)|
|2023-07-31|송재영|[PR](https://github.com/benxcorp/databricks/commit/654d3851c9b0abe6c52f400de519f0a563faf322)|
|2023-09-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/3c2c65e38e77ea09f4105682f3041fbb223f785c)|
|2023-09-20|송재영|[PR](https://github.com/benxcorp/databricks/commit/5f7b4b87860fbed08d471876f7ea886a8d3554a4)|
|2023-09-20|송재영|[PR](https://github.com/benxcorp/databricks/commit/1c6f71f7fffaecbbd001dd4b9158519ea7e70e22)|
|2023-09-20|송재영|[PR](https://github.com/benxcorp/databricks/commit/732e35010328b4108adaeee434bd5c70c865dccd)|
|2023-11-09|송재영|[PR](https://github.com/benxcorp/databricks/commit/352bb2c1389b350e07eec8912cdb846ed51ccb76)|
|2023-11-16|송재영|[PR](https://github.com/benxcorp/databricks/commit/2aa87eafd6f19e6d9ab56ec6f95322916f0fd9ca)|
|2023-12-04|송재영|[PR](https://github.com/benxcorp/databricks/commit/ed356b181240fa339a49093f94d545c388af7896)|
|2024-01-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/0d2d05bd03e48d89e5be43312e126b19a450853c)|
|2024-01-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/dcac53cb3df8ff3f9e0a36a86f21dbcea027a406)|
|2024-03-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/b2570667b137e95b76858070a29e1e44da039113)|
|2024-05-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/f0d3c4ba3262ea1ef26037a5d1d8695930bec7a4)|
|2024-05-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/513fb33efe109ee81d45bbcadd57d4a04567f2d9)|
|2024-05-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/9bd7cbca546a106f5400ae979b74fecc5c622196)|
|2024-05-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/e211995c5fa4e9df5bee77ae30f03a93e66cd89e)|
|2024-07-01|송재영|[PR](https://github.com/benxcorp/databricks/commit/4f06e9b9ef59c8bcaefe6b79d759edb90dcbd60a)|
|2024-07-02|송재영|[PR](https://github.com/benxcorp/databricks/commit/21da1795061451c1397d4b388a87e68712a3483e)|
|2024-07-23|송재영|[PR](https://github.com/benxcorp/databricks/commit/6d83b7ce51c92f350ecb13622669d5a80dec15bb)|
|2024-08-02|송재영|[PR](https://github.com/benxcorp/databricks/commit/c1838a3cd9ebe6c97eef2b39252df4ba4f644a5c)|
  
  
# TABLE NOTICE
  
### 테이블 개요

* **테이블 목적**: 위버스 플랫폼에서 발생하는 유료 결제 현황을 나타내는 트랜잭션 데이터를 담고 있다.
* **데이터 레벨**: transactional data
* **파티션 키**: 없음
* **주요 키**: `transaction_id`

### 테이블 특징

* `we_member_id`, `wv_user_id`, `ctry_code`를 이용하여 유저를 식별한다.
* `is_pay`, `is_cx`, `is_partial_cx`, `is_cx_to_jelly_refund` 등의 컬럼을 통해 결제, 취소, 환불 여부를 나타낸다.
* `product_type`, `product_id`, `we_art_id`, `we_art_name`, `product_name` 등의 컬럼을 이용하여 상품 정보를 식별한다.
* `pay_system`, `pay_method`, `sale_id`, `sale_currency_code`, `sale_price` 등의 컬럼을 이용하여 결제 시스템, 결제 방식, 판매 정보를 나타낸다.
* `paid_amt`, `paid_amt_krw`, `paid_amt_krw_inner`, `cx_amt`, `cx_amt_krw`, `cx_amt_krw_inner` 등의 컬럼을 이용하여 결제 금액, 원화 환산 금액, 환불 금액 정보를 나타낸다.
* `seq_pay_completed`, `seq_all` 컬럼을 이용하여 유저별 결제 순서를 나타낸다.
* `is_fc` 컬럼을 이용하여 유저의 팬클럽 가입 여부를 나타낸다.

### 데이터 추출 및 생성 과정

1.  **주요 데이터 소스**:
    *   `billing.purchase`: 인앱 결제 정보
    *   `weverseshop.order_sheet`: 위버스샵 주문 정보
    *   `weverseshop.order_item`: 위버스샵 주문 상품 정보
    *   `we_mart_wv1.wv_order_with_sale_id`: 위버스 1(Weverse Community) 결제 정보
    *   `jelly.transaction`: 젤리 결제 정보
    *   `jelly.order_item`: 젤리 주문 상품 정보
    *   `we_meta.we_media_product`: 미디어 상품 정보
    *   `we_meta.we_digital_product`: 디지털 상품 정보
    *   `we_mart.we_user`: 위버스 유저 정보
    *   `we_meta.currency_rate`: 환율 정보
    *   `we_mart.ws_fc_user_history`: 팬클럽 가입 정보
    *   `we_mart.wv_user_ctry_history`: 유저 국가 정보
2.  **데이터 전처리**:
    *   `billing.purchase` 테이블에서 `expire_at_ms != -1` 조건을 통해 유효한 인앱 결제 데이터만 추출
    *   `billing.purchase` 테이블에서 `system in ('INAPP', 'WEVERSE_SHOP')` 조건을 통해 인앱 구매와 위버스샵 구매 데이터만 추출
    *   `jelly.transaction` 테이블에서 `transaction_type in ('ORDER')` 조건을 통해 젤리 결제 데이터만 추출
    *   `jelly.ledger` 테이블에서 `transaction_type in ('ORDER')` 조건을 통해 젤리 결제 내역 데이터만 추출
    *   `jelly.ledger` 테이블에서 `transaction_type in ('WITHDRAW', 'PARTIAL_WITHDRAW')` 조건을 통해 젤리 환불 내역 데이터만 추출
    *   `we_mart.ws_fc_user_history` 테이블에서 `is_cx_by_restore = 0` 조건을 통해 수기 복구로 취소된 멤버십은 제외
    *   `we_mart.wv_user_ctry_history` 테이블에서 `user_id`, `member_id`, `created_at` 컬럼을 기준으로 중복 제거
    *   `we_mart.wv_user_ctry_history` 테이블에서 `created_at` 컬럼을 기준으로 유저별 최신 국가 정보 추출
    *   `we_meta.currency_rate` 테이블을 이용하여 환율 정보를 적용
3.  **데이터 통합**:
    *   인앱 구매, 위버스샵 구매, 젤리 구매 데이터를 `UNION ALL` 연산을 통해 통합
    *   `we_mart.we_user` 테이블을 이용하여 유저 정보를 추가
    *   `we_mart.we_artist` 테이블을 이용하여 아티스트 정보를 추가
    *   `we_mart.ws_fc_user_history` 테이블을 이용하여 팬클럽 가입 정보를 추가
    *   `we_mart.wv_user_ctry_history` 테이블을 이용하여 유저 국가 정보를 추가
4.  **최종 테이블 생성**:
    *   통합된 데이터를 `we_mart.wv_order` 테이블에 저장

### 테이블 활용 가이드

* **주요 활용**:
    *   위버스 플랫폼의 전체 유료 결제 현황 분석
    *   유저별, 상품별, 아티스트별, 국가별 결제 현황 분석
    *   결제, 취소, 환불 패턴 분석
    *   팬클럽 가입과 결제 현황의 상관관계 분석
* **조인 시 유의사항**:
    *   `we_member_id`, `wv_user_id`, `ctry_code` 컬럼을 이용하여 다른 테이블과 조인
    *   `pay_dt`, `cx_dt`, `sale_start_dt`, `started_dt`, `ended_dt` 등의 컬럼을 이용하여 시간 기준으로 조인
    *   `product_id`, `we_art_id` 등의 컬럼을 이용하여 상품, 아티스트 정보 기준으로 조인
    *   `transaction_id`, `purchase_id` 등의 컬럼을 이용하여 결제 정보 기준으로 조인

### 추가 정보

* `we_mart.wv_order` 테이블은 `we_meta.we_artist`, `we_mart.we_user`, `we_mart.ws_fc_user_history`, `we_mart.wv_user_ctry_history` 등의 테이블과 조인하여 유저, 아티스트, 팬클럽, 국가 정보 등을 추가하여 분석할 수 있다.
* `paid_amt`, `paid_amt_krw`, `cx_amt`, `cx_amt_krw` 등의 컬럼을 이용하여 결제 금액, 환불 금액, 원화 환산 금액 등을 분석할 수 있다.
* `seq_pay_completed`, `seq_all` 컬럼을 이용하여 유저별 결제 순서를 분석할 수 있다.
* `is_fc` 컬럼을 이용하여 팬클럽 가입과 결제 현황의 상관관계를 분석할 수 있다.  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|we_member_id|bigint|위버스 플랫폼 통합 유저의 ID|
|1|wv_user_id|bigint|위버스 유저 ID|
|2|ctry_code|string|국가 코드|
|3|is_pay|int|구매 여부|
|4|pay_dt|timestamp|구매(=결제) 시점|
|5|is_cx|int|취소 여부|
|6|is_partial_cx|int|(젤리의 경우) 부분 환금(취소) 여부|
|7|is_cx_to_jelly_refund|int|(젤리의 경우) 젤리 환불에 의한 환급 여부|
|8|cx_dt|timestamp|구매 취소 시점|
|9|transaction_id|string|구매 별 거래 id(key)|
|10|purchase_id|string|영수증 구매 테이블 id|
|11|ord_status|string|주문 상태|
|12|product_type|string|디지털 상품 종류|
|13|product_id|int|상품 ID, data_source에 따라 unique|
|14|is_media_product|int|미디어 상품일 경우|
|15|we_art_id|int|위버스 플랫폼 통합 아티스트/커뮤니티 ID|
|16|we_art_name|string|위버스 플랫폼 통합 아티스트/커뮤니티 명|
|17|comm_id|bigint|위버스 커뮤니티 ID|
|18|product_name|string|디지털 상품 명|
|19|dur_type|string|구매상품 적용 단위 및 유형|
|20|dur_unit|string|구매상품 유형에 따른 단위|
|21|dur_value|int|구매상품 단위에 따른 적용 값|
|22|promotion_type|string|이벤트 타입|
|23|promotion_unit|string|이벤트 타입에 따른 단위|
|24|promotion_value|int|이벤트 타입에 따른 값|
|25|store_item_id|string|인앱 결제용 마켓별 사용 상품 ID|
|26|paid_item_id|bigint|인앱 결제 가능한 상품 ID|
|27|cp_code|string|컨텐츠 제작 사 코드|
|28|sale_start_dt|timestamp|판매 시작일|
|29|started_dt|timestamp|컨텐츠 이용 시작일|
|30|ended_dt|timestamp|컨텐츠 이용 만료일|
|31|pay_system|string|결제 방식/옵션 {INAPP, JELLY, WEVERSE_SHOP, PG}|
|32|pay_method|string|결제 방식에 따른 결제 수단|
|33|sale_id|bigint|weverseshop sale_id|
|34|sale_currency_code|string|상품 객단가 결제 통화|
|35|sale_price|double|상품 객단가(meta)|
|36|is_fc|int|주문 당시 아티스트 멤버십 가입 여부|
|37|ord_item_qty|int|구매 상품 수|
|38|cx_item_qty|int|취소(환급) 상품 수|
|39|currency_code|string|유저가 지불한 금액의 통화|
|40|paid_amt|double|유저가 실제 지불한 금액|
|41|paid_amt_krw|double|유저가 실제 지불한 금액_원화환산|
|42|paid_amt_krw_inner|double|(젤리의 경우) 내부 단가로 계산된 결제 금액_원화환산|
|43|cx_amt|double|유저가 취소(환급)한 금액|
|44|cx_amt_krw|double|유저가 실제 취소한 금액_원화환산|
|45|cx_amt_krw_inner|double|(젤리의 경우) 내부 단가로 계산된 취소 금액_원화환산|
|46|seq_pay_completed|int|유저별 구입 한(지불 완료) 상품 순서, 위버스샵 결제분 제외|
|47|seq_all|int|유저별 상품 거래 내역의 전체 순서, 위버스샵 걸제분 제외|
|48|run_timestamp|timestamp|데이터가 write된 날짜, 시간|
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `wv_order` 테이블을 사용하여 `we_art_id` 기준으로 `product_type` 별 `paid_amt` 집계 테이블 생성
    - ```sql
      select we_art_id, product_type, sum(paid_amt) as total_paid_amt
      from we_mart.wv_order
      where part_date = '2024-01-01'
      group by we_art_id, product_type
      ```
- `wv_order` 테이블을 사용하여 `wv_user_id` 기준으로 최초 결제일, 최근 결제일, 총 결제 횟수, 총 결제 금액을 집계하는 뷰 생성
    - ```sql
      create or replace temp view user_purchase_summary as
      select wv_user_id, min(pay_dt) as first_purchase_dt, max(pay_dt) as last_purchase_dt, count(distinct transaction_id) as total_purchase_count, sum(paid_amt) as total_paid_amount
      from we_mart.wv_order
      where part_date = '2024-01-01'
      group by wv_user_id
      ```
- `wv_order` 테이블을 사용하여 `we_art_id` 기준으로 `product_type` 별 `paid_amt` 집계 테이블 생성 (PySpark)
    - ```py
      from pyspark.sql.functions import sum
      
      # wv_order 테이블 읽어오기
      wv_order_df = spark.table("we_mart.wv_order")
      
      # we_art_id, product_type 기준으로 paid_amt 합계 계산
      aggregated_df = wv_order_df.groupBy("we_art_id", "product_type").agg(sum("paid_amt").alias("total_paid_amt"))
      
      # 집계 결과를 새로운 테이블에 저장
      aggregated_df.write.mode("overwrite").partitionBy("we_art_id", "product_type").saveAsTable("we_mart.aggregated_wv_order")
      ```

### Data Extraction
- `ctry_code` 가 `KR` 이고 `product_type` 이 `VOD` 인 `wv_order` 데이터 추출
    - ```sql
      select *
      from we_mart.wv_order
      where part_date = '2024-01-01' and ctry_code = 'KR' and product_type = 'VOD'
      ```
- `we_art_id` 가 `ARTIST` 이고 `pay_method` 가 `JELLY` 인 `wv_order` 데이터 중 `pay_dt` 기준으로 최근 100건 추출
    - ```sql
      select *
      from we_mart.wv_order
      where part_date = '2024-01-01' and we_art_id = 'ARTIST' and pay_method = 'JELLY'
      order by pay_dt desc
      limit 100
      ```
- `wv_order` 테이블에서 `product_type` 이 `SVOD` 이고 `is_fc` 가 1인 유저의 `wv_user_id` 추출
    - ```sql
      select distinct wv_user_id
      from we_mart.wv_order
      where part_date = '2024-01-01' and product_type = 'SVOD' and is_fc = 1
      ```  
---
# PIPELINE INFO

## ⌛️ BATCH

### DAG: `analytics_we_mart_priority_daily`

### Update Interval: DAILY

### Update Type: OVERWRITE

## 📍 LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/wv_order.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_priority_daily.py)
  
    
---
# DEPENDENCIES

## 👨‍👩‍👧‍👦 Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|billing.in_app_purchase|we_mart.stats_we_m_order_first|
|billing.purchase|we_mart.stats_we_m_order_first_seq|
|jelly.ledger|we_mart.stats_we_w_jelly_order_detail|
|jelly.order_item|we_mart.stats_wv_d_media_sale|
|jelly.point|we_mart.stats_wv_d_media_sale_cp|
|jelly.transaction|we_mart.stats_wv_d_svod_accum_users|
|product.product_payment_option|we_mart.we_order|
|we_mart.we_artist|we_mart.wv_jelly_transaction|
|we_mart.we_jelly_charge|we_mart.wv_video_play|
|we_mart.we_user|we_mart.wv_vod_play|
|we_mart.ws_fc_user_history| |
|we_mart.wv_user_ctry_history| |
|we_mart_wv1.wv_order_with_sale_id| |
|we_meta.currency_rate| |
|we_meta.we_digital_product| |
|we_meta.we_media_product| |
|weverse2.community_member_purchase| |
|weverseshop.order_item| |
|weverseshop.order_sheet| |

## 🐤 Downstream Tables Info
  
   
---