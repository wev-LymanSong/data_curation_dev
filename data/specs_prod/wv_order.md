we_mart.wv_order
================

# BASIC INFO

|**About**| |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**| |
|**Created/ Last Updated At**|2021-11-29 / 2024-08-02|
|**Created By**|ë°•ìƒë¯¼|
|**Last Updated By**|ì†¡ì¬ì˜|
|**Collaborators**|ì†¡ì¬ì˜[70], ì´í˜„ì§€[5], êµ¬ë¯¼ì„œ[1], ë°•ìƒë¯¼[1]|

#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2021-12-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3dc908757dc22cc71a5c03f3eb50e4814c6780de)|
|2021-12-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/78b32586086e2f5693131462873709d6ce55004d)|
|2021-12-08|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/240f3a7f93dbe8ed1909e353811c09624e494bc2)|
|2021-12-09|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/a0c16623d4d93e8580660e07a05bcdb9d834b2f5)|
|2021-12-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/18a0ca2a761594a21a4d23f29b9a5094fc591492)|
|2021-12-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/c98a923573d201e2d4b854cb4878f3de267045c5)|
|2021-12-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/24bbee68caef08935edcc121857771062e2cb7fe)|
|2022-01-03|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/c40703e87e5a75b2be2085bd7b86a8fd49e31980)|
|2022-01-03|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f368f5071602a3fcc11070012c8ec788822af400)|
|2022-01-06|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e426de9b1387e2cbbd7c2daddbefdacc975d4cc6)|
|2022-01-06|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/7b12ee1243ef29d0e266f71d46ee89a58e294fbd)|
|2022-01-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ecf2b9c150b165d72df05ae543dea8eb76c3cf77)|
|2022-01-28|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/88d56b496d1e6a4f9e619a6893ef466927c21f6b)|
|2022-03-17|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/39fee16ecfa66b94a860e633a6bf63ff07920977)|
|2022-03-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6a34bcfa1c473b85f69eccaf92f55c3cb480905d)|
|2022-03-31|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/945d1c0c5ca331ae000e130bcff338540d816556)|
|2022-04-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/b5409fdf9f8c40c1a4fd4472958c3a2cfd6068dd)|
|2022-06-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/4de5d0a511e4aea4096e4e68957053d954f979fb)|
|2022-07-04|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/b33b293999a93a3966c6b94c919b26de2c1173b5)|
|2022-07-04|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/f20547c57a3c2eb877ea7c9b24a05324338ae1da)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6431d379d2f752681926c82ca894169fcba52e82)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/fb813b8af5247d3c0dfdf1f96bab08afe0c8ceb4)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/efd64885f4879826fa359f0d482817c41e8d124f)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6c380688a5f4f1ba2490b1639833d425698d8dce)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/d93442b341ce83dba80a709e35186174235d12df)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/4f0d9990dab48f84d64430fe277f97d90629dba3)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/7a07813310ee72dc50b8e12cb200bd07fc4f9dcb)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/8d533fbfb8bff7e7ea4709869b4f58316a68257e)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/c9c8d3c345863d76a112bc3f54d6b8ff85e8ce99)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/b7f11df2a981ba8bece5a2ac2f223cd227d08cef)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/24022091500c619ad4b06cb36d2e232522c4272e)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/a1ac4daae7bc343c1423c57f7e3a70e2c557099a)|
|2022-07-22|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/8b40148eaece2e97100f283b840fb5e006ba7d82)|
|2022-07-25|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/30f9196bb50dc5a16a9a8698bf3197edb1dc78b7)|
|2022-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/a4b30c75b75036da4cf4b3422dc68718d9796613)|
|2022-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/1de80a357ac41657ee9ed6ddd0f01fb105e4d1cb)|
|2022-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3de048601b9020fc4d69a5a55b5723b57f89d5ce)|
|2022-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/1abbd3443b48cb9cbd739fb8ca6290889410ac86)|
|2022-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/7e8385b0288822fa5dba79b25bafe1b37e6bf508)|
|2022-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/96c133709c815ef65c9864bf7e2fbd478a7a524b)|
|2022-10-05|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f52639fc216d0f0de3f541a79bb027ab81a9bb58)|
|2022-10-05|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ad7a5e7a3807ba368295dd351570629420fc6501)|
|2022-11-03|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ce4fbc5a20a16bf23f78afcb2d0572ffe155957a)|
|2022-11-03|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e0d1da87162e31a84eae9f7a98620b9dd3dd683c)|
|2022-11-23|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e833469c89dce2452ac22b7b029c2f2483cc4155)|
|2022-11-24|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/d7b056c34114d77bf0ba7dd8a1435145739ec73d)|
|2022-12-09|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2023-03-13|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/759e922afbb9f92d2e9fba0f37e492c7ee2c4661)|
|2023-04-12|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/bbb80f358652792b8efa0b5a46034468078c2b6d)|
|2023-04-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/07154e9ff926d600423820ea8e605cf5a569a1cb)|
|2023-05-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/600a8828283884bf213d05ee8f092e0170282b68)|
|2023-06-12|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/92d52fded71d7111678382b27e880f317933ae55)|
|2023-06-15|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/cb5fae3bce7a33d2a4419f0c60fa1f22d59f193d)|
|2023-06-15|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/32093eda71286fae55645f0787a204f872161d72)|
|2023-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/302e1fba9446244f923b91b1e3f774e24bb041b1)|
|2023-07-24|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ccd503a9ff46ddae0243f8162790b9b19269e09f)|
|2023-07-24|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/552913b3f3b63007bd4c54461312ff3d8a3521c2)|
|2023-07-31|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/654d3851c9b0abe6c52f400de519f0a563faf322)|
|2023-09-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3c2c65e38e77ea09f4105682f3041fbb223f785c)|
|2023-09-20|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/5f7b4b87860fbed08d471876f7ea886a8d3554a4)|
|2023-09-20|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/1c6f71f7fffaecbbd001dd4b9158519ea7e70e22)|
|2023-09-20|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/732e35010328b4108adaeee434bd5c70c865dccd)|
|2023-11-09|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/352bb2c1389b350e07eec8912cdb846ed51ccb76)|
|2023-11-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/2aa87eafd6f19e6d9ab56ec6f95322916f0fd9ca)|
|2023-12-04|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ed356b181240fa339a49093f94d545c388af7896)|
|2024-01-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/0d2d05bd03e48d89e5be43312e126b19a450853c)|
|2024-01-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/dcac53cb3df8ff3f9e0a36a86f21dbcea027a406)|
|2024-03-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/b2570667b137e95b76858070a29e1e44da039113)|
|2024-05-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f0d3c4ba3262ea1ef26037a5d1d8695930bec7a4)|
|2024-05-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/513fb33efe109ee81d45bbcadd57d4a04567f2d9)|
|2024-05-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/9bd7cbca546a106f5400ae979b74fecc5c622196)|
|2024-05-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e211995c5fa4e9df5bee77ae30f03a93e66cd89e)|
|2024-07-01|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/4f06e9b9ef59c8bcaefe6b79d759edb90dcbd60a)|
|2024-07-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/21da1795061451c1397d4b388a87e68712a3483e)|
|2024-07-23|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6d83b7ce51c92f350ecb13622669d5a80dec15bb)|
|2024-08-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/c1838a3cd9ebe6c97eef2b39252df4ba4f644a5c)|


# TABLE NOTICE

### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: ìœ„ë²„ìŠ¤ í”Œë«í¼ì—ì„œ ë°œìƒí•˜ëŠ” ìœ ë£Œ ê²°ì œ í˜„í™© ë°ì´í„°ë¥¼ ì§‘ê³„í•˜ì—¬ ì €ì¥. ì ¤ë¦¬, ì¸ì•±, ìœ„ë²„ìŠ¤ìƒµ ê²°ì œ ë°ì´í„° í†µí•©.
* **ë°ì´í„° ë ˆë²¨**: TRANSACTIONAL DATA
* **íŒŒí‹°ì…˜ í‚¤**: `pay_dt`
* **ì£¼ìš” í‚¤**: `transaction_id`

### í…Œì´ë¸” íŠ¹ì§•

* ì ¤ë¦¬, ì¸ì•±, ìœ„ë²„ìŠ¤ìƒµ ê²°ì œ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ì‚¬ìš©ìë³„ ê²°ì œ ë‚´ì—­ì„ í•œëˆˆì— í™•ì¸ ê°€ëŠ¥.
* `is_pay`, `is_cx`, `is_partial_cx`, `is_cx_to_jelly_refund` ì»¬ëŸ¼ì„ í†µí•´ ê²°ì œ, ì·¨ì†Œ, ë¶€ë¶„ í™˜ë¶ˆ, ì ¤ë¦¬ í™˜ë¶ˆ ì—¬ë¶€ë¥¼ êµ¬ë¶„í•˜ì—¬ ë¶„ì„ ê°€ëŠ¥.
* `seq_pay_completed`, `seq_all` ì»¬ëŸ¼ì„ í†µí•´ ìœ ì €ë³„ ê²°ì œ ë‚´ì—­ ìˆœì„œë¥¼ íŒŒì•…í•˜ì—¬ ë¶„ì„ ê°€ëŠ¥.
* `is_fc` ì»¬ëŸ¼ì„ í†µí•´ íŒ¬í´ëŸ½ ê°€ì… ì—¬ë¶€ë¥¼ íŒŒì•…í•˜ì—¬ ë¶„ì„ ê°€ëŠ¥.
* ì ¤ë¦¬ êµ¬ë§¤ ê¸ˆì•¡ì˜ ê²½ìš°, `paid_amt_krw`, `paid_amt_krw_inner` ì»¬ëŸ¼ì„ í†µí•´ ë‚´ë¶€ ë‹¨ê°€ë¡œ ê³„ì‚°ëœ ê²°ì œ ê¸ˆì•¡ì„ í™•ì¸ ê°€ëŠ¥.

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1. **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    * `we_mart_wv1.wv_order_with_sale_id`: ìœ„ë²„ìŠ¤ 1.0 ë²„ì „ ìœ ì € ê²°ì œ ë°ì´í„°
    * `inapp_orders_pre`: ì¸ì•± êµ¬ë§¤ ë°ì´í„°
    * `JELLY_ORDERS`: ì ¤ë¦¬ êµ¬ë§¤ ë°ì´í„°
    * `INAPP_SHOP_ORDERS`: ì¸ì•± ë° ìœ„ë²„ìŠ¤ìƒµ êµ¬ë§¤ ë°ì´í„°
    * `we_meta.we_artist`: ì•„í‹°ìŠ¤íŠ¸ ì •ë³´
    * `we_meta.we_media_product`: ë¯¸ë””ì–´ ìƒí’ˆ ì •ë³´
    * `we_meta.we_digital_product`: ë””ì§€í„¸ ìƒí’ˆ ì •ë³´
    * `we_mart.we_user`: ìœ„ë²„ìŠ¤ ìœ ì € ì •ë³´
    * `we_mart.ws_fc_user_history`: ìœ„ë²„ìŠ¤ìƒµ íŒ¬í´ëŸ½ ê°€ì… ì •ë³´
    * `we_meta.currency_rate`: í™˜ìœ¨ ì •ë³´
    * `CTRY`: ìœ„ë²„ìŠ¤ ìœ ì € êµ­ê°€ ì •ë³´
2. **ë°ì´í„° ì „ì²˜ë¦¬**:
    * ê° ë°ì´í„° ì†ŒìŠ¤ì—ì„œ í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì¶”ì¶œí•˜ì—¬ ì „ì²˜ë¦¬.
    * ì¸ì•± êµ¬ë§¤ ë°ì´í„°ëŠ” `inapp_orders_pre` ë·°ë¥¼ í†µí•´ ì ¤ë¦¬ ìƒí’ˆ ì œì™¸ ë° `pur_confirmed_dt` ì»¬ëŸ¼ ìƒì„±.
    * ì ¤ë¦¬ êµ¬ë§¤ ë°ì´í„°ëŠ” `JELLY_ORDERS` ë·°ë¥¼ í†µí•´ `paid_amt_krw`, `paid_amt_krw_inner` ì»¬ëŸ¼ ìƒì„±.
    * ì ¤ë¦¬, ì¸ì•±, ìœ„ë²„ìŠ¤ìƒµ êµ¬ë§¤ ë°ì´í„°ë¥¼ `INAPP_SHOP_ORDERS` ë·°ë¥¼ í†µí•´ í†µí•©.
3. **ë°ì´í„° í†µí•©**:
    * `INAPP_SHOP_ORDERS` ë·°ì™€ `JELLY_ORDERS` ë·°ë¥¼ `ORDS` ë·°ë¥¼ í†µí•´ í†µí•©.
    * `CTRY`, `FC` ë·°ë¥¼ ì¡°ì¸í•˜ì—¬ êµ­ê°€ ì •ë³´ ë° íŒ¬í´ëŸ½ ê°€ì… ì •ë³´ë¥¼ ì¶”ê°€.
4. **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    * `ORDS` ë·°ì—ì„œ í•„ìš”í•œ ì»¬ëŸ¼ì„ ì¶”ì¶œí•˜ì—¬ `we_mart.wv_order` í…Œì´ë¸” ìƒì„±.
    * `pay_dt` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ í™œìš©.

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    * ìœ„ë²„ìŠ¤ í”Œë«í¼ì—ì„œ ë°œìƒí•˜ëŠ” ìœ ë£Œ ê²°ì œ í˜„í™© ë¶„ì„
    * ì ¤ë¦¬, ì¸ì•±, ìœ„ë²„ìŠ¤ìƒµ ê²°ì œ ë°ì´í„° í†µí•© ë¶„ì„
    * ìœ ì €ë³„ ê²°ì œ ë‚´ì—­, ì·¨ì†Œ ë‚´ì—­, í™˜ë¶ˆ ë‚´ì—­ ë¶„ì„
    * íŒ¬í´ëŸ½ ê°€ì… ì—¬ë¶€ì™€ ê²°ì œ í˜„í™© ë¶„ì„
    * êµ­ê°€ë³„ ê²°ì œ í˜„í™© ë¶„ì„
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    * `we_member_id`, `wv_user_id`, `transaction_id`, `purchase_id`, `product_id`, `we_art_id`, `comm_id` ë“±ì˜ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥.
    * `pay_dt` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ì‹œê°„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥.
    * `is_pay`, `is_cx`, `is_partial_cx`, `is_cx_to_jelly_refund`, `is_fc` ë“±ì˜ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ì¡°ê±´ì„ ê±¸ì–´ ë¶„ì„ ê°€ëŠ¥.

### ì¶”ê°€ ì •ë³´

* ì ¤ë¦¬ êµ¬ë§¤ ê¸ˆì•¡ì˜ ê²½ìš°, `paid_amt_krw`, `paid_amt_krw_inner` ì»¬ëŸ¼ì„ í†µí•´ ë‚´ë¶€ ë‹¨ê°€ë¡œ ê³„ì‚°ëœ ê²°ì œ ê¸ˆì•¡ì„ í™•ì¸ ê°€ëŠ¥.
* `run_timestamp` ì»¬ëŸ¼ì„ í†µí•´ ë°ì´í„° ìƒì„± ì‹œê°„ í™•ì¸ ê°€ëŠ¥.
* `we_mart.wv_order` í…Œì´ë¸”ì€ `pay_dt` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ í™œìš©í•˜ì—¬ ë°ì´í„° ì ‘ê·¼ ë° ì²˜ë¦¬ íš¨ìœ¨ì„±ì„ ë†’ì„.
* ì´ í…Œì´ë¸”ì€ `we_mart` ìŠ¤í‚¤ë§ˆì— ì €ì¥ë¨.
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|we_member_id|bigint|ìœ„ë²„ìŠ¤ í”Œë«í¼ í†µí•© ìœ ì €ì˜ ID|
|1|wv_user_id|bigint|ìœ„ë²„ìŠ¤ ìœ ì € ID|
|2|ctry_code|string|êµ­ê°€ ì½”ë“œ|
|3|is_pay|int|êµ¬ë§¤ ì—¬ë¶€|
|4|pay_dt|timestamp|êµ¬ë§¤(=ê²°ì œ) ì‹œì |
|5|is_cx|int|ì·¨ì†Œ ì—¬ë¶€|
|6|is_partial_cx|int|(ì ¤ë¦¬ì˜ ê²½ìš°) ë¶€ë¶„ í™˜ê¸ˆ(ì·¨ì†Œ) ì—¬ë¶€|
|7|is_cx_to_jelly_refund|int|(ì ¤ë¦¬ì˜ ê²½ìš°) ì ¤ë¦¬ í™˜ë¶ˆì— ì˜í•œ í™˜ê¸‰ ì—¬ë¶€|
|8|cx_dt|timestamp|êµ¬ë§¤ ì·¨ì†Œ ì‹œì |
|9|transaction_id|string|êµ¬ë§¤ ë³„ ê±°ë˜ id(key)|
|10|purchase_id|string|ì˜ìˆ˜ì¦ êµ¬ë§¤ í…Œì´ë¸” id|
|11|ord_status|string|ì£¼ë¬¸ ìƒíƒœ|
|12|product_type|string|ë””ì§€í„¸ ìƒí’ˆ ì¢…ë¥˜|
|13|product_id|int|ìƒí’ˆ ID, data_sourceì— ë”°ë¼ unique|
|14|is_media_product|int|ë¯¸ë””ì–´ ìƒí’ˆì¼ ê²½ìš°|
|15|we_art_id|int|ìœ„ë²„ìŠ¤ í”Œë«í¼ í†µí•© ì•„í‹°ìŠ¤íŠ¸/ì»¤ë®¤ë‹ˆí‹° ID|
|16|we_art_name|string|ìœ„ë²„ìŠ¤ í”Œë«í¼ í†µí•© ì•„í‹°ìŠ¤íŠ¸/ì»¤ë®¤ë‹ˆí‹° ëª…|
|17|comm_id|bigint|ìœ„ë²„ìŠ¤ ì»¤ë®¤ë‹ˆí‹° ID|
|18|product_name|string|ë””ì§€í„¸ ìƒí’ˆ ëª…|
|19|dur_type|string|êµ¬ë§¤ìƒí’ˆ ì ìš© ë‹¨ìœ„ ë° ìœ í˜•|
|20|dur_unit|string|êµ¬ë§¤ìƒí’ˆ ìœ í˜•ì— ë”°ë¥¸ ë‹¨ìœ„|
|21|dur_value|int|êµ¬ë§¤ìƒí’ˆ ë‹¨ìœ„ì— ë”°ë¥¸ ì ìš© ê°’|
|22|promotion_type|string|ì´ë²¤íŠ¸ íƒ€ì…|
|23|promotion_unit|string|ì´ë²¤íŠ¸ íƒ€ì…ì— ë”°ë¥¸ ë‹¨ìœ„|
|24|promotion_value|int|ì´ë²¤íŠ¸ íƒ€ì…ì— ë”°ë¥¸ ê°’|
|25|store_item_id|string|ì¸ì•± ê²°ì œìš© ë§ˆì¼“ë³„ ì‚¬ìš© ìƒí’ˆ ID|
|26|paid_item_id|bigint|ì¸ì•± ê²°ì œ ê°€ëŠ¥í•œ ìƒí’ˆ ID|
|27|cp_code|string|ì»¨í…ì¸  ì œì‘ ì‚¬ ì½”ë“œ|
|28|sale_start_dt|timestamp|íŒë§¤ ì‹œì‘ì¼|
|29|started_dt|timestamp|ì»¨í…ì¸  ì´ìš© ì‹œì‘ì¼|
|30|ended_dt|timestamp|ì»¨í…ì¸  ì´ìš© ë§Œë£Œì¼|
|31|pay_system|string|ê²°ì œ ë°©ì‹/ì˜µì…˜ {INAPP, JELLY, WEVERSE_SHOP, PG}|
|32|pay_method|string|ê²°ì œ ë°©ì‹ì— ë”°ë¥¸ ê²°ì œ ìˆ˜ë‹¨|
|33|sale_id|bigint|weverseshop sale_id|
|34|sale_currency_code|string|ìƒí’ˆ ê°ë‹¨ê°€ ê²°ì œ í†µí™”|
|35|sale_price|double|ìƒí’ˆ ê°ë‹¨ê°€(meta)|
|36|is_fc|int|ì£¼ë¬¸ ë‹¹ì‹œ ì•„í‹°ìŠ¤íŠ¸ ë©¤ë²„ì‹­ ê°€ì… ì—¬ë¶€|
|37|ord_item_qty|int|êµ¬ë§¤ ìƒí’ˆ ìˆ˜|
|38|cx_item_qty|int|ì·¨ì†Œ(í™˜ê¸‰) ìƒí’ˆ ìˆ˜|
|39|currency_code|string|ìœ ì €ê°€ ì§€ë¶ˆí•œ ê¸ˆì•¡ì˜ í†µí™”|
|40|paid_amt|double|ìœ ì €ê°€ ì‹¤ì œ ì§€ë¶ˆí•œ ê¸ˆì•¡|
|41|paid_amt_krw|double|ìœ ì €ê°€ ì‹¤ì œ ì§€ë¶ˆí•œ ê¸ˆì•¡_ì›í™”í™˜ì‚°|
|42|paid_amt_krw_inner|double|(ì ¤ë¦¬ì˜ ê²½ìš°) ë‚´ë¶€ ë‹¨ê°€ë¡œ ê³„ì‚°ëœ ê²°ì œ ê¸ˆì•¡_ì›í™”í™˜ì‚°|
|43|cx_amt|double|ìœ ì €ê°€ ì·¨ì†Œ(í™˜ê¸‰)í•œ ê¸ˆì•¡|
|44|cx_amt_krw|double|ìœ ì €ê°€ ì‹¤ì œ ì·¨ì†Œí•œ ê¸ˆì•¡_ì›í™”í™˜ì‚°|
|45|cx_amt_krw_inner|double|(ì ¤ë¦¬ì˜ ê²½ìš°) ë‚´ë¶€ ë‹¨ê°€ë¡œ ê³„ì‚°ëœ ì·¨ì†Œ ê¸ˆì•¡_ì›í™”í™˜ì‚°|
|46|seq_pay_completed|int|ìœ ì €ë³„ êµ¬ì… í•œ(ì§€ë¶ˆ ì™„ë£Œ) ìƒí’ˆ ìˆœì„œ, ìœ„ë²„ìŠ¤ìƒµ ê²°ì œë¶„ ì œì™¸|
|47|seq_all|int|ìœ ì €ë³„ ìƒí’ˆ ê±°ë˜ ë‚´ì—­ì˜ ì „ì²´ ìˆœì„œ, ìœ„ë²„ìŠ¤ìƒµ ê±¸ì œë¶„ ì œì™¸|
|48|run_timestamp|timestamp|ë°ì´í„°ê°€ writeëœ ë‚ ì§œ, ì‹œê°„|


---
# HOW TO USE

### Downstream Table/View
- `we_mart.wv_order` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `we_mart.stats_wv_d_svod_accum_users` í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì˜ˆì‹œ
    - ```sql
      select
      timestamp(current_timestamp() + interval '9' hour) as run_timestamp,
      key_date,
      a.we_art_id,
      c.we_art_name,
      nvl(product_name, 'TOTAL') as goods_name,
      nvl(dur_type, 'TOTAL') as dur_type,
      nvl(ctry_code, 'TOTAL') as ctry,
      nvl(b.ctry_name, 'TOTAL') as ctry_name,
      nvl(b.region_type, 'TOTAL') as region_type,
      count(distinct wv_user_id) as active_users
      from (
        select distinct date(pay_dt) as key_date, we_art_id, product_name, dur_type, ctry_code, wv_user_id
        from we_mart.wv_order
        where pay_method != 'WEPLY'
        and pay_system = 'INAPP'
        and product_type = 'SVOD'
      ) as a
      left join we_mart.view_we_country as b
      on a.ctry_code = b.ctry_code
      left join we_mart.we_artist as c
      on a.we_art_id = c.we_art_id
      group by grouping sets(
          (key_date, we_art_id, product_name, dur_type, ctry_code)
         ,(key_date, we_art_id, ctry_code)
         ,(key_date, we_art_id, product_name, dur_type)
         ,(key_date, we_art_id)
      )
      order by key_date, we_art_id, goods_name, dur_type, ctry
      ```
- `we_mart.wv_order` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `we_mart.stats_wv_d_user_purchase` í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì˜ˆì‹œ
    - ```sql
      select
      timestamp(current_timestamp() + interval '9' hour) as run_timestamp,
      key_date,
      a.we_art_id,
      c.we_art_name,
      nvl(product_type, 'TOTAL') as product_type,
      nvl(ctry_code, 'TOTAL') as ctry,
      nvl(b.ctry_name, 'TOTAL') as ctry_name,
      nvl(b.region_type, 'TOTAL') as region_type,
      count(distinct wv_user_id) as active_users
      from (
        select distinct date(pay_dt) as key_date, we_art_id, product_type, ctry_code, wv_user_id
        from we_mart.wv_order
        where pay_method != 'WEPLY'
        and pay_system = 'INAPP'
      ) as a
      left join we_mart.view_we_country as b
      on a.ctry_code = b.ctry_code
      left join we_mart.we_artist as c
      on a.we_art_id = c.we_art_id
      group by grouping sets(
          (key_date, we_art_id, product_type, ctry_code)
         ,(key_date, we_art_id, ctry_code)
         ,(key_date, we_art_id, product_type)
         ,(key_date, we_art_id)
      )
      order by key_date, we_art_id, product_type, ctry
      ```
- `we_mart.wv_order` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `we_mart.stats_wv_d_product_sale` í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” ì˜ˆì‹œ
    - ```sql
      select
      timestamp(current_timestamp() + interval '9' hour) as run_timestamp,
      key_date,
      a.we_art_id,
      c.we_art_name,
      product_id,
      product_name,
      product_type,
      nvl(ctry_code, 'TOTAL') as ctry,
      nvl(b.ctry_name, 'TOTAL') as ctry_name,
      nvl(b.region_type, 'TOTAL') as region_type,
      sum(ord_item_qty) as sale_qty,
      sum(paid_amt_krw) as sale_amt_krw
      from (
        select distinct date(pay_dt) as key_date, we_art_id, product_id, product_name, product_type, ctry_code
        from we_mart.wv_order
        where pay_method != 'WEPLY'
        and pay_system = 'INAPP'
      ) as a
      left join we_mart.view_we_country as b
      on a.ctry_code = b.ctry_code
      left join we_mart.we_artist as c
      on a.we_art_id = c.we_art_id
      group by grouping sets(
          (key_date, we_art_id, product_id, product_name, product_type, ctry_code)
         ,(key_date, we_art_id, product_id, product_name, product_type)
         ,(key_date, we_art_id, ctry_code)
         ,(key_date, we_art_id, product_id, product_name)
         ,(key_date, we_art_id)
      )
      order by key_date, we_art_id, product_id, product_type, ctry
      ```

### Data Extraction
- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ íŠ¹ì • ìƒí’ˆì„ êµ¬ë§¤í•œ ìœ ì €ì˜ ìˆ˜ë¥¼ ì¶”ì¶œí•˜ëŠ” ì˜ˆì‹œ
    - ```sql
      select count(distinct wv_user_id)
      from we_mart.wv_order
      where pay_dt between '2024-01-01' and '2024-01-31'
      and we_art_id = 1234
      and product_name = 'ARTIST ìƒí’ˆ'
      ```
- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŠ¹ì • êµ­ê°€ì˜ ìœ ì €ê°€ êµ¬ë§¤í•œ ì ¤ë¦¬ì˜ ì´ëŸ‰ì„ ì¶”ì¶œí•˜ëŠ” ì˜ˆì‹œ
    - ```sql
      select sum(paid_amt)
      from we_mart.wv_order
      where pay_dt between '2024-01-01' and '2024-01-31'
      and ctry_code = 'KR'
      and currency_code = 'JELLY'
      ```
- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ìƒí’ˆì„ êµ¬ë§¤í•œ ìœ ì € ì¤‘, Fan Club íšŒì›ì¸ ìœ ì €ì˜ ìˆ˜ë¥¼ ì¶”ì¶œí•˜ëŠ” ì˜ˆì‹œ (Fan Club ì •ë³´ëŠ” `we_mart.ws_fc_user_history` í…Œì´ë¸”ì—ì„œ ê°€ì ¸ì˜´)
    - ```sql
      select count(distinct a.wv_user_id)
      from we_mart.wv_order as a
      inner join we_mart.ws_fc_user_history as b
      on a.we_member_id = b.we_member_id
      and a.we_art_id = b.we_art_id
      and a.pay_dt between b.create_dt and b.expire_dt
      where a.pay_dt between '2024-01-01' and '2024-01-31'
      and a.we_art_id = 1234
      ```
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_we_mart_priority_daily`

### Update Interval: DAILY

### Update Type: OVERWRITE

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/wv_order.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_priority_daily.py)


---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|billing.in_app_purchase|we_mart.stats_we_m_order_first|
|billing.purchase|we_mart.stats_we_m_order_first_seq|
|jelly.ledger|we_mart.stats_we_w_jelly_order_detail|
|jelly.order_item|we_mart.stats_wv_d_media_sale|
|jelly.point|we_mart.stats_wv_d_media_sale_cp|
|jelly.transaction|we_mart.stats_wv_d_svod_accum_users|
|product.product_payment_option|we_mart.we_order|
|we_mart.we_artist|we_mart.wv_jelly_transaction|
|we_mart.we_jelly_charge|we_mart.wv_video_play|
|we_mart.we_user|we_mart.wv_vod_play|
|we_mart.ws_fc_user_history| |
|we_mart.wv_user_ctry_history| |
|we_mart_wv1.wv_order_with_sale_id| |
|we_meta.currency_rate| |
|we_meta.we_digital_product| |
|we_meta.we_media_product| |
|weverse2.community_member_purchase| |
|weverseshop.order_item| |
|weverseshop.order_sheet| |

## ğŸ¤ Downstream Tables Info

### Downstream Tables
- **we_mart.we_order**: Weverse í”Œë«í¼ í†µí•© ì£¼ë¬¸ í˜„í™©
    - we_mart.wv_order í…Œì´ë¸”ê³¼ we_mart.ws_orderë¥¼ ê¸°ë°˜ìœ¼ë¡œ weverseshop, phoning, weverse 3ê°œ ì„œë¹„ìŠ¤ ì£¼ë¬¸ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ì œê³µ
- **we_mart.wv_video_play**: ìœ„ë²„ìŠ¤ ë¹„ë””ì˜¤ ì¬ìƒ í´ë¦­ ë°ì´í„°
    - Weverse ì„œë²„ ë¡œê·¸ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìœ„ë²„ìŠ¤ ë¹„ë””ì˜¤ ì¬ìƒ í´ë¦­ ë¡œê·¸ë¥¼ ì œê³µ, we_mart.wv_orderë¥¼ ì°¸ê³  í•˜ì—¬ ìœ ë£Œ ë¯¸ë””ì–´ì˜ êµ¬ë§¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜´
- **we_mart.wv_vod_play**: ìœ„ë²„ìŠ¤ VOD, LIVE to VOD, Youtube ì¬ìƒ ì„œë²„ë¡œê·¸ ë§ˆíŠ¸
    - Weverse ì„œë²„ ë¡œê·¸ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìœ„ë²„ìŠ¤ VOD, LIVE to VOD, Youtube ì¬ìƒ ì„œë²„ë¡œê·¸ ë§ˆíŠ¸ë¥¼ ì œê³µ
- **we_mart.stats_wv_d_svod_accum_users**: ì¼ê°„ SVOD ëˆ„ì  ìœ íš¨ íšŒì› ìˆ˜ í˜„í™©
    - we_mart.wv_order í…Œì´ë¸”ì„ ê¸°ë°˜ìœ¼ë¡œ ì¼ê°„ SVOD ëˆ„ì  ìœ íš¨ íšŒì› ìˆ˜ í˜„í™©ì„ ì œê³µ

### Downstream View Tables
- **[í•´ë‹¹ target tableì„ í™œìš©í•˜ëŠ” View tableì€ ì—†ìŒ]**

---