
we_mart.ws_goods_stock
======================

# BASIC INFO

|**About**| |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**|`part_date`|
|**Created/ Last Updated At**|2021-11-29 / 2024-05-02|
|**Created By**|박상민|
|**Last Updated By**|이현지|
|**Collaborators**|이현지[31], 이현지[1], 구민서[1], 구민서[1], 박상민[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|박상민|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2021-12-09|이현지|[PR](https://github.com/benxcorp/databricks/commit/2380d7ad14ce4dd84cae43804df09d8e6fc21ceb)|
|2021-12-13|이현지|[PR](https://github.com/benxcorp/databricks/commit/5aee833cefc072ff168d384bb4ca12e9486fb0df)|
|2022-01-12|이현지|[PR](https://github.com/benxcorp/databricks/commit/da82206779acfea42c298f8b2d64222755cd01b7)|
|2022-04-01|이현지|[PR](https://github.com/benxcorp/databricks/commit/aa037ca4c63b0de915a865d4b454674abcef6689)|
|2022-04-01|이현지|[PR](https://github.com/benxcorp/databricks/commit/cc8ca79cd782da25a7225832ecda383cdea62000)|
|2022-04-01|이현지|[PR](https://github.com/benxcorp/databricks/commit/ebc57613e84b46b96fcb8fd2b721a80834a319ed)|
|2022-04-18|이현지|[PR](https://github.com/benxcorp/databricks/commit/eb24d0c962dd9d5978897656a6737071a9e5f761)|
|2022-04-18|이현지|[PR](https://github.com/benxcorp/databricks/commit/7ef072a4836d109171feaddc9e4315e4d44de716)|
|2022-04-22|이현지|[PR](https://github.com/benxcorp/databricks/commit/46b97d198ea833173e4867b559aaf1c86747c6ae)|
|2022-05-04|이현지|[PR](https://github.com/benxcorp/databricks/commit/f0c6869efce845fd449bf7bee46cf61982054057)|
|2022-05-04|이현지|[PR](https://github.com/benxcorp/databricks/commit/d9446283a9d1b0b473dab602a84e977ed3780590)|
|2022-05-26|이현지|[PR](https://github.com/benxcorp/databricks/commit/0b673821c4dea20c3bf16f1045d23a47c0e5307a)|
|2022-05-31|이현지|[PR](https://github.com/benxcorp/databricks/commit/a04f7be7c951fa1f62775928919e2acf20266ae2)|
|2022-09-01|이현지|[PR](https://github.com/benxcorp/databricks/commit/74b8680e0cc72192c2670f400e03aed9ba9210d7)|
|2022-11-28|이현지|[PR](https://github.com/benxcorp/databricks/commit/5edfb9374b50a2cdb65e6cf15e0439d00ebaecb3)|
|2022-12-09|구민서|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2023-01-10|이현지|[PR](https://github.com/benxcorp/databricks/commit/dead76a1f579ca4174664b926e89da39322e2527)|
|2023-01-10|이현지|[PR](https://github.com/benxcorp/databricks/commit/79b93486a6d6e72ac50bfcca56253bebe6e1974c)|
|2023-05-12|이현지|[PR](https://github.com/benxcorp/databricks/commit/2cefb82a65a70e555f668f4784bc42c4ea5c550f)|
|2023-05-18|이현지|[PR](https://github.com/benxcorp/databricks/commit/11b48d2a10384139d4f98da18a405440c5e604a6)|
|2023-06-08|이현지|[PR](https://github.com/benxcorp/databricks/commit/1fd227e2a80b4b65a080ac5430701c7877b3759a)|
|2023-07-21|구민서|[PR](https://github.com/benxcorp/databricks/commit/beb2da0705bbf128b034c6e9b0714e8729e17626)|
|2023-09-18|이현지|[PR](https://github.com/benxcorp/databricks/commit/1ab3a6b086402d48b0056e2c899e401ef495444f)|
|2023-09-21|이현지|[PR](https://github.com/benxcorp/databricks/commit/a0a52ec622c06737ea76ed9a0e1a07377e143fbd)|
|2023-09-21|이현지|[PR](https://github.com/benxcorp/databricks/commit/f4fa8af633696938c0afe1ef65d8bf07739b7514)|
|2023-10-06|이현지|[PR](https://github.com/benxcorp/databricks/commit/faef890968e6e41f0898f1186a9b40aff170c215)|
|2024-01-02|이현지|[PR](https://github.com/benxcorp/databricks/commit/42082d1e42f062081ae5f9f557ab752609664466)|
|2024-01-02|이현지|[PR](https://github.com/benxcorp/databricks/commit/3f13e4a70cd85659a4a6d7c298373d4483da4b1b)|
|2024-01-02|이현지|[PR](https://github.com/benxcorp/databricks/commit/ee04780b63242062d3f5fefafd081e2268f36d68)|
|2024-03-08|이현지|[PR](https://github.com/benxcorp/databricks/commit/8c1355c8c8145a386a4d11de0360b78a3953e4be)|
|2024-03-08|이현지|[PR](https://github.com/benxcorp/databricks/commit/5d0d432b5d7d3be7da4928a22d35ecf290de9316)|
|2024-03-08|이현지|[PR](https://github.com/benxcorp/databricks/commit/5b9b124c7913ce2bd681094160d91a4cc160739d)|
|2024-05-02|이현지|[PR](https://github.com/benxcorp/databricks/commit/f503a9a1e59e9c327cc52eab65538f84dcc35ef0)|
|2024-05-02|이현지|[PR](https://github.com/benxcorp/databricks/commit/778c88b8ef66973aa13ac35a6ff6c7310adb1038)|
  
  
# TABLE NOTICE
  
### 테이블 개요

* **테이블 목적**: 위버스샵 상품 메타 정보와 판매 정보를 통합한 테이블
* **데이터 레벨**: TRANSACTIONAL DATA
* **파티션 키**: `part_date`
* **주요 키**: `sale_stock_id`

### 테이블 특징

* `sale_stock_id` 컬럼을 기준으로 중복 데이터를 제거
* `sale_stock_name_ko`, `sale_stock_name_ja`, `sale_stock_name_en` 컬럼은 각 언어별 상품명을 나타냄
* `final_sale_price` 컬럼은 `fixed_price`가 1인 경우 `fixed_sale_price` 값을 사용하고, 그렇지 않으면 `sale_price` 값을 사용
* `sale_reserv_history` 컬럼은 판매 상태 예약 정보를 담은 구조체 배열

### 데이터 추출 및 생성 과정

1. **주요 데이터 소스**:
    * `goods` 테이블
    * `goods_stock` 테이블
    * `stock` 테이블
    * `goods_option` 테이블
    * `goods_option_group` 테이블
    * `sale` 테이블
    * `sale_stock` 테이블
    * `sale_fixed_price` 테이블
    * `goods_goods_category` 테이블
    * `goods_category` 테이블
    * `goods_translation` 테이블
    * `shipping_group` 테이블
    * `trade_company` 테이블
    * `membership.membership` 테이블
    * `wev_prod.settlement.settlement_category` 테이블
    * `wev_prod.membership.benefit` 테이블
    * `wev_prod.product.status_reservation_item` 테이블
    * `weverseshop.sale_translation` 테이블
    * `weverseshop.sale_stock_name` 테이블
    * `weverseshop.common_info` 테이블
    * `weverseshop.delivery_service` 테이블
    * `weverseshop.pickup` 테이블
    * `weverseshop.goods_option_component` 테이블
    * `we_mart.we_artist` 테이블
2. **데이터 전처리**:
    * 각 소스 테이블에서 필요한 컬럼을 선택
    * `row_number()` 함수를 이용하여 `sale_stock_id` 컬럼을 기준으로 중복 데이터 제거
    * `regexp_extract_all()` 함수를 이용하여 `origins` 컬럼에서 원산지 국가 코드 추출
    * `explode()` 함수를 이용하여 배열을 분리하고 `collect_list()` 함수를 이용하여 원산지 국가 코드와 국가명을 배열로 저장
    * `case when` 문을 이용하여 `goods_cat` 컬럼을 생성
    * `collect_set()` 함수를 이용하여 `sale_upr_cat_name` 및 `sale_lwr_cat_name` 컬럼을 생성
    * `regexp_extract()` 함수를 이용하여 `fc_ver` 및 `fc_kit_ver` 컬럼을 생성
3. **데이터 통합**:
    * 여러 소스 테이블을 `left join`으로 연결
    * `max()` 함수를 이용하여 `fixed_sale_price` 컬럼을 생성
4. **최종 테이블 생성**:
    * `create or replace table` 문을 이용하여 테이블 생성
    * `partitioned by` 절을 이용하여 `part_date` 컬럼을 파티션 키로 설정

### 테이블 활용 가이드

* **주요 활용**:
    * 위버스샵 상품 판매 정보 분석
    * 상품 재고 현황 파악
    * 상품 옵션 정보 조회
    * 판매 상태 변화 추적
* **조인 시 유의사항**:
    * `sale_stock_id` 컬럼을 기준으로 다른 테이블과 조인
    * `part_date` 컬럼을 이용하여 파티션을 지정
    * `goods_id`, `sale_id`, `goods_option_id` 컬럼을 이용하여 다른 상품 정보 테이블과 조인

### 추가 정보

* `run_timestamp` 컬럼은 데이터 처리 시간을 나타냄
* `part_hour` 컬럼은 파티션 시간을 나타냄
* `precautions` 컬럼은 상품 유형 사항을 나타냄
* `notification_info` 컬럼은 상품 고지 정보를 나타냄
* `sale_title` 컬럼은 판매 타이틀을 나타냄
* `sale_comment` 컬럼은 판매 코멘트를 나타냄  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|goods_id|bigint|상품 id|
|1|sale_id|bigint|판매 id|
|2|stock_id|bigint|입고 id|
|3|sale_stock_id|bigint|판매상품 옵션 id|
|4|goods_upr_cat_id|bigint|상위카테고리 id|
|5|goods_lwr_cat_id|bigint|하위카테고리 id|
|6|we_art_id|int|아티스트 id|
|7|goods_option_id|bigint|상품 옵션 id|
|8|goods_option_group_id|bigint|상품 옵션 그룹 id|
|9|trade_co_id|bigint|거래처 id|
|10|pickup_id|bigint|현장수령 id|
|11|ship_group_id|bigint|배송그룹 id|
|12|deliv_service_dom_id|bigint|국내 배송사 id|
|13|deliv_service_over_id|bigint|해외 배송사 id|
|14|fc_id|bigint|멤버십 id|
|15|fc_cat_id|bigint|멤버십 카테고리 id|
|16|goods_code|string|상품 code|
|17|goods_option_code|string|상품 옵션 code|
|18|barcode|string|바코드|
|19|wms_code|string|WMS_ID|
|20|sap_code|string|SAP 자재코드|
|21|wbs_code|string|WBS 코드|
|22|hscode|string|HS Code|
|23|pod_option_sell_code|string|POD 상품 옵션 판매 코드|
|24|pod_template_code|string|POD 템플릿 코드|
|25|pod_resource_id|string|POD 리소스 ID|
|26|pod_product_code|string|POD 상품 코드|
|27|pod_product_type|string|POD 상품 유형|
|28|bm_option|string|bm_option|
|29|settlement_category_name|string|정산 카테고리명|
|30|settlement_category_code|string|정산 카테고리코드|
|31|vertex_commodity_code_type|string|Vertex 상품코드타입|
|32|vertex_commodity_code_value|string|Vertex 상품코드|
|33|tax_type|string|세금구분|
|34|shop|string|shop|
|35|we_art_name|string|아티스트명|
|36|goods_upr_cat_name|string|상위카테고리명|
|37|goods_lwr_cat_name|string|하위카테고리명|
|38|sale_upr_cat_name|array<string>|앱노출 상위카테고리|
|39|sale_lwr_cat_name|array<string>|앱노출 하위카테고리|
|40|goods_cat|string|상품구분 (마트만들며 생성)|
|41|goods_section|string|상품구분|
|42|goods_type|string|상품 유형 (배송상품, 디지털상품)|
|43|goods_option_type|string|상품 종류 (유형, 무형)|
|44|goods_option_receipt_type|string|입고 유형 (NORMAL, SET, RANDOM)|
|45|logi_cat|string|물류 카테고리|
|46|fc_ver|string|FC 버전|
|47|fc_kit_ver|string|키트 버전|
|48|is_bom_enabled|int|BOM 유무|
|49|bom_sap_codes|array<string>|BOM sap_code모음(array)|
|50|goods_name|string|상품명|
|51|goods_option_name|string|상품 옵션명|
|52|goods_option_group_name|string|상품 옵션 그룹명|
|53|sale_stock_name_ko|string|sale_stock명(한)|
|54|sale_stock_name_ja|string|sale_stock명(일)|
|55|sale_stock_name_en|string|sale_stock명(영)|
|56|release_name|string|상품출하명|
|57|currency_code|string|통화|
|58|original_price|double|상품 정가|
|59|sale_price|double|판매가격|
|60|is_fixed_price|tinyint|고정가격 여부|
|61|final_sale_price|double|최종 판매가격 (고정가격인 경우 고정가격을 판매가격으로 함)|
|62|fixed_sale_price|double|고정 판매가|
|63|fixed_sale_price_USD|double|고정 판매가 (USD)|
|64|fixed_sale_price_JPY|double|고정 판매가 (JPY)|
|65|max_ord_qty|int|최대 구매가능수량|
|66|max_ord_lim_type|string|최대 구매수량 조건값|
|67|max_ord_lim_p_user|tinyint|최대 구매수량 회원별 주문제약 여부|
|68|sale_alrarm_pc|tinyint|재고알림 % (판매등록 수량의 n%가 되었을 경우 알람받기)|
|69|min_ord_qty|int|최소 주문가능수량|
|70|is_cart|tinyint|카트사용여부|
|71|is_tax|tinyint|판매세적용 여부|
|72|is_incl_tax|tinyint|상품가격에 판매세포함 여부|
|73|sale_status|string|판매 상태|
|74|shop_tags|string|샵 태그|
|75|is_digital_live|tinyint|디지털 라이브 상품 여부|
|76|weight|double|중량|
|77|package_size|string|패키지 사이즈|
|78|album_qty|int|앨범 수량|
|79|business_type|string|거래방식 (1:사입, 2:위탁)|
|80|tot_goods_qty|int|총 입고 수량 (누적)|
|81|exp_goods_qty|int|입고 요청한 수량|
|82|real_goods_qty|int|실제 입고된 수량|
|83|fake_goods_qty|int|가입고 수량|
|84|is_sale_hide|tinyint|노출여부 (판매 상태의 더미)|
|85|is_sale_stock_hide|tinyint|판매 옵션 노출 여부|
|86|is_restock_alarm|tinyint|재입고알림 설정 여부|
|87|is_exclusive_icon|int|단독판매 여부|
|88|is_sold_out_icon_enabled|tinyint|솔드아웃 경고 노출 설정|
|89|sold_out_alarm_pc|tinyint|솔드아웃 경고 노출 percent(%)|
|90|will_be_sold_out|int|솔드아웃 경고중|
|91|is_fixed_cash_amount|int|개별 캐시 설정 사용|
|92|fixed_cash_amount|double|설정 캐시(KRW)|
|93|deliv_dt|timestamp|배송 예정일시|
|94|sale_qty|int|판매수량|
|95|avail_sale_qty|int|판매가능수량|
|96|common_info|string|교환/반품 공통정보|
|97|manufacturer|string|제조사|
|98|origins|array<string>|원산지(국가코드)|
|99|origins_ctry_name|array<string>|원산지(국가명-영문)|
|100|trade_co_name|string|거래처|
|101|ship_group_name|string|배송그룹 이름|
|102|deliv_service_dom_code|string|국내 배송사 코드|
|103|deliv_service_dom_name|string|국내 배송사 이름|
|104|deliv_service_over_code|string|해외 배송사 코드|
|105|deliv_service_over_name|string|해외 배송사 이름|
|106|pickup_name|string|픽업 명|
|107|pickup_location|string|픽업 장소|
|108|pickup_location_postal_code|string|픽업 장소 우편번호|
|109|sale_start_at|timestamp|판매 시작일|
|110|sale_end_at|timestamp|판매 종료일|
|111|sale_reserv_history|array<struct>|판매 상태 예약정보|
|112|goods_cre_dt|timestamp|상품등록일|
|113|stock_upd_dt|timestamp|재고업데이트일|
|114|sale_cre_dt|timestamp|판매등록일|
|115|sale_upd_dt|timestamp|판매 업데이트일|
|116|sale_stock_upd_dt|timestamp|판매재고 업데이트일|
|117|run_timestamp|timestamp| |
|118|part_date|string|파티션 일자|
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `ws_goods_stock` 테이블을 이용하여 시간대별 상품 판매 현황을 파악하는 `stats_ws_h_goods_stock` 테이블 생성
    - ```sql
      create or replace table we_mart.stats_ws_h_goods_stock (
        key_date date comment '기준 일자',
        key_datehour timestamp comment '기준 시간',
        we_art_id int comment '아티스트 id',
        shop string comment '샵',
        sale_id bigint comment '판매 id',
        sale_stock_id bigint comment '판매 상품 옵션 id',
        goods_id bigint comment '상품 id',
        goods_option_id bigint comment '상품 옵션 id',
        goods_name string comment '상품명',
        goods_option_name string comment '상품 옵션명',
        goods_upr_cat_name string comment '상위 카테고리명',
        goods_lwr_cat_name string comment '하위 카테고리명',
        goods_cat string comment '상품 구분',
        logi_cat string comment '물류 카테고리',
        currency_code string comment '통화',
        sale_price double comment '판매 가격',
        tot_goods_qty int comment '총 입고 수량',
        exp_goods_qty int comment '입고 요청 수량',
        real_goods_qty int comment '실제 입고 수량',
        fake_goods_qty int comment '가입고 수량',
        avail_sale_qty int comment '판매 가능 수량',
        part_date string comment '파티션 일자',
        run_timestamp timestamp comment '배치 시간'
      )
      partitioned by (part_date)
      comment '시간대별 상품 재고 및 판매 현황';
      
      -- `ws_goods_stock` 테이블을 `stats_ws_h_goods_stock` 테이블에 시간대별로 집계하여 추가
      insert into we_mart.stats_ws_h_goods_stock
      select
        date(GDS.stock_upd_dt) as key_date,
        date_trunc('hour', GDS.stock_upd_dt) as key_datehour,
        GDS.we_art_id,
        GDS.shop,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.goods_cat,
        GDS.logi_cat,
        GDS.currency_code,
        GDS.sale_price,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.avail_sale_qty,
        date(GDS.stock_upd_dt) as part_date,
        current_timestamp() as run_timestamp
      from we_mart.ws_goods_stock as GDS
      where GDS.part_date = '2024-01-01';
      
      -- `stats_ws_h_goods_stock` 테이블에 `ws_goods_stock` 테이블의 데이터를 추가
      insert overwrite table we_mart.stats_ws_h_goods_stock partition(part_date = '2024-01-01')
      select
        date(GDS.stock_upd_dt) as key_date,
        date_trunc('hour', GDS.stock_upd_dt) as key_datehour,
        GDS.we_art_id,
        GDS.shop,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.goods_cat,
        GDS.logi_cat,
        GDS.currency_code,
        GDS.sale_price,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.avail_sale_qty,
        date(GDS.stock_upd_dt) as part_date,
        current_timestamp() as run_timestamp
      from we_mart.ws_goods_stock as GDS
      where GDS.part_date = '2024-01-01';
    ```
- `ws_goods_stock` 테이블을 이용하여 특정 아티스트의 상품 판매 정보를 추출하는 `view_ws_goods_stock_artist` 뷰 생성
    - ```sql
      create or replace view we_mart.view_ws_goods_stock_artist as
      select 
        GDS.we_art_id,
        GDS.we_art_name,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.we_art_id = ARTIST; -- 특정 아티스트 id를 입력
    ```
### Data Extraction
- `ws_goods_stock` 테이블에서 특정 기간 동안 판매된 상품의 최신 재고 정보 추출
    - ```sql
      select 
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.part_date = '2024-01-01' -- 특정 날짜를 입력
      and GDS.sale_id in (select distinct sale_id from we_mart.ws_goods_stock where part_date >= '2024-01-01' and part_date <= '2024-01-31'); -- 특정 기간 동안 판매된 상품의 sale_id만 추출
    ```
- `ws_goods_stock` 테이블에서 특정 상품의 재고 변동 이력 추출
    - ```sql
      select 
        GDS.part_date,
        GDS.stock_upd_dt,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.avail_sale_qty
      from we_mart.ws_goods_stock as GDS
      where GDS.goods_id = GOODS_ID -- 특정 상품 id를 입력
      order by GDS.part_date, GDS.stock_upd_dt;
    ```
- `ws_goods_stock` 테이블에서 특정 아티스트의 특정 상품의 재고 정보 추출
    - ```sql
      select 
        GDS.we_art_id,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.we_art_id = ARTIST -- 특정 아티스트 id를 입력
      and GDS.goods_id = GOODS_ID -- 특정 상품 id를 입력
      order by GDS.part_date;
    ```
- `ws_goods_stock` 테이블에서 특정 카테고리 상품의 재고 정보 추출
    - ```sql
      select 
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.goods_upr_cat_id = GOODS_UPR_CAT_ID -- 특정 상위 카테고리 id를 입력
      and GDS.goods_lwr_cat_id = GOODS_LWR_CAT_ID -- 특정 하위 카테고리 id를 입력
      order by GDS.part_date;
    ```  
---
# PIPELINE INFO

## ⌛️ BATCH

### DAG: `analytics_we_mart_hourly`, `analytics_ws_mart_daily`

### Update Interval: HOURLY, DAILY

### Update Type:  

## 📍 LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/ws_goods_stock.py)

### Airflow DAGs

- [analytics_we_mart_hourly](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_hourly.py)
- [analytics_ws_mart_daily](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_ws_mart_daily.py)
  
    
---
# DEPENDENCIES

## 👨‍👩‍👧‍👦 Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|membership.artist_shop_version|we_mart.stats_we_d_billing_payment_trx|
|membership.benefit|we_mart.stats_ws_d_album_cumul_kpi|
|membership.membership|we_mart.stats_ws_d_cart_item|
|membership.membership_benefit|we_mart.stats_ws_d_ext_ord|
|membership.membership_version|we_mart.stats_ws_d_fc_kit_pur|
|product.status_reservation|we_mart.stats_ws_h_ord_product_concert|
|product.status_reservation_item|we_mart.stats_ws_h_ord_product_detail|
|settlement.settlement_category|we_mart.stats_wv_d_ops_sales|
|we_mart.ods_ws_goods|we_mart.tmp_val_fc_kit_pur|
|we_mart.ods_ws_goods_category|we_mart.view_ipx_ws_goods_stock|
|we_mart.ods_ws_goods_goods_category|we_mart.view_wej_ws_order|
|we_mart.ods_ws_goods_option|we_mart.view_ws_goods_stock_update|
|we_mart.ods_ws_goods_option_group|we_mart.view_ws_ship_status_fc_kit|
|we_mart.ods_ws_goods_stock|we_mart.we_fan_order|
|we_mart.ods_ws_goods_translation|we_mart.we_order|
|we_mart.ods_ws_sale|we_mart.we_sale|
|we_mart.ods_ws_sale_fixed_price|we_mart.ws_order|
|we_mart.ods_ws_sale_stock|we_mart.ws_user_buy|
|we_mart.ods_ws_shipping_group|we_meta.we_digital_product|
|we_mart.ods_ws_stock| |
|we_mart.ods_ws_trade_company| |
|we_mart.we_artist| |
|we_meta.we_country| |
|weverseshop.artist_sale| |
|weverseshop.common_info| |
|weverseshop.delivery_service| |
|weverseshop.goods_category| |
|weverseshop.goods_option| |
|weverseshop.goods_option_component| |
|weverseshop.pickup| |
|weverseshop.sale_stock_name| |
|weverseshop.sale_translation| |

## 🐤 Downstream Tables Info
  
No content.  
---