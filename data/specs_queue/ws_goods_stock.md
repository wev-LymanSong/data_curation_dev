
we_mart.ws_goods_stock
======================

# BASIC INFO

|**About**| |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**|`part_date`|
|**Created/ Last Updated At**|2021-11-29 / 2024-05-02|
|**Created By**|ë°•ìƒë¯¼|
|**Last Updated By**|ì´í˜„ì§€|
|**Collaborators**|ì´í˜„ì§€[31], ì´í˜„ì§€[1], êµ¬ë¯¼ì„œ[1], êµ¬ë¯¼ì„œ[1], ë°•ìƒë¯¼[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2021-12-09|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/2380d7ad14ce4dd84cae43804df09d8e6fc21ceb)|
|2021-12-13|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/5aee833cefc072ff168d384bb4ca12e9486fb0df)|
|2022-01-12|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/da82206779acfea42c298f8b2d64222755cd01b7)|
|2022-04-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/aa037ca4c63b0de915a865d4b454674abcef6689)|
|2022-04-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/cc8ca79cd782da25a7225832ecda383cdea62000)|
|2022-04-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/ebc57613e84b46b96fcb8fd2b721a80834a319ed)|
|2022-04-18|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/eb24d0c962dd9d5978897656a6737071a9e5f761)|
|2022-04-18|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/7ef072a4836d109171feaddc9e4315e4d44de716)|
|2022-04-22|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/46b97d198ea833173e4867b559aaf1c86747c6ae)|
|2022-05-04|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/f0c6869efce845fd449bf7bee46cf61982054057)|
|2022-05-04|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/d9446283a9d1b0b473dab602a84e977ed3780590)|
|2022-05-26|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/0b673821c4dea20c3bf16f1045d23a47c0e5307a)|
|2022-05-31|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/a04f7be7c951fa1f62775928919e2acf20266ae2)|
|2022-09-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/74b8680e0cc72192c2670f400e03aed9ba9210d7)|
|2022-11-28|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/5edfb9374b50a2cdb65e6cf15e0439d00ebaecb3)|
|2022-12-09|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2023-01-10|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/dead76a1f579ca4174664b926e89da39322e2527)|
|2023-01-10|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/79b93486a6d6e72ac50bfcca56253bebe6e1974c)|
|2023-05-12|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/2cefb82a65a70e555f668f4784bc42c4ea5c550f)|
|2023-05-18|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/11b48d2a10384139d4f98da18a405440c5e604a6)|
|2023-06-08|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/1fd227e2a80b4b65a080ac5430701c7877b3759a)|
|2023-07-21|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/beb2da0705bbf128b034c6e9b0714e8729e17626)|
|2023-09-18|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/1ab3a6b086402d48b0056e2c899e401ef495444f)|
|2023-09-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/a0a52ec622c06737ea76ed9a0e1a07377e143fbd)|
|2023-09-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/f4fa8af633696938c0afe1ef65d8bf07739b7514)|
|2023-10-06|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/faef890968e6e41f0898f1186a9b40aff170c215)|
|2024-01-02|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/42082d1e42f062081ae5f9f557ab752609664466)|
|2024-01-02|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/3f13e4a70cd85659a4a6d7c298373d4483da4b1b)|
|2024-01-02|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/ee04780b63242062d3f5fefafd081e2268f36d68)|
|2024-03-08|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/8c1355c8c8145a386a4d11de0360b78a3953e4be)|
|2024-03-08|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/5d0d432b5d7d3be7da4928a22d35ecf290de9316)|
|2024-03-08|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/5b9b124c7913ce2bd681094160d91a4cc160739d)|
|2024-05-02|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/f503a9a1e59e9c327cc52eab65538f84dcc35ef0)|
|2024-05-02|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/778c88b8ef66973aa13ac35a6ff6c7310adb1038)|
  
  
# TABLE NOTICE
  
### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: ìœ„ë²„ìŠ¤ìƒµ ìƒí’ˆ ë©”íƒ€ ì •ë³´ì™€ íŒë§¤ ì •ë³´ë¥¼ í†µí•©í•œ í…Œì´ë¸”
* **ë°ì´í„° ë ˆë²¨**: TRANSACTIONAL DATA
* **íŒŒí‹°ì…˜ í‚¤**: `part_date`
* **ì£¼ìš” í‚¤**: `sale_stock_id`

### í…Œì´ë¸” íŠ¹ì§•

* `sale_stock_id` ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ë°ì´í„°ë¥¼ ì œê±°
* `sale_stock_name_ko`, `sale_stock_name_ja`, `sale_stock_name_en` ì»¬ëŸ¼ì€ ê° ì–¸ì–´ë³„ ìƒí’ˆëª…ì„ ë‚˜íƒ€ëƒ„
* `final_sale_price` ì»¬ëŸ¼ì€ `fixed_price`ê°€ 1ì¸ ê²½ìš° `fixed_sale_price` ê°’ì„ ì‚¬ìš©í•˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ `sale_price` ê°’ì„ ì‚¬ìš©
* `sale_reserv_history` ì»¬ëŸ¼ì€ íŒë§¤ ìƒíƒœ ì˜ˆì•½ ì •ë³´ë¥¼ ë‹´ì€ êµ¬ì¡°ì²´ ë°°ì—´

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1. **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    * `goods` í…Œì´ë¸”
    * `goods_stock` í…Œì´ë¸”
    * `stock` í…Œì´ë¸”
    * `goods_option` í…Œì´ë¸”
    * `goods_option_group` í…Œì´ë¸”
    * `sale` í…Œì´ë¸”
    * `sale_stock` í…Œì´ë¸”
    * `sale_fixed_price` í…Œì´ë¸”
    * `goods_goods_category` í…Œì´ë¸”
    * `goods_category` í…Œì´ë¸”
    * `goods_translation` í…Œì´ë¸”
    * `shipping_group` í…Œì´ë¸”
    * `trade_company` í…Œì´ë¸”
    * `membership.membership` í…Œì´ë¸”
    * `wev_prod.settlement.settlement_category` í…Œì´ë¸”
    * `wev_prod.membership.benefit` í…Œì´ë¸”
    * `wev_prod.product.status_reservation_item` í…Œì´ë¸”
    * `weverseshop.sale_translation` í…Œì´ë¸”
    * `weverseshop.sale_stock_name` í…Œì´ë¸”
    * `weverseshop.common_info` í…Œì´ë¸”
    * `weverseshop.delivery_service` í…Œì´ë¸”
    * `weverseshop.pickup` í…Œì´ë¸”
    * `weverseshop.goods_option_component` í…Œì´ë¸”
    * `we_mart.we_artist` í…Œì´ë¸”
2. **ë°ì´í„° ì „ì²˜ë¦¬**:
    * ê° ì†ŒìŠ¤ í…Œì´ë¸”ì—ì„œ í•„ìš”í•œ ì»¬ëŸ¼ì„ ì„ íƒ
    * `row_number()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ `sale_stock_id` ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ë°ì´í„° ì œê±°
    * `regexp_extract_all()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ `origins` ì»¬ëŸ¼ì—ì„œ ì›ì‚°ì§€ êµ­ê°€ ì½”ë“œ ì¶”ì¶œ
    * `explode()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë°°ì—´ì„ ë¶„ë¦¬í•˜ê³  `collect_list()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì›ì‚°ì§€ êµ­ê°€ ì½”ë“œì™€ êµ­ê°€ëª…ì„ ë°°ì—´ë¡œ ì €ì¥
    * `case when` ë¬¸ì„ ì´ìš©í•˜ì—¬ `goods_cat` ì»¬ëŸ¼ì„ ìƒì„±
    * `collect_set()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ `sale_upr_cat_name` ë° `sale_lwr_cat_name` ì»¬ëŸ¼ì„ ìƒì„±
    * `regexp_extract()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ `fc_ver` ë° `fc_kit_ver` ì»¬ëŸ¼ì„ ìƒì„±
3. **ë°ì´í„° í†µí•©**:
    * ì—¬ëŸ¬ ì†ŒìŠ¤ í…Œì´ë¸”ì„ `left join`ìœ¼ë¡œ ì—°ê²°
    * `max()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ `fixed_sale_price` ì»¬ëŸ¼ì„ ìƒì„±
4. **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    * `create or replace table` ë¬¸ì„ ì´ìš©í•˜ì—¬ í…Œì´ë¸” ìƒì„±
    * `partitioned by` ì ˆì„ ì´ìš©í•˜ì—¬ `part_date` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ ì„¤ì •

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    * ìœ„ë²„ìŠ¤ìƒµ ìƒí’ˆ íŒë§¤ ì •ë³´ ë¶„ì„
    * ìƒí’ˆ ì¬ê³  í˜„í™© íŒŒì•…
    * ìƒí’ˆ ì˜µì…˜ ì •ë³´ ì¡°íšŒ
    * íŒë§¤ ìƒíƒœ ë³€í™” ì¶”ì 
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    * `sale_stock_id` ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸
    * `part_date` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŒŒí‹°ì…˜ì„ ì§€ì •
    * `goods_id`, `sale_id`, `goods_option_id` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ ë‹¤ë¥¸ ìƒí’ˆ ì •ë³´ í…Œì´ë¸”ê³¼ ì¡°ì¸

### ì¶”ê°€ ì •ë³´

* `run_timestamp` ì»¬ëŸ¼ì€ ë°ì´í„° ì²˜ë¦¬ ì‹œê°„ì„ ë‚˜íƒ€ëƒ„
* `part_hour` ì»¬ëŸ¼ì€ íŒŒí‹°ì…˜ ì‹œê°„ì„ ë‚˜íƒ€ëƒ„
* `precautions` ì»¬ëŸ¼ì€ ìƒí’ˆ ìœ í˜• ì‚¬í•­ì„ ë‚˜íƒ€ëƒ„
* `notification_info` ì»¬ëŸ¼ì€ ìƒí’ˆ ê³ ì§€ ì •ë³´ë¥¼ ë‚˜íƒ€ëƒ„
* `sale_title` ì»¬ëŸ¼ì€ íŒë§¤ íƒ€ì´í‹€ì„ ë‚˜íƒ€ëƒ„
* `sale_comment` ì»¬ëŸ¼ì€ íŒë§¤ ì½”ë©˜íŠ¸ë¥¼ ë‚˜íƒ€ëƒ„  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|goods_id|bigint|ìƒí’ˆ id|
|1|sale_id|bigint|íŒë§¤ id|
|2|stock_id|bigint|ì…ê³  id|
|3|sale_stock_id|bigint|íŒë§¤ìƒí’ˆ ì˜µì…˜ id|
|4|goods_upr_cat_id|bigint|ìƒìœ„ì¹´í…Œê³ ë¦¬ id|
|5|goods_lwr_cat_id|bigint|í•˜ìœ„ì¹´í…Œê³ ë¦¬ id|
|6|we_art_id|int|ì•„í‹°ìŠ¤íŠ¸ id|
|7|goods_option_id|bigint|ìƒí’ˆ ì˜µì…˜ id|
|8|goods_option_group_id|bigint|ìƒí’ˆ ì˜µì…˜ ê·¸ë£¹ id|
|9|trade_co_id|bigint|ê±°ë˜ì²˜ id|
|10|pickup_id|bigint|í˜„ì¥ìˆ˜ë ¹ id|
|11|ship_group_id|bigint|ë°°ì†¡ê·¸ë£¹ id|
|12|deliv_service_dom_id|bigint|êµ­ë‚´ ë°°ì†¡ì‚¬ id|
|13|deliv_service_over_id|bigint|í•´ì™¸ ë°°ì†¡ì‚¬ id|
|14|fc_id|bigint|ë©¤ë²„ì‹­ id|
|15|fc_cat_id|bigint|ë©¤ë²„ì‹­ ì¹´í…Œê³ ë¦¬ id|
|16|goods_code|string|ìƒí’ˆ code|
|17|goods_option_code|string|ìƒí’ˆ ì˜µì…˜ code|
|18|barcode|string|ë°”ì½”ë“œ|
|19|wms_code|string|WMS_ID|
|20|sap_code|string|SAP ìì¬ì½”ë“œ|
|21|wbs_code|string|WBS ì½”ë“œ|
|22|hscode|string|HS Code|
|23|pod_option_sell_code|string|POD ìƒí’ˆ ì˜µì…˜ íŒë§¤ ì½”ë“œ|
|24|pod_template_code|string|POD í…œí”Œë¦¿ ì½”ë“œ|
|25|pod_resource_id|string|POD ë¦¬ì†ŒìŠ¤ ID|
|26|pod_product_code|string|POD ìƒí’ˆ ì½”ë“œ|
|27|pod_product_type|string|POD ìƒí’ˆ ìœ í˜•|
|28|bm_option|string|bm_option|
|29|settlement_category_name|string|ì •ì‚° ì¹´í…Œê³ ë¦¬ëª…|
|30|settlement_category_code|string|ì •ì‚° ì¹´í…Œê³ ë¦¬ì½”ë“œ|
|31|vertex_commodity_code_type|string|Vertex ìƒí’ˆì½”ë“œíƒ€ì…|
|32|vertex_commodity_code_value|string|Vertex ìƒí’ˆì½”ë“œ|
|33|tax_type|string|ì„¸ê¸ˆêµ¬ë¶„|
|34|shop|string|shop|
|35|we_art_name|string|ì•„í‹°ìŠ¤íŠ¸ëª…|
|36|goods_upr_cat_name|string|ìƒìœ„ì¹´í…Œê³ ë¦¬ëª…|
|37|goods_lwr_cat_name|string|í•˜ìœ„ì¹´í…Œê³ ë¦¬ëª…|
|38|sale_upr_cat_name|array<string>|ì•±ë…¸ì¶œ ìƒìœ„ì¹´í…Œê³ ë¦¬|
|39|sale_lwr_cat_name|array<string>|ì•±ë…¸ì¶œ í•˜ìœ„ì¹´í…Œê³ ë¦¬|
|40|goods_cat|string|ìƒí’ˆêµ¬ë¶„ (ë§ˆíŠ¸ë§Œë“¤ë©° ìƒì„±)|
|41|goods_section|string|ìƒí’ˆêµ¬ë¶„|
|42|goods_type|string|ìƒí’ˆ ìœ í˜• (ë°°ì†¡ìƒí’ˆ, ë””ì§€í„¸ìƒí’ˆ)|
|43|goods_option_type|string|ìƒí’ˆ ì¢…ë¥˜ (ìœ í˜•, ë¬´í˜•)|
|44|goods_option_receipt_type|string|ì…ê³  ìœ í˜• (NORMAL, SET, RANDOM)|
|45|logi_cat|string|ë¬¼ë¥˜ ì¹´í…Œê³ ë¦¬|
|46|fc_ver|string|FC ë²„ì „|
|47|fc_kit_ver|string|í‚¤íŠ¸ ë²„ì „|
|48|is_bom_enabled|int|BOM ìœ ë¬´|
|49|bom_sap_codes|array<string>|BOM sap_codeëª¨ìŒ(array)|
|50|goods_name|string|ìƒí’ˆëª…|
|51|goods_option_name|string|ìƒí’ˆ ì˜µì…˜ëª…|
|52|goods_option_group_name|string|ìƒí’ˆ ì˜µì…˜ ê·¸ë£¹ëª…|
|53|sale_stock_name_ko|string|sale_stockëª…(í•œ)|
|54|sale_stock_name_ja|string|sale_stockëª…(ì¼)|
|55|sale_stock_name_en|string|sale_stockëª…(ì˜)|
|56|release_name|string|ìƒí’ˆì¶œí•˜ëª…|
|57|currency_code|string|í†µí™”|
|58|original_price|double|ìƒí’ˆ ì •ê°€|
|59|sale_price|double|íŒë§¤ê°€ê²©|
|60|is_fixed_price|tinyint|ê³ ì •ê°€ê²© ì—¬ë¶€|
|61|final_sale_price|double|ìµœì¢… íŒë§¤ê°€ê²© (ê³ ì •ê°€ê²©ì¸ ê²½ìš° ê³ ì •ê°€ê²©ì„ íŒë§¤ê°€ê²©ìœ¼ë¡œ í•¨)|
|62|fixed_sale_price|double|ê³ ì • íŒë§¤ê°€|
|63|fixed_sale_price_USD|double|ê³ ì • íŒë§¤ê°€ (USD)|
|64|fixed_sale_price_JPY|double|ê³ ì • íŒë§¤ê°€ (JPY)|
|65|max_ord_qty|int|ìµœëŒ€ êµ¬ë§¤ê°€ëŠ¥ìˆ˜ëŸ‰|
|66|max_ord_lim_type|string|ìµœëŒ€ êµ¬ë§¤ìˆ˜ëŸ‰ ì¡°ê±´ê°’|
|67|max_ord_lim_p_user|tinyint|ìµœëŒ€ êµ¬ë§¤ìˆ˜ëŸ‰ íšŒì›ë³„ ì£¼ë¬¸ì œì•½ ì—¬ë¶€|
|68|sale_alrarm_pc|tinyint|ì¬ê³ ì•Œë¦¼ % (íŒë§¤ë“±ë¡ ìˆ˜ëŸ‰ì˜ n%ê°€ ë˜ì—ˆì„ ê²½ìš° ì•ŒëŒë°›ê¸°)|
|69|min_ord_qty|int|ìµœì†Œ ì£¼ë¬¸ê°€ëŠ¥ìˆ˜ëŸ‰|
|70|is_cart|tinyint|ì¹´íŠ¸ì‚¬ìš©ì—¬ë¶€|
|71|is_tax|tinyint|íŒë§¤ì„¸ì ìš© ì—¬ë¶€|
|72|is_incl_tax|tinyint|ìƒí’ˆê°€ê²©ì— íŒë§¤ì„¸í¬í•¨ ì—¬ë¶€|
|73|sale_status|string|íŒë§¤ ìƒíƒœ|
|74|shop_tags|string|ìƒµ íƒœê·¸|
|75|is_digital_live|tinyint|ë””ì§€í„¸ ë¼ì´ë¸Œ ìƒí’ˆ ì—¬ë¶€|
|76|weight|double|ì¤‘ëŸ‰|
|77|package_size|string|íŒ¨í‚¤ì§€ ì‚¬ì´ì¦ˆ|
|78|album_qty|int|ì•¨ë²” ìˆ˜ëŸ‰|
|79|business_type|string|ê±°ë˜ë°©ì‹ (1:ì‚¬ì…, 2:ìœ„íƒ)|
|80|tot_goods_qty|int|ì´ ì…ê³  ìˆ˜ëŸ‰ (ëˆ„ì )|
|81|exp_goods_qty|int|ì…ê³  ìš”ì²­í•œ ìˆ˜ëŸ‰|
|82|real_goods_qty|int|ì‹¤ì œ ì…ê³ ëœ ìˆ˜ëŸ‰|
|83|fake_goods_qty|int|ê°€ì…ê³  ìˆ˜ëŸ‰|
|84|is_sale_hide|tinyint|ë…¸ì¶œì—¬ë¶€ (íŒë§¤ ìƒíƒœì˜ ë”ë¯¸)|
|85|is_sale_stock_hide|tinyint|íŒë§¤ ì˜µì…˜ ë…¸ì¶œ ì—¬ë¶€|
|86|is_restock_alarm|tinyint|ì¬ì…ê³ ì•Œë¦¼ ì„¤ì • ì—¬ë¶€|
|87|is_exclusive_icon|int|ë‹¨ë…íŒë§¤ ì—¬ë¶€|
|88|is_sold_out_icon_enabled|tinyint|ì†”ë“œì•„ì›ƒ ê²½ê³  ë…¸ì¶œ ì„¤ì •|
|89|sold_out_alarm_pc|tinyint|ì†”ë“œì•„ì›ƒ ê²½ê³  ë…¸ì¶œ percent(%)|
|90|will_be_sold_out|int|ì†”ë“œì•„ì›ƒ ê²½ê³ ì¤‘|
|91|is_fixed_cash_amount|int|ê°œë³„ ìºì‹œ ì„¤ì • ì‚¬ìš©|
|92|fixed_cash_amount|double|ì„¤ì • ìºì‹œ(KRW)|
|93|deliv_dt|timestamp|ë°°ì†¡ ì˜ˆì •ì¼ì‹œ|
|94|sale_qty|int|íŒë§¤ìˆ˜ëŸ‰|
|95|avail_sale_qty|int|íŒë§¤ê°€ëŠ¥ìˆ˜ëŸ‰|
|96|common_info|string|êµí™˜/ë°˜í’ˆ ê³µí†µì •ë³´|
|97|manufacturer|string|ì œì¡°ì‚¬|
|98|origins|array<string>|ì›ì‚°ì§€(êµ­ê°€ì½”ë“œ)|
|99|origins_ctry_name|array<string>|ì›ì‚°ì§€(êµ­ê°€ëª…-ì˜ë¬¸)|
|100|trade_co_name|string|ê±°ë˜ì²˜|
|101|ship_group_name|string|ë°°ì†¡ê·¸ë£¹ ì´ë¦„|
|102|deliv_service_dom_code|string|êµ­ë‚´ ë°°ì†¡ì‚¬ ì½”ë“œ|
|103|deliv_service_dom_name|string|êµ­ë‚´ ë°°ì†¡ì‚¬ ì´ë¦„|
|104|deliv_service_over_code|string|í•´ì™¸ ë°°ì†¡ì‚¬ ì½”ë“œ|
|105|deliv_service_over_name|string|í•´ì™¸ ë°°ì†¡ì‚¬ ì´ë¦„|
|106|pickup_name|string|í”½ì—… ëª…|
|107|pickup_location|string|í”½ì—… ì¥ì†Œ|
|108|pickup_location_postal_code|string|í”½ì—… ì¥ì†Œ ìš°í¸ë²ˆí˜¸|
|109|sale_start_at|timestamp|íŒë§¤ ì‹œì‘ì¼|
|110|sale_end_at|timestamp|íŒë§¤ ì¢…ë£Œì¼|
|111|sale_reserv_history|array<struct>|íŒë§¤ ìƒíƒœ ì˜ˆì•½ì •ë³´|
|112|goods_cre_dt|timestamp|ìƒí’ˆë“±ë¡ì¼|
|113|stock_upd_dt|timestamp|ì¬ê³ ì—…ë°ì´íŠ¸ì¼|
|114|sale_cre_dt|timestamp|íŒë§¤ë“±ë¡ì¼|
|115|sale_upd_dt|timestamp|íŒë§¤ ì—…ë°ì´íŠ¸ì¼|
|116|sale_stock_upd_dt|timestamp|íŒë§¤ì¬ê³  ì—…ë°ì´íŠ¸ì¼|
|117|run_timestamp|timestamp| |
|118|part_date|string|íŒŒí‹°ì…˜ ì¼ì|
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `ws_goods_stock` í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ ì‹œê°„ëŒ€ë³„ ìƒí’ˆ íŒë§¤ í˜„í™©ì„ íŒŒì•…í•˜ëŠ” `stats_ws_h_goods_stock` í…Œì´ë¸” ìƒì„±
    - ```sql
      create or replace table we_mart.stats_ws_h_goods_stock (
        key_date date comment 'ê¸°ì¤€ ì¼ì',
        key_datehour timestamp comment 'ê¸°ì¤€ ì‹œê°„',
        we_art_id int comment 'ì•„í‹°ìŠ¤íŠ¸ id',
        shop string comment 'ìƒµ',
        sale_id bigint comment 'íŒë§¤ id',
        sale_stock_id bigint comment 'íŒë§¤ ìƒí’ˆ ì˜µì…˜ id',
        goods_id bigint comment 'ìƒí’ˆ id',
        goods_option_id bigint comment 'ìƒí’ˆ ì˜µì…˜ id',
        goods_name string comment 'ìƒí’ˆëª…',
        goods_option_name string comment 'ìƒí’ˆ ì˜µì…˜ëª…',
        goods_upr_cat_name string comment 'ìƒìœ„ ì¹´í…Œê³ ë¦¬ëª…',
        goods_lwr_cat_name string comment 'í•˜ìœ„ ì¹´í…Œê³ ë¦¬ëª…',
        goods_cat string comment 'ìƒí’ˆ êµ¬ë¶„',
        logi_cat string comment 'ë¬¼ë¥˜ ì¹´í…Œê³ ë¦¬',
        currency_code string comment 'í†µí™”',
        sale_price double comment 'íŒë§¤ ê°€ê²©',
        tot_goods_qty int comment 'ì´ ì…ê³  ìˆ˜ëŸ‰',
        exp_goods_qty int comment 'ì…ê³  ìš”ì²­ ìˆ˜ëŸ‰',
        real_goods_qty int comment 'ì‹¤ì œ ì…ê³  ìˆ˜ëŸ‰',
        fake_goods_qty int comment 'ê°€ì…ê³  ìˆ˜ëŸ‰',
        avail_sale_qty int comment 'íŒë§¤ ê°€ëŠ¥ ìˆ˜ëŸ‰',
        part_date string comment 'íŒŒí‹°ì…˜ ì¼ì',
        run_timestamp timestamp comment 'ë°°ì¹˜ ì‹œê°„'
      )
      partitioned by (part_date)
      comment 'ì‹œê°„ëŒ€ë³„ ìƒí’ˆ ì¬ê³  ë° íŒë§¤ í˜„í™©';
      
      -- `ws_goods_stock` í…Œì´ë¸”ì„ `stats_ws_h_goods_stock` í…Œì´ë¸”ì— ì‹œê°„ëŒ€ë³„ë¡œ ì§‘ê³„í•˜ì—¬ ì¶”ê°€
      insert into we_mart.stats_ws_h_goods_stock
      select
        date(GDS.stock_upd_dt) as key_date,
        date_trunc('hour', GDS.stock_upd_dt) as key_datehour,
        GDS.we_art_id,
        GDS.shop,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.goods_cat,
        GDS.logi_cat,
        GDS.currency_code,
        GDS.sale_price,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.avail_sale_qty,
        date(GDS.stock_upd_dt) as part_date,
        current_timestamp() as run_timestamp
      from we_mart.ws_goods_stock as GDS
      where GDS.part_date = '2024-01-01';
      
      -- `stats_ws_h_goods_stock` í…Œì´ë¸”ì— `ws_goods_stock` í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì¶”ê°€
      insert overwrite table we_mart.stats_ws_h_goods_stock partition(part_date = '2024-01-01')
      select
        date(GDS.stock_upd_dt) as key_date,
        date_trunc('hour', GDS.stock_upd_dt) as key_datehour,
        GDS.we_art_id,
        GDS.shop,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.goods_cat,
        GDS.logi_cat,
        GDS.currency_code,
        GDS.sale_price,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.avail_sale_qty,
        date(GDS.stock_upd_dt) as part_date,
        current_timestamp() as run_timestamp
      from we_mart.ws_goods_stock as GDS
      where GDS.part_date = '2024-01-01';
    ```
- `ws_goods_stock` í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ìƒí’ˆ íŒë§¤ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” `view_ws_goods_stock_artist` ë·° ìƒì„±
    - ```sql
      create or replace view we_mart.view_ws_goods_stock_artist as
      select 
        GDS.we_art_id,
        GDS.we_art_name,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.we_art_id = ARTIST; -- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ idë¥¼ ì…ë ¥
    ```
### Data Extraction
- `ws_goods_stock` í…Œì´ë¸”ì—ì„œ íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŒë§¤ëœ ìƒí’ˆì˜ ìµœì‹  ì¬ê³  ì •ë³´ ì¶”ì¶œ
    - ```sql
      select 
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.part_date = '2024-01-01' -- íŠ¹ì • ë‚ ì§œë¥¼ ì…ë ¥
      and GDS.sale_id in (select distinct sale_id from we_mart.ws_goods_stock where part_date >= '2024-01-01' and part_date <= '2024-01-31'); -- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŒë§¤ëœ ìƒí’ˆì˜ sale_idë§Œ ì¶”ì¶œ
    ```
- `ws_goods_stock` í…Œì´ë¸”ì—ì„œ íŠ¹ì • ìƒí’ˆì˜ ì¬ê³  ë³€ë™ ì´ë ¥ ì¶”ì¶œ
    - ```sql
      select 
        GDS.part_date,
        GDS.stock_upd_dt,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.avail_sale_qty
      from we_mart.ws_goods_stock as GDS
      where GDS.goods_id = GOODS_ID -- íŠ¹ì • ìƒí’ˆ idë¥¼ ì…ë ¥
      order by GDS.part_date, GDS.stock_upd_dt;
    ```
- `ws_goods_stock` í…Œì´ë¸”ì—ì„œ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ íŠ¹ì • ìƒí’ˆì˜ ì¬ê³  ì •ë³´ ì¶”ì¶œ
    - ```sql
      select 
        GDS.we_art_id,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.we_art_id = ARTIST -- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ idë¥¼ ì…ë ¥
      and GDS.goods_id = GOODS_ID -- íŠ¹ì • ìƒí’ˆ idë¥¼ ì…ë ¥
      order by GDS.part_date;
    ```
- `ws_goods_stock` í…Œì´ë¸”ì—ì„œ íŠ¹ì • ì¹´í…Œê³ ë¦¬ ìƒí’ˆì˜ ì¬ê³  ì •ë³´ ì¶”ì¶œ
    - ```sql
      select 
        GDS.goods_upr_cat_name,
        GDS.goods_lwr_cat_name,
        GDS.goods_name,
        GDS.goods_option_name,
        GDS.sale_id,
        GDS.sale_stock_id,
        GDS.goods_id,
        GDS.goods_option_id,
        GDS.sale_price,
        GDS.sale_qty,
        GDS.avail_sale_qty,
        GDS.tot_goods_qty,
        GDS.exp_goods_qty,
        GDS.real_goods_qty,
        GDS.fake_goods_qty,
        GDS.part_date
      from we_mart.ws_goods_stock as GDS
      where GDS.goods_upr_cat_id = GOODS_UPR_CAT_ID -- íŠ¹ì • ìƒìœ„ ì¹´í…Œê³ ë¦¬ idë¥¼ ì…ë ¥
      and GDS.goods_lwr_cat_id = GOODS_LWR_CAT_ID -- íŠ¹ì • í•˜ìœ„ ì¹´í…Œê³ ë¦¬ idë¥¼ ì…ë ¥
      order by GDS.part_date;
    ```  
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_we_mart_hourly`, `analytics_ws_mart_daily`

### Update Interval: HOURLY, DAILY

### Update Type:  

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/ws_goods_stock.py)

### Airflow DAGs

- [analytics_we_mart_hourly](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_hourly.py)
- [analytics_ws_mart_daily](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_ws_mart_daily.py)
  
    
---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|membership.artist_shop_version|we_mart.stats_we_d_billing_payment_trx|
|membership.benefit|we_mart.stats_ws_d_album_cumul_kpi|
|membership.membership|we_mart.stats_ws_d_cart_item|
|membership.membership_benefit|we_mart.stats_ws_d_ext_ord|
|membership.membership_version|we_mart.stats_ws_d_fc_kit_pur|
|product.status_reservation|we_mart.stats_ws_h_ord_product_concert|
|product.status_reservation_item|we_mart.stats_ws_h_ord_product_detail|
|settlement.settlement_category|we_mart.stats_wv_d_ops_sales|
|we_mart.ods_ws_goods|we_mart.tmp_val_fc_kit_pur|
|we_mart.ods_ws_goods_category|we_mart.view_ipx_ws_goods_stock|
|we_mart.ods_ws_goods_goods_category|we_mart.view_wej_ws_order|
|we_mart.ods_ws_goods_option|we_mart.view_ws_goods_stock_update|
|we_mart.ods_ws_goods_option_group|we_mart.view_ws_ship_status_fc_kit|
|we_mart.ods_ws_goods_stock|we_mart.we_fan_order|
|we_mart.ods_ws_goods_translation|we_mart.we_order|
|we_mart.ods_ws_sale|we_mart.we_sale|
|we_mart.ods_ws_sale_fixed_price|we_mart.ws_order|
|we_mart.ods_ws_sale_stock|we_mart.ws_user_buy|
|we_mart.ods_ws_shipping_group|we_meta.we_digital_product|
|we_mart.ods_ws_stock| |
|we_mart.ods_ws_trade_company| |
|we_mart.we_artist| |
|we_meta.we_country| |
|weverseshop.artist_sale| |
|weverseshop.common_info| |
|weverseshop.delivery_service| |
|weverseshop.goods_category| |
|weverseshop.goods_option| |
|weverseshop.goods_option_component| |
|weverseshop.pickup| |
|weverseshop.sale_stock_name| |
|weverseshop.sale_translation| |

## ğŸ¤ Downstream Tables Info
  
No content.  
---