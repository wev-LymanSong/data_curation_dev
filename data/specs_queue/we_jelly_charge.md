
we_mart.we_jelly_charge
=======================

# BASIC INFO

|**About**| ë‹´ë‹¹ì ìˆ˜ê¸° ì…ë ¥ í•„ìš” |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**| |
|**Created/ Last Updated At**|2023-05-10 / 2024-08-08|
|**Created By**|ì†¡ì¬ì˜|
|**Last Updated By**|ì†¡ì¬ì˜|
|**Collaborators**|ì†¡ì¬ì˜[20], êµ¬ë¯¼ì„œ[6]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2023-05-10|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/2fa49acfc0ae158cb10333d4993db2207df08177)|
|2023-05-10|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e3c19e4599f029aac94a03d94d02b981a4d7699c)|
|2023-05-12|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/75f953a8379aa388a8a9ebbf3cdb9d6cd495b117)|
|2023-07-21|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e1bb21f406cb0b32616e7ffdbcda0d93bf3822f8)|
|2023-07-25|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/99cfabac5904eb073e650ce643739960f1e6a3c4)|
|2023-07-27|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/202ca162c0038bcd119fe5147a43986f1f9218b7)|
|2023-08-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f6c10cb4390edff034676e44636daedf14bebfd0)|
|2023-09-13|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/65097c805fa895e84903c3a0b63e2b8a5fb34628)|
|2023-09-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3c2c65e38e77ea09f4105682f3041fbb223f785c)|
|2023-09-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6e66abd8e650aca025d7e8bb821ef39890c3e28c)|
|2023-10-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/bb989c25d4271adb8ce26d67a64922dbba35ab3a)|
|2023-10-31|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/171ac599f22f35c840c62d9662fc64305441d312)|
|2023-11-02|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/26ef97d4d2e7e1f15805c09decb5b44e620f289e)|
|2023-11-09|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f434fce5783268929e509e49ec73e29369dab4df)|
|2024-01-03|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/45c4365383107ae1e8efe7211383c9f3924d8d17)|
|2024-01-03|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/7838f1ace351dacc2e49be0dcd4d7e2bc2995372)|
|2024-01-04|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/60bb531bea609d52ff6b2b442436ab60f4ddfe66)|
|2024-01-15|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/7d1d59a1d74d176c40cdebbdf839a305d36dce1b)|
|2024-03-04|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/9f316b99fdfbedd05d4d630bd2d0db01b40ef50e)|
|2024-03-06|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/15cb24bbcb63a707307e11dcf5a62c928097aed4)|
|2024-05-29|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/964c62c089c2238a9ce615e32905b55b6f5627aa)|
|2024-05-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f0d3c4ba3262ea1ef26037a5d1d8695930bec7a4)|
|2024-05-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/513fb33efe109ee81d45bbcadd57d4a04567f2d9)|
|2024-07-01|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/4f06e9b9ef59c8bcaefe6b79d759edb90dcbd60a)|
|2024-07-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/21da1795061451c1397d4b388a87e68712a3483e)|
|2024-08-08|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/137aad3401e77e90b82628e9c736bc5b9bc5d599)|
  
  
# TABLE NOTICE
  
### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: ìœ„ë²„ìŠ¤ í”Œë«í¼ì—ì„œ ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ì„ ê¸°ë¡í•˜ëŠ” í…Œì´ë¸”
* **ë°ì´í„° ë ˆë²¨**: TRANSACTIONAL DATA
* **íŒŒí‹°ì…˜ í‚¤**: ì—†ìŒ
* **ì£¼ìš” í‚¤**: `charge_id`

### í…Œì´ë¸” íŠ¹ì§•

* ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ê³¼ ì—°ê´€ëœ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ í¬í•¨: ì¶©ì „ëœ ì ¤ë¦¬ ì¢…ë¥˜, ê²°ì œ ë°©ì‹, ê²°ì œ ìƒíƒœ, êµ­ê°€ ì •ë³´ ë“±
* `we_member_id`ë¥¼ í†µí•´ ìœ„ë²„ìŠ¤ í”Œë«í¼ ìœ ì € ì •ë³´ì™€ ì—°ê²° ê°€ëŠ¥
* `pur_transaction_id`ë¥¼ í†µí•´ `we_mart.purchase_table` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `jelly_id`ë¥¼ í†µí•´ `we_mart.we_jelly` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `product_id`ë¥¼ í†µí•´ `we_meta.we_digital_product` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1. **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    * `wev_prod.jelly.transaction`: ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ ì •ë³´
    * `wev_prod.we_mart.we_jelly`: ì ¤ë¦¬ ìƒí’ˆ ì •ë³´
    * `wev_prod.we_mart.we_user`: ìœ„ë²„ìŠ¤ ìœ ì € ì •ë³´
    * `purchase_table`: ìœ„ë²„ìŠ¤ í”Œë«í¼ì—ì„œ ì ¤ë¦¬ ìƒí’ˆ êµ¬ë§¤ ë‚´ì—­ì„ ì •ë¦¬í•œ ì„ì‹œ í…Œì´ë¸”
    * `user_ctry`: ìœ„ë²„ìŠ¤ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì •ë¦¬í•œ ì„ì‹œ í…Œì´ë¸”
    * `wev_prod.we_meta.we_digital_product`: ì ¤ë¦¬ ìƒí’ˆì˜ íŒë§¤ ê°€ê²© ì •ë³´
2. **ë°ì´í„° ì „ì²˜ë¦¬**:
    * `wev_prod.jelly.transaction` í…Œì´ë¸”ì—ì„œ `transaction_type`ì´ `CHARGE`ì¸ ë°ì´í„°ë§Œ ì¶”ì¶œ
    * `purchase_table` í…Œì´ë¸”ê³¼ `wev_prod.jelly.transaction` í…Œì´ë¸”ì„ `payment_id`ë¥¼ í†µí•´ ì¡°ì¸í•˜ì—¬ ê²°ì œ ì •ë³´ë¥¼ ì¶”ê°€
    * `wev_prod.we_mart.we_jelly` í…Œì´ë¸”ê³¼ `wev_prod.jelly.transaction` í…Œì´ë¸”ì„ `point_id`ë¥¼ í†µí•´ ì¡°ì¸í•˜ì—¬ ì ¤ë¦¬ ìƒí’ˆ ì •ë³´ë¥¼ ì¶”ê°€
    * `wev_prod.we_meta.we_digital_product` í…Œì´ë¸”ê³¼ `wev_prod.jelly.transaction` í…Œì´ë¸”ì„ `product_id`ì™€ `jelly_store_item_id`ë¥¼ í†µí•´ ì¡°ì¸í•˜ì—¬ ìƒí’ˆ íŒë§¤ ê°€ê²© ì •ë³´ë¥¼ ì¶”ê°€
    * `user_ctry` í…Œì´ë¸”ê³¼ `wev_prod.jelly.transaction` í…Œì´ë¸”ì„ `user_id`ì™€ `cre_dt`ë¥¼ í†µí•´ ì¡°ì¸í•˜ì—¬ ìœ„ë²„ìŠ¤ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì¶”ê°€
3. **ë°ì´í„° í†µí•©**:
    * ìœ„ì—ì„œ ì „ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ í†µí•©
4. **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    * í†µí•©ëœ ë°ì´í„°í”„ë ˆì„ì„ `we_mart.we_jelly_charge` í…Œì´ë¸”ì— ì €ì¥

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    * ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ ë¶„ì„
    * ì ¤ë¦¬ ìƒí’ˆ íŒë§¤ í˜„í™© ë¶„ì„
    * ì ¤ë¦¬ ê²°ì œ ì‹œìŠ¤í…œ ì„±ëŠ¥ ë¶„ì„
    * ìœ„ë²„ìŠ¤ ìœ ì €ì˜ ì ¤ë¦¬ ì¶©ì „ íŒ¨í„´ ë¶„ì„
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    * `we_member_id`ë¥¼ í†µí•´ `we_mart.we_user` í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ìœ ì € ì •ë³´ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŒ
    * `pur_transaction_id`ë¥¼ í†µí•´ `we_mart.purchase_table` í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ê²°ì œ ì •ë³´ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŒ
    * `jelly_id`ë¥¼ í†µí•´ `we_mart.we_jelly` í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ì ¤ë¦¬ ìƒí’ˆ ì •ë³´ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŒ
    * `product_id`ë¥¼ í†µí•´ `we_meta.we_digital_product` í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ìƒí’ˆ íŒë§¤ ê°€ê²© ì •ë³´ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŒ

### ì¶”ê°€ ì •ë³´

* `jelly_qty_total` ì»¬ëŸ¼ì€ ì¼ë°˜ ì ¤ë¦¬ ì¶©ì „ëŸ‰ê³¼ í”„ë¡œëª¨ì…˜ ì ¤ë¦¬ ì¶©ì „ëŸ‰ì„ í•©ì³ì„œ ë‚˜íƒ€ëƒ„
* `sale_price_krw` ì»¬ëŸ¼ì€ ì ¤ë¦¬ ìƒí’ˆì˜ íŒë§¤ ê°€ê²©ì„ í•œí™”ë¡œ í‘œì‹œ
* `ord_ctry_code` ì»¬ëŸ¼ì€ ì ¤ë¦¬ ì¶©ì „ ì‹œ ì‚¬ìš©ëœ IP ì£¼ì†Œ ê¸°ë°˜ êµ­ê°€ ì •ë³´
* `wv_ctry_code` ì»¬ëŸ¼ì€ ìœ„ë²„ìŠ¤ ìœ ì €ì˜ ì ‘ì† IP ì£¼ì†Œ ê¸°ë°˜ êµ­ê°€ ì •ë³´
* `run_timestamp` ì»¬ëŸ¼ì€ ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ ë°ì´í„°ê°€ í…Œì´ë¸”ì— ì ì¬ëœ ì‹œê°„ì„ ë‚˜íƒ€ëƒ„  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|we_member_id|bigint|ìœ„ë²„ìŠ¤ í”Œë«í¼ í†µí•© ìœ ì € ID|
|1|charge_id|string|ì¶©ì „ ê±°ë˜ ID(transaction_id)|
|2|jelly_id|bigint|ì ¤ë¦¬ ID(jelly.point.id)|
|3|product_id|bigint|ì ¤ë¦¬ ìƒí’ˆ ID(product.product.id)|
|4|jelly_group_id|bigint|ì ¤ë¦¬ ê·¸ë£¹ ID(jelly.point_group.id)|
|5|jelly_product_name|string|ì ¤ë¦¬ ìƒí’ˆ ëª…|
|6|promotion_jelly_id|bigint|ì ¤ë¦¬ í”„ë¡œëª¨ì…˜ ID(jelly.promotion_point.id)|
|7|promotion_jelly_product_name|string|ì ¤ë¦¬ í”„ë¡œëª¨ì…˜ ìƒí’ˆ ëª…|
|8|jelly_store_item_id|string|ì¸ì•± ìƒí’ˆ ID|
|9|channel|string|ì ¤ë¦¬ ìƒí’ˆì´ ì†í•œ ê²°ì œ ì±„ë„|
|10|jelly_unit_price|double|ì ¤ë¦¬ ë‚´ë¶€ ë‹¨ê°€|
|11|jelly_selling_unit_price|double|ì ¤ë¦¬ íŒë§¤ ë‹¨ê°€|
|12|promotion_jelly_unit_price|double|í”„ë¡œëª¨ì…˜ ì ¤ë¦¬ í™˜ì‚° ë‹¨ê°€|
|13|jelly_qty|int|ì ¤ë¦¬ ìƒí’ˆì˜ ì¶©ì „ ì ¤ë¦¬ ìˆ˜|
|14|jelly_qty_promotion|int|í”„ë¡œëª¨ì…˜ ì ¤ë¦¬ ìƒí’ˆì˜ ì¶©ì „ ì ¤ë¦¬ ìˆ˜|
|15|jelly_qty_total|int|ì „ì²´ ì¶©ì „ ì ¤ë¦¬ ìˆ˜(ì¼ë°˜ ì¶©ì „ëŸ‰ + í”„ë¡œëª¨ì…˜ ì¶©ì „ëŸ‰)|
|16|jelly_wallet_type|string|ì ¤ë¦¬ ìœ ë¬´ë£Œ ì—¬ë¶€(PAID: ìœ ë£Œ ì¶©ì „ ì ¤ë¦¬, FREE: ë¬´ë£Œ ì§€ê¸‰ ì ¤ë¦¬)|
|17|pay_system|string|ê²°ì œ ë°©ì‹(= billing.purchase.system)|
|18|pay_method|string|ê²°ì œ ë°©ì‹ì— ë”°ë¥¸ ê²°ì œ ìˆ˜ë‹¨|
|19|pay_method_detail|string|ê²°ì œ ë°©ì‹, ê²°ì œ ìˆ˜ë‹¨ì— ë”°ë¥¸ ì„¸ë¶€ ê²°ì œ ì‚¬|
|20|pay_card_type|string|ê²°ì œì— ì‚¬ìš©í•œ ì²´í¬/ì‹ ìš©ì¹´ë“œ|
|21|payment_id|string|ê²°ì œ ID(= billing.purchase.purchase_id)|
|22|trx_cre_dt|timestamp|ê±°ë˜ ê¸°ì¤€ ìƒì„±ì¼(UTC)|
|23|first_exp_dt|timestamp|ì²« ì¶©ì „ ì‹œ ë§Œë£Œ ì¼ì‹œ(UTC)|
|24|pur_transaction_id|string|êµ¬ë§¤ ê±°ë˜ ID(= billing.purchase.transaction_id)|
|25|is_pay|int|ê²°ì œ ì—¬ë¶€|
|26|is_cx|int|ê²°ì œ ì·¨ì†Œ ì—¬ë¶€|
|27|is_partial_cx|int|ë¶€ë¶„ ì·¨ì†Œ ì—¬ë¶€|
|28|ord_status|string|ê²°ì œ ìƒíƒœ|
|29|ord_ctry_code|string|ê²°ì œ ê¸°ì¤€ IP êµ­ê°€ ì •ë³´|
|30|wv_ctry_code|string|ìœ„ë²„ìŠ¤ ì ‘ì† ê¸°ì¤€ IP êµ­ê°€ ì •ë³´|
|31|ord_item_qty|int|ì£¼ë¬¸ ìƒí’ˆ ìˆ˜|
|32|ord_item_amt|double|ì£¼ë¬¸ ìƒí’ˆ ì´ ê²°ì œì•¡|
|33|ord_item_cx_amt|double|ì£¼ë¬¸ ìƒí’ˆ ì´ ì·¨ì†Œì•¡|
|34|sale_price_krw|double|ìƒí’ˆ í•œí™” íŒë§¤ ê°€ê²©|
|35|currency_code|string|ì£¼ë¬¸ í†µí™”|
|36|pur_confirmed_at|timestamp|ê²°ì œ ì™„ë£Œ ì¼ì‹œ(UTC)|
|37|cx_dt|timestamp|ê²°ì œ ì·¨ì†Œ ì¼ì‹œ(UTC)|
|38|run_timestamp|timestamp|ë°ì´í„° ì ì¬ ì¼ì‹œ(UTC)|
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `wv_user` í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ìœ ì €ë³„ ì ¤ë¦¬ ì¶©ì „ ì •ë³´ë¥¼ ìƒì„±í•˜ëŠ” í…Œì´ë¸”
    - ```sql
      select 
      we_jelly_charge.we_member_id,
      we_jelly_charge.jelly_id,
      we_jelly_charge.jelly_qty,
      we_jelly_charge.jelly_qty_promotion,
      we_jelly_charge.jelly_wallet_type,
      we_jelly_charge.pay_system,
      we_jelly_charge.pay_method,
      we_jelly_charge.trx_cre_dt,
      we_user.wv_user_id,
      we_user.user_nm,
      we_user.user_email,
      we_user.user_phone
      from wev_prod.we_mart.we_jelly_charge
      left join wev_prod.we_mart.we_user
      on we_jelly_charge.we_member_id = we_user.we_member_id
      ```
- `we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì›”ë³„ êµ­ê°€ë³„ ì ¤ë¦¬ ì¶©ì „ í˜„í™©ì„ ì§‘ê³„í•˜ëŠ” í…Œì´ë¸”
    - ```sql
      select 
      date_trunc('month', we_jelly_charge.trx_cre_dt) as charge_month,
      we_jelly_charge.wv_ctry_code,
      sum(we_jelly_charge.jelly_qty) as total_jelly_qty,
      count(distinct we_jelly_charge.charge_id) as charge_count
      from wev_prod.we_mart.we_jelly_charge
      group by 1, 2
      ```
- `we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ ë£Œ/ë¬´ë£Œ ì ¤ë¦¬ ì¶©ì „ í˜„í™©ì„ ì§‘ê³„í•˜ëŠ” í…Œì´ë¸”
    - ```sql
      select
      we_jelly_charge.jelly_wallet_type,
      sum(we_jelly_charge.jelly_qty) as total_jelly_qty,
      count(distinct we_jelly_charge.charge_id) as charge_count
      from wev_prod.we_mart.we_jelly_charge
      group by 1
      ```
- `we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ê²°ì œ ìˆ˜ë‹¨ë³„ ì ¤ë¦¬ ì¶©ì „ í˜„í™©ì„ ì§‘ê³„í•˜ëŠ” í…Œì´ë¸”
    - ```sql
      select
      we_jelly_charge.pay_system,
      we_jelly_charge.pay_method,
      sum(we_jelly_charge.jelly_qty) as total_jelly_qty,
      count(distinct we_jelly_charge.charge_id) as charge_count
      from wev_prod.we_mart.we_jelly_charge
      group by 1, 2
      ```

### Data Extraction
- íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŠ¹ì • êµ­ê°€ì—ì„œ ë°œìƒí•œ ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ ì¡°íšŒ
    - ```sql
      select 
      we_member_id,
      jelly_id,
      jelly_qty,
      jelly_qty_promotion,
      jelly_wallet_type,
      pay_system,
      pay_method,
      trx_cre_dt
      from wev_prod.we_mart.we_jelly_charge
      where wv_ctry_code = 'KR' 
      and trx_cre_dt >= '2024-01-01' 
      and trx_cre_dt < '2024-02-01'
      ```
- íŠ¹ì • ìœ ì €ì˜ ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ ì¡°íšŒ
    - ```sql
      select 
      charge_id,
      jelly_id,
      jelly_qty,
      jelly_qty_promotion,
      jelly_wallet_type,
      pay_system,
      pay_method,
      trx_cre_dt
      from wev_prod.we_mart.we_jelly_charge
      where we_member_id = 12345
      ```
- íŠ¹ì • ì ¤ë¦¬ ìƒí’ˆì— ëŒ€í•œ ì¶©ì „ ë‚´ì—­ ì¡°íšŒ
    - ```sql
      select 
      we_member_id,
      charge_id,
      jelly_qty,
      jelly_qty_promotion,
      jelly_wallet_type,
      pay_system,
      pay_method,
      trx_cre_dt
      from wev_prod.we_mart.we_jelly_charge
      where jelly_id = 12345
      ```
- íŠ¹ì • ê²°ì œ ìˆ˜ë‹¨ì„ ì‚¬ìš©í•œ ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ ì¡°íšŒ
    - ```sql
      select 
      we_member_id,
      charge_id,
      jelly_qty,
      jelly_qty_promotion,
      jelly_wallet_type,
      trx_cre_dt
      from wev_prod.we_mart.we_jelly_charge
      where pay_system = 'PG'
      and pay_method = 'CARD'
      ```  
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_we_mart_priority_daily`

### Update Interval: DAILY

### Update Type: OVERWRITE

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/we_jelly_charge.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_priority_daily.py)
  
    
---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|billing.in_app_purchase|we_mart.stats_we_d_jelly_charge|
|jelly.point|we_mart.stats_we_d_jelly_charge_smry|
|jelly.transaction|we_mart.wv_jelly_transaction|
|payment.payment|we_mart.wv_order|
|test.we_jelly| |
|we_mart.we_jelly| |
|we_mart.we_reward_history| |
|we_mart.we_user| |
|we_mart.wv_user_ctry_history| |
|we_meta.we_digital_product| |

## ğŸ¤ Downstream Tables Info
  
### Downstream Tables
- **`we_mart.wv_jelly_transaction`**: ì ¤ë¦¬ ì¶©ì „/ì‚¬ìš©/í™˜ë¶ˆ/í™˜ê¸‰/ë§Œë£Œì— ëŒ€í•œ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ” í…Œì´ë¸”. ì ¤ë¦¬ ì¶©ì „ ë‚´ì—­ì„ í¬í•¨í•œ ëª¨ë“  ê±°ë˜ ë‚´ì—­ì„ ê¸°ë¡í•œë‹¤. 
    - `we_mart.we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì ¤ë¦¬ ì¶©ì „ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ì ¤ë¦¬ ì¶©ì „/ì‚¬ìš©/í™˜ë¶ˆ/í™˜ê¸‰/ë§Œë£Œì— ëŒ€í•œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_we_d_jelly_charge`**: ì ¤ë¦¬ ì¶©ì „ì— ëŒ€í•œ í†µê³„ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ” í…Œì´ë¸”. 
    - `we_mart.we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì ¤ë¦¬ ì¶©ì „ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ë‚ ì§œë³„, ì±„ë„ë³„, ê²°ì œ ìˆ˜ë‹¨ë³„ ì ¤ë¦¬ ì¶©ì „ëŸ‰, ê±°ë˜ ê±´ìˆ˜, ìœ ì € ìˆ˜ ë“±ì„ ë¶„ì„í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_we_d_jelly_charge_smry`**: ì ¤ë¦¬ ì¶©ì „ì— ëŒ€í•œ í†µê³„ ë°ì´í„°ë¥¼ ìš”ì•½í•œ í…Œì´ë¸”. 
    - `we_mart.we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì ¤ë¦¬ ì¶©ì „ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ë‚ ì§œë³„, ì±„ë„ë³„, ê²°ì œ ìˆ˜ë‹¨ë³„ ì ¤ë¦¬ ì¶©ì „ëŸ‰, ê±°ë˜ ê±´ìˆ˜, ìœ ì € ìˆ˜ ë“±ì„ ìš”ì•½í•˜ì—¬ ë¶„ì„í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_we_m_jelly_jp_balance`**: ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ì˜ ì›”ë³„ ì”ì•¡ì„ ì§‘ê³„í•œ í…Œì´ë¸”. 
    - `we_mart.we_jelly_charge` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ì˜ ì›”ë³„ ì”ì•¡ì„ ë¶„ì„í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### Downstream View Tables
- **`charges`**: ì ¤ë¦¬ ì¶©ì „ ê±°ë˜ ë‚´ì—­ì„ ì„ì‹œ ë·°ë¡œ ìƒì„±. 
    - `jelly.transaction` í…Œì´ë¸”ê³¼ `jelly.point` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì ¤ë¦¬ ì¶©ì „ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ì ¤ë¦¬ ì¶©ì „ ì •ë³´ë¥¼ ì„ì‹œë¡œ ì¡°íšŒí•˜ê±°ë‚˜ ë‹¤ë¥¸ ì¿¼ë¦¬ì˜ ì¡°ì¸ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **`user_ctry`**: ìœ„ë²„ìŠ¤ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì„ì‹œ ë·°ë¡œ ìƒì„±. 
    - `we_mart.wv_user_ctry_history` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ìœ ì €ì˜ êµ­ê°€ ì •ë³´ë¥¼ ì„ì‹œë¡œ ì¡°íšŒí•˜ê±°ë‚˜ ë‹¤ë¥¸ ì¿¼ë¦¬ì˜ ì¡°ì¸ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **`jelly_jpy`**: ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ì˜ ì”ì•¡ì„ ê³„ì‚°í•œ ì„ì‹œ ë·°. 
    - `we_mart.we_jelly_charge` í…Œì´ë¸”ê³¼ `we_mart.wv_jelly_transaction` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ì˜ ì”ì•¡ì„ ê³„ì‚°í•˜ëŠ” ì¤‘ê°„ ê³¼ì •ì—ì„œ ì‚¬ìš©ëœë‹¤.
- **`temp_jelly`**: ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ì˜ ì›”ë³„ ì”ì•¡ì„ ì§‘ê³„í•œ ì„ì‹œ ë·°. 
    - `jelly_jpy` ë·°ì™€ `currency_table` ë·°ë¥¼ ì¡°ì¸í•˜ì—¬ ì¼ë³¸ì—ì„œ ì¶©ì „ëœ ì ¤ë¦¬ì˜ ì›”ë³„ ì”ì•¡ì„ ê³„ì‚°í•œë‹¤.
    - `stats_we_m_jelly_jp_balance` í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê¸° ì „ì— ì‚¬ìš©ëœë‹¤.
- **`currency_table`**: ë‹¤ì–‘í•œ í†µí™”ë“¤ì˜ ë³€í™˜ ë¹„ìœ¨ì„ ì„ì‹œ ë·°ë¡œ ìƒì„±. 
    - `we_meta.currency_rate_etc` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ í†µí™” ë³€í™˜ ë¹„ìœ¨ì„ ê°€ì ¸ì˜¨ë‹¤.
    - í†µí™” ë³€í™˜ ë¹„ìœ¨ì„ ì„ì‹œë¡œ ì¡°íšŒí•˜ê±°ë‚˜ ë‹¤ë¥¸ ì¿¼ë¦¬ì˜ ì¡°ì¸ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.  
---