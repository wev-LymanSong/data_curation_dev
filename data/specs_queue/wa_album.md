
we_mart.wa_album
================

# BASIC INFO

|**About**| ë‹´ë‹¹ì ìˆ˜ê¸° ì…ë ¥ í•„ìš” |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**| |
|**Created/ Last Updated At**|2022-09-22 / 2023-12-08|
|**Created By**|ì†¡ì¬ì˜|
|**Last Updated By**|ì†¡ì¬ì˜|
|**Collaborators**|ì†¡ì¬ì˜[27], êµ¬ë¯¼ì„œ[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2022-09-22|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/02e9ad45af599404e649537e1f8914c1e2254c44)|
|2022-09-22|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6c809dde6bd2429b13c7520bac3341833173e882)|
|2022-09-23|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/dbe506a5a3582841bef4617e62bc6b315fec8e51)|
|2022-10-13|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ef74e6897b19246059482b4fbbd0d95d1827ddd1)|
|2022-10-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/cce08f5b98549ccedef7177436532b9dd9e6c974)|
|2022-12-05|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f9eea5111b8f4a2f99f7d70d17eeb99a4c335428)|
|2022-12-09|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2022-12-26|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3b60f0af39bd86ed6bef9f657f0af88c2fc53b42)|
|2022-12-26|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/0091c5ca7047b646a9760c25ab991aab39174ff2)|
|2023-01-02|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/4db494a3de7087ee61192b9cf81da17cde57f8eb)|
|2023-01-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/14a51e34fb3141b2169a8fb3ef59af68d571dc67)|
|2023-01-20|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/b1a5f010e4b81103de2a0153af5101ce7f07639d)|
|2023-02-24|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3bf6674d3517fdd5692ea5132ad9c9fda1898700)|
|2023-03-24|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/593681943d76bfef4efda0ad08f782f73c20d9a4)|
|2023-04-04|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f2e2a9cc5d90f24deb1ee2a509880d2b401c0df3)|
|2023-04-11|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/8517c75fc00834196c45d66e8cc3dc8e8246bc28)|
|2023-04-20|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/44a4b1edd6d132fbab6defb6e581ba1ea2a249b8)|
|2023-04-26|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/874674bc1a3ab394f3f9fe59f77f9e0f50bc9022)|
|2023-04-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/9327ca508dd723524a5f738a7793fe65c8f881cc)|
|2023-04-30|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/a6bcdd5aeac475eef221152227b5d3d6ec19af54)|
|2023-06-14|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/92b762fd902d1332e0e9a2ca2f16c1c08de88eef)|
|2023-07-24|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ccd503a9ff46ddae0243f8162790b9b19269e09f)|
|2023-09-04|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/b1b3502ad1c1c2d2a28d52b873b2af4709842bd6)|
|2023-10-20|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/975913b8a01415390b1e81a94a723e01fe30a770)|
|2023-11-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/5dd9404c2d6a704e2e87a1f1e8b258d8d14f1a32)|
|2023-12-07|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/d290f42623ec72f10e5f64a14c4abc30d5f59064)|
|2023-12-08|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/600724bddae06714d5ef1bbd845af02590b67cc9)|
|2023-12-08|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/dfde24c37d13bbad2613f20c15a7b9905260897b)|
  
  
# TABLE NOTICE
  
### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: ìœ„ë²„ìŠ¤ ì•¨ë²” ë©”íƒ€ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ì œê³µ
* **ë°ì´í„° ë ˆë²¨**: AGGREGATED DATA(STATISTICS) 
* **íŒŒí‹°ì…˜ í‚¤**: ì—†ìŒ
* **ì£¼ìš” í‚¤**: `wa_album_id`

### í…Œì´ë¸” íŠ¹ì§•

* ìœ„ë²„ìŠ¤ ì•¨ë²”(WA) í…Œì´ë¸”ê³¼ ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²”(WS) í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ìœ„ë²„ìŠ¤ í”Œë«í¼ ë‚´ ì•¨ë²” ì •ë³´ë¥¼ ì¼ê´€ì„± ìˆê²Œ ì œê³µ
* ì•¨ë²” ì´ë¦„ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ì—¬ ê°€ì¥ ê´€ë ¨ì„± ë†’ì€ WS ì•¨ë²” ì •ë³´ë¥¼ ë§¤ì¹­
* ìœ„ë²„ìŠ¤ ì•¨ë²”(WA) í…Œì´ë¸”, ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²”(WS) í…Œì´ë¸”, ì¿ í° ì •ë³´ë¥¼ ì¡°ì¸í•˜ì—¬ ì•¨ë²”ê³¼ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ì •ë³´ ì œê³µ

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1. **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    * `wev_prod.album.album`: ìœ„ë²„ìŠ¤ ì•¨ë²” í…Œì´ë¸”
    * `wev_prod.album.artist`: ìœ„ë²„ìŠ¤ ì•„í‹°ìŠ¤íŠ¸ í…Œì´ë¸”
    * `we_meta.ws_album`: ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” í…Œì´ë¸”
    * `coupon.tb_cp_used`: ì¿ í° ì‚¬ìš© ì •ë³´ í…Œì´ë¸”
    * `coupon.tb_cp_plan`: ì¿ í° í”Œëœ ì •ë³´ í…Œì´ë¸”
2. **ë°ì´í„° ì „ì²˜ë¦¬**:
    * ìœ„ë²„ìŠ¤ ì•¨ë²” í…Œì´ë¸”ê³¼ ì•„í‹°ìŠ¤íŠ¸ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì•¨ë²” ì •ë³´ì— ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ ì¶”ê°€
    * ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” í…Œì´ë¸”ì—ì„œ ì•¨ë²” ID, ì´ë¦„, ë°œë§¤ì¼, íŒë§¤ ì •ë³´ ì¶”ì¶œ
    * ì¿ í° ì •ë³´ë¥¼ ì•¨ë²” ID ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í•‘í•˜ì—¬ ì•¨ë²”ë³„ ì¿ í° í”Œëœ ID ë¦¬ìŠ¤íŠ¸ ìƒì„±
3. **ë°ì´í„° í†µí•©**:
    * ìœ„ë²„ìŠ¤ ì•¨ë²” ì •ë³´ì™€ ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” ì •ë³´ë¥¼ `we_art_id` ê¸°ì¤€ìœ¼ë¡œ ì¡°ì¸
    * ì•¨ë²” ì´ë¦„ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ì—¬ ê°€ì¥ ê´€ë ¨ì„± ë†’ì€ ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” ì •ë³´ë¥¼ ë§¤ì¹­
    * ì¿ í° í”Œëœ ì •ë³´ë¥¼ ì•¨ë²” ID ê¸°ì¤€ìœ¼ë¡œ ì¡°ì¸í•˜ì—¬ ì•¨ë²”ë³„ ì¿ í° í”Œëœ ì •ë³´ ì¶”ê°€
4. **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    * ìœ„ë²„ìŠ¤ ì•¨ë²” í…Œì´ë¸”, ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” í…Œì´ë¸”, ì¿ í° ì •ë³´ë¥¼ í†µí•©í•˜ì—¬ `we_mart.wa_album` í…Œì´ë¸” ìƒì„±

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    * ìœ„ë²„ìŠ¤ ì•¨ë²” ì •ë³´ì™€ ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” ì •ë³´ë¥¼ í†µí•©í•˜ì—¬ ë¶„ì„
    * ìœ„ë²„ìŠ¤ ì•¨ë²”ê³¼ ê´€ë ¨ëœ ì¿ í° ì •ë³´ í™•ì¸
    * ì•¨ë²” íŒë§¤ ì •ë³´ ë° ì¿ í° ì •ë³´ ë¶„ì„ì„ í†µí•œ ë§ˆì¼€íŒ… ì „ëµ ìˆ˜ë¦½
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    * `we_art_id` ì»¬ëŸ¼ì€ ìœ„ë²„ìŠ¤ í”Œë«í¼ ë‚´ í†µí•© ì•„í‹°ìŠ¤íŠ¸ IDì´ë¯€ë¡œ, ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸í•  ë•Œ ìœ ì˜
    * `wa_album_id`ëŠ” ìœ„ë²„ìŠ¤ ì•¨ë²” í…Œì´ë¸”ì˜ ê³ ìœ  IDì´ê³ , `album_id`ëŠ” ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” í…Œì´ë¸”ì˜ ê³ ìœ  IDì´ë¯€ë¡œ, ë‘ IDë¥¼ ì´ìš©í•˜ì—¬ ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì—°ê´€í•˜ì—¬ ë¶„ì„ ê°€ëŠ¥

### ì¶”ê°€ ì •ë³´

* `wa_album_id`ì™€ `album_id` ì»¬ëŸ¼ì€ ê°ê° ìœ„ë²„ìŠ¤ ì•¨ë²”ê³¼ ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²”ì˜ ê³ ìœ  IDë¥¼ ë‚˜íƒ€ë‚´ë©°, ë‘ ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ ë‘ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì—°ê´€í•˜ì—¬ ë¶„ì„ ê°€ëŠ¥
* `sale_ids` ì»¬ëŸ¼ì€ ì•¨ë²”ê³¼ ê´€ë ¨ëœ ëª¨ë“  íŒë§¤ ì •ë³´ë¥¼ ë‹´ê³  ìˆìœ¼ë©°, `weverse_album_sale_ids`ì™€ `physical_album_sale_ids` ì»¬ëŸ¼ì€ ê°ê° ìœ„ë²„ìŠ¤ ì•¨ë²”ê³¼ ì‹¤ë¬¼ ì•¨ë²” íŒë§¤ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ
* `cp_plan_ids` ì»¬ëŸ¼ì€ ì•¨ë²”ê³¼ ê´€ë ¨ëœ ì¿ í° í”Œëœ IDë¥¼ ë‹´ê³  ìˆìœ¼ë©°, í•´ë‹¹ IDë¥¼ ì´ìš©í•˜ì—¬ `coupon.tb_cp_plan` í…Œì´ë¸”ì—ì„œ ì¿ í° í”Œëœ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŒ  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|wa_album_id|int|ìœ„ë²„ìŠ¤ ì•¨ë²” ID|
|1|wa_album_name|string|ìœ„ë²„ìŠ¤ ì•¨ë²” ëª…|
|2|we_art_id|int|ìœ„ë²„ìŠ¤ í”Œë«í¼ ë‚´ í†µí•© ì•„í‹°ìŠ¤íŠ¸ ID|
|3|we_art_name|string|ìœ„ë²„ìŠ¤ í”Œë«í¼ ë‚´ í†µí•© ì•„í‹°ìŠ¤íŠ¸ ëª…|
|4|entity_we_art_id|bigint|wecode ì— ë”°ë¥¸ ê°ì²´ ì•„í‹°ìŠ¤íŠ¸ ID(ì†”ë¡œ/ê·¸ë£¹/ìœ ë‹› ë¶„ë¦¬)|
|5|wa_artist_id|bigint|ìœ„ë²„ìŠ¤ ì•¨ë²” ì•„í‹°ìŠ¤íŠ¸ ID|
|6|wa_art_name|string|ìœ„ë²„ìŠ¤ ì•¨ë²” ì•„í‹°ìŠ¤íŠ¸ ëª…|
|7|wa_release_date|date|ìœ„ë²„ìŠ¤ ì•¨ë²” ì¶œì‹œ ì¼|
|8|album_id|int|ì•¨ë²” ID(WS ì•¨ë²” ë©”íƒ€)|
|9|album_name|string|ì•¨ë²” ëª… (WS ì•¨ë²” ë©”íƒ€)|
|10|album_release_date|date|ì•¨ë²” ë°œë§¤ì¼ (WS ì•¨ë²” ë©”íƒ€)|
|11|cp_plan_ids|array<bigint>|ì¿ í° cp_plan_id ë¦¬ìŠ¤íŠ¸|
|12|sale_ids|array<bigint>|ì•¨ë²”ê³¼ ê´€ë ¨ëœ ëª¨ë“  sale_id ë¦¬ìŠ¤íŠ¸|
|13|weverse_album_sale_ids|array<bigint>|ìœ„ë²„ìŠ¤ ì•¨ë²” sale_id ë¦¬ìŠ¤íŠ¸|
|14|physical_album_sale_ids|array<bigint>|ì‹¤ë¬¼ ì•¨ë²” sale_id ë¦¬ìŠ¤íŠ¸|
  
    
---
# HOW TO USE
  
`
### Downstream Table/View
- `we_mart.wa_album` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ„ë²„ìŠ¤ ì•¨ë²” íŒë§¤ í˜„í™©ì„ ì¼ë³„ë¡œ ì§‘ê³„í•˜ëŠ” `stats_wa_d_album_sale` í…Œì´ë¸”ì„ ìƒì„±
    - ```sql
      select 
        date(a.part_date) as key_date
      , a.wa_album_id
      , a.wa_album_name
      , a.we_art_id
      , a.we_art_name
      , count(distinct b.we_member_id) as uu_pur_cnt
      , sum(b.ord_item_qty) as pur_cnt
      , sum(b.ord_item_amt_krw) as amt_krw
      from we_mart.wa_album as a
      left join we_mart.ws_album_sale as b
      on a.wa_album_id = b.wa_album_id
      group by 1, 2, 3, 4, 5
      order by 1, 2, 3, 4, 5
      ```
- `we_mart.wa_album` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ„ë²„ìŠ¤ ì•¨ë²” ë³„ êµ¬ë§¤ ìœ ì €ìˆ˜ë¥¼ ì§‘ê³„í•˜ëŠ” `wi_view.wa_album_user_cnt` ë·°ë¥¼ ìƒì„±
    - ```sql
      select 
        a.wa_album_id
      , a.wa_album_name
      , count(distinct b.we_member_id) as uu_pur_cnt
      from we_mart.wa_album as a
      left join we_mart.ws_album_sale as b
      on a.wa_album_id = b.wa_album_id
      group by 1, 2
      order by 1, 2
      ```

### Data Extraction
- `we_mart.wa_album` í…Œì´ë¸”ì—ì„œ ì•„í‹°ìŠ¤íŠ¸ IDê°€ "ARTIST"ì¸ ì•¨ë²”ë“¤ì˜ ì •ë³´ë¥¼ ì¶”ì¶œ
    - ```sql
      select 
        wa_album_id
      , wa_album_name
      , we_art_id
      , we_art_name
      from we_mart.wa_album
      where we_art_id = "ARTIST"
      order by wa_album_id
      ```
- `we_mart.wa_album` í…Œì´ë¸”ì—ì„œ "2024-01-01" ì´í›„ì— ë°œë§¤ëœ ì•¨ë²”ë“¤ì˜ ì •ë³´ë¥¼ ì¶”ì¶œ
    - ```sql
      select 
        wa_album_id
      , wa_album_name
      , we_art_id
      , we_art_name
      , wa_release_date
      from we_mart.wa_album
      where wa_release_date >= "2024-01-01"
      order by wa_album_id
      ```
- `we_mart.wa_album` í…Œì´ë¸”ì—ì„œ ìœ„ë²„ìŠ¤ ì•¨ë²” IDê°€ "1234"ì¸ ì•¨ë²”ì˜ ì¿ í° ì •ë³´ë¥¼ ì¶”ì¶œ
    - ```sql
      select 
        wa_album_id
      , wa_album_name
      , cp_plan_ids
      from we_mart.wa_album
      where wa_album_id = "1234"
      ```
- `we_mart.wa_album` í…Œì´ë¸”ì—ì„œ ìœ„ë²„ìŠ¤ ì•¨ë²” IDê°€ "1234"ì¸ ì•¨ë²”ì˜ ìœ„ë²„ìŠ¤ ì•¨ë²”ê³¼ ê´€ë ¨ëœ ëª¨ë“  sale_id ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œ
    - ```sql
      select 
        wa_album_id
      , weverse_album_sale_ids
      from we_mart.wa_album
      where wa_album_id = "1234"
      ```
- `we_mart.wa_album` í…Œì´ë¸”ì—ì„œ ìœ„ë²„ìŠ¤ ì•¨ë²” IDê°€ "1234"ì¸ ì•¨ë²”ì˜ ì‹¤ë¬¼ ì•¨ë²”ê³¼ ê´€ë ¨ëœ sale_id ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œ
    - ```sql
      select 
        wa_album_id
      , physical_album_sale_ids
      from we_mart.wa_album
      where wa_album_id = "1234"
      ```  
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_ws_mart_daily`

### Update Interval: DAILY

### Update Type: OVERWRITE

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/wa_album.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_ws_mart_daily.py)
  
    
---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|album.album|we_mart.stats_wa_d_album_reg_smry|
|album.artist|we_mart.stats_ws_d_album_cumul|
|album.user_album_reg|we_mart.wa_sess_daily|
|coupon.tb_cp_plan|we_mart.wa_user_album_reg|
|coupon.tb_cp_used|we_mart.ws_album_sale|
|we_mart.we_artist| |
|wecode.tb_entity| |
|wecode.tb_entity_meta| |

## ğŸ¤ Downstream Tables Info
  
### Downstream Tables
- **`we_mart.ws_album_sale`**: ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” ìƒí’ˆ íŒë§¤ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ë§ˆíŠ¸ í…Œì´ë¸”
    - `we_mart.wa_album` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ìœ„ë²„ìŠ¤ ì•¨ë²” ID (`wa_album_id`)ì™€ ê´€ë ¨ ì •ë³´ë¥¼ ì¶”ê°€
    - ìœ„ë²„ìŠ¤ ì•¨ë²” íŒë§¤ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ë ¤ë©´ ì´ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ë©´ ë¨. ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ë‚ ì§œì— íŒë§¤ëœ ìœ„ë²„ìŠ¤ ì•¨ë²” IDì™€ íŒë§¤ëŸ‰ì„ ì•Œì•„ë³´ë ¤ë©´ ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë¨.

    ```sql
    select wa_album_id, sum(ord_item_qty * album_qty) as total_album_qty
    from we_mart.ws_album_sale
    where part_date = '2023-12-25'
    group by wa_album_id
    ```

- **`we_mart.wa_user_album_reg`**: ìœ„ë²„ìŠ¤ ì•¨ë²” ë“±ë¡ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ë§ˆíŠ¸ í…Œì´ë¸”
    - `we_mart.wa_album` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ìœ„ë²„ìŠ¤ ì•¨ë²” ID(`wa_album_id`)ì™€ ê´€ë ¨ ì •ë³´ë¥¼ ì¶”ê°€
    - íŠ¹ì • ë‚ ì§œì— ë“±ë¡ëœ ìœ„ë²„ìŠ¤ ì•¨ë²” ì •ë³´ë¥¼ ì•Œì•„ë³´ë ¤ë©´ ì´ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ë©´ ë¨. ì˜ˆë¥¼ ë“¤ì–´, 2023ë…„ 12ì›” 25ì¼ì— ë“±ë¡ëœ ëª¨ë“  ìœ„ë²„ìŠ¤ ì•¨ë²” ì •ë³´ë¥¼ ì¶”ì¶œí•˜ë ¤ë©´ ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë¨.

    ```sql
    select wa_album_id, wa_album_name, we_art_id, we_art_name
    from we_mart.wa_user_album_reg
    where part_date = '2023-12-25'
    ```

### Downstream View Tables
- **`we_mart.view_ws_album_latest`**: `we_meta.ws_album` í…Œì´ë¸”ì˜ ê°€ì¥ ìµœê·¼ íŒŒí‹°ì…˜ ë‚ ì§œ ë°ì´í„°ë§Œ ë³´ì—¬ì£¼ëŠ” ë·° í…Œì´ë¸”
    - `we_mart.wa_album` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ.
    - ê°€ì¥ ìµœê·¼ì— ì—…ë°ì´íŠ¸ëœ ìœ„ë²„ìŠ¤ìƒµ ì•¨ë²” ì •ë³´ë¥¼ ê°„í¸í•˜ê²Œ í™•ì¸í•  ë•Œ ì‚¬ìš©
    - ë‹¤ìŒ ì¿¼ë¦¬ëŠ” í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ ê°€ì¥ ìµœê·¼ì— ì—…ë°ì´íŠ¸ëœ ì•¨ë²” ì •ë³´ë¥¼ ê°€ì ¸ì˜´.

    ```sql
    select album_id, album_name, we_art_id, we_art_name
    from we_mart.view_ws_album_latest
    ```

- **`we_mart.view_wa_album_latest`**: `we_mart.wa_album` í…Œì´ë¸”ì˜ ê°€ì¥ ìµœê·¼ íŒŒí‹°ì…˜ ë‚ ì§œ ë°ì´í„°ë§Œ ë³´ì—¬ì£¼ëŠ” ë·° í…Œì´ë¸”
    - `we_mart.wa_album` í…Œì´ë¸”ì˜ `part_date` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ ì‚¬ìš©
    - ê°€ì¥ ìµœê·¼ì— ì—…ë°ì´íŠ¸ëœ ìœ„ë²„ìŠ¤ ì•¨ë²” ì •ë³´ë¥¼ ê°„í¸í•˜ê²Œ í™•ì¸í•  ë•Œ ì‚¬ìš©
    - ë‹¤ìŒ ì¿¼ë¦¬ëŠ” í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ ê°€ì¥ ìµœê·¼ì— ì—…ë°ì´íŠ¸ëœ ì•¨ë²” ì •ë³´ë¥¼ ê°€ì ¸ì˜´.

    ```sql
    select wa_album_id, wa_album_name, we_art_id, we_art_name
    from we_mart.view_wa_album_latest
    ```

- **`we_mart.view_wa_album_sales_detail`**: `we_mart.wa_album` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ìœ„ë²„ìŠ¤ ì•¨ë²” ID, ì•¨ë²” ì´ë¦„, ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ì™€ í•¨ê»˜ í•´ë‹¹ ì•¨ë²”ì˜ ìƒì„¸ íŒë§¤ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ë·° í…Œì´ë¸”
    - `we_mart.wa_album` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ìœ„ë²„ìŠ¤ ì•¨ë²” ID(`wa_album_id`)ì™€ ê´€ë ¨ ì •ë³´ë¥¼ ì¶”ê°€
    - `we_mart.ws_album_sale` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì•¨ë²” íŒë§¤ ê´€ë ¨ ìƒì„¸ ì •ë³´ë¥¼ ì¶”ê°€
    - íŠ¹ì • ìœ„ë²„ìŠ¤ ì•¨ë²”ì˜ íŒë§¤ ì •ë³´ë¥¼ ìì„¸íˆ ì•Œì•„ë³´ë ¤ë©´ ì´ ë·° í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ë©´ ë¨. ì˜ˆë¥¼ ë“¤ì–´, ìœ„ë²„ìŠ¤ ì•¨ë²” IDê°€ 100ì¸ ì•¨ë²”ì˜ íŒë§¤ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ë ¤ë©´ ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë¨.

    ```sql
    select 
        WA.wa_album_id, WA.wa_album_name, WA.we_art_id, WA.we_art_name,
        WS.shop, WS.ctry_code, WS.album_qty_type, WS.album_option_type,
        sum(WS.ord_item_qty * WS.album_qty) as total_album_qty,
        sum(WS.ord_item_amt_krw) as total_album_amt_krw
    from we_mart.wa_album as WA
    join we_mart.ws_album_sale as WS
        on WA.wa_album_id = WS.wa_album_id
    where WA.wa_album_id = 100
    group by 1, 2, 3, 4, 5, 6, 7, 8
    ```  
---