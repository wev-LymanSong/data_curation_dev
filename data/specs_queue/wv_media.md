
we_mart.wv_media
================

# BASIC INFO

|**About**| ë‹´ë‹¹ì ìˆ˜ê¸° ì…ë ¥ í•„ìš” |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**|`part_date`|
|**Created/ Last Updated At**|2021-11-29 / 2024-07-30|
|**Created By**|ë°•ìƒë¯¼|
|**Last Updated By**|ì„í˜œê²½|
|**Collaborators**|ì†¡ì¬ì˜[23], ë°•ìƒë¯¼[5], ì„í˜œê²½[4], ìœ¤ìƒí˜[2], êµ¬ë¯¼ì„œ[1], ì´í˜„ì§€[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2022-01-04|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/0cd91c5bd47eda12b5a4beb4580155f0aaf8df99)|
|2022-01-04|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/657cc3e614739b94d28d3a2f8feb168b93640277)|
|2022-01-04|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/28815d69a6d10da118e7ffe350ad3d0fcd58d77a)|
|2022-01-12|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/24547537bfeecc9b9f0ffd90288ccf6080570e64)|
|2022-02-14|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/ba7bcd1e0cc1a3084d8afe06c3fdd4e104bae6c8)|
|2022-02-17|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/504d9fa4c8ff74728889eb27257d983d1fac7473)|
|2022-02-18|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/26cfb9533725a5a62b87f1c50637a575d3a22581)|
|2022-03-15|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/237ea14b8765d183d92366858f95b0f3e94b7a32)|
|2022-03-15|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/0fe5b04368dc57ee658b11ea7efa5a21dc2ed007)|
|2022-03-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/e28da897a7205713da976395612cc0716d72e490)|
|2022-03-17|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/39fee16ecfa66b94a860e633a6bf63ff07920977)|
|2022-04-01|ìœ¤ìƒí˜|[PR](https://github.com/benxcorp/databricks/commit/eab10f64b0055f57e61daa97d3218295df39086e)|
|2022-04-29|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/fbcedfbe32888a06943a358ac122d0f3107dd77d)|
|2022-04-29|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/66a8dbf1a06a09bfd2b5e277e934f02f478cab2a)|
|2022-04-29|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/01e875d33d5d04826c6a7045add371c092bcd962)|
|2022-06-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/4de5d0a511e4aea4096e4e68957053d954f979fb)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/5387e83c317abdd49bae9292dcaba8d2bb678171)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/efd64885f4879826fa359f0d482817c41e8d124f)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/c9c8d3c345863d76a112bc3f54d6b8ff85e8ce99)|
|2022-07-18|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/6431d379d2f752681926c82ca894169fcba52e82)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/b7f11df2a981ba8bece5a2ac2f223cd227d08cef)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/f7ea8558cfd57f5241ae6cde9d4c60014b118ff6)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/0b8ead7f2320859a7d13ea94dcd7b4d38aab49cf)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/4c35e9619158a93b94f1eb92d33eb0b206f52c3d)|
|2022-07-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/453136d08d4c8f8516795dfe40e6cbe26e77ff5e)|
|2022-07-25|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/4ae0ed46ac42092c78fd95fb2a156f779f835587)|
|2022-07-25|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/3910dc828c7cc0ad562b492625fd96054725176e)|
|2022-07-29|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/842acd4f631ce140facb374d0e6581c3758d72e6)|
|2022-08-12|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/53da1121b4fdc73055c588d254af5cbf4fb47ba0)|
|2022-08-12|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/2f71f9da7bb26cdf0da240c816baac4f036f8a17)|
|2022-12-09|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2024-01-02|ì„í˜œê²½|[PR](https://github.com/benxcorp/databricks/commit/25ce09cb5ec8e3ee280edc265775b0321b5270fd)|
|2024-04-19|ì„í˜œê²½|[PR](https://github.com/benxcorp/databricks/commit/271d69a35739fa0a84c9a65293cff3f935bff871)|
|2024-07-03|ì„í˜œê²½|[PR](https://github.com/benxcorp/databricks/commit/075428504a65f49ab92bb5d5d49e004a7375cd99)|
|2024-07-30|ì„í˜œê²½|[PR](https://github.com/benxcorp/databricks/commit/b8d8ef804751387e3681d01dbf2fe3926a89038a)|
  
  
# TABLE NOTICE
  
### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: Weverse í”Œë«í¼ ë‚´ ë¯¸ë””ì–´ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” í…Œì´ë¸”. í¬ìŠ¤íŠ¸, ë¹„ë””ì˜¤, ì‚¬ì§„, ìœ íŠœë¸Œ ì •ë³´ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ì œê³µ
* **ë°ì´í„° ë ˆë²¨**: AGGREGATED DATA(STATISTICS)
* **íŒŒí‹°ì…˜ í‚¤**: `part_date`
* **ì£¼ìš” í‚¤**: `post_id`, `media_id`

### í…Œì´ë¸” íŠ¹ì§•

* Weverse í”Œë«í¼ ë‚´ ëª¨ë“  ë¯¸ë””ì–´ ìœ í˜•ì— ëŒ€í•œ í†µí•© ì •ë³´ ì œê³µ
* `media_id` ì»¬ëŸ¼ì„ í†µí•´ `weverse2.community_common_wev_id` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `media_category_ids` ì»¬ëŸ¼ì€ ë¯¸ë””ì–´ ì¹´í…Œê³ ë¦¬ ì •ë³´ë¥¼ array í˜•íƒœë¡œ ì €ì¥í•˜ë©°, íŠ¹íˆ `is_fc_only` ê°’ì´ 1ì´ê³  `section_type`ì´ `MEDIA`ì¸ ê²½ìš° -8888 IDë¥¼ ì¶”ê°€í•˜ì—¬ `we_mart.wv_media_cat` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `is_fc_only`, `is_photo`, `is_pitem`, `is_joint_live` ì»¬ëŸ¼ì€ boolean ê°’ìœ¼ë¡œ ê°ê° íŒ¬í´ëŸ½ ì „ìš© ì—¬ë¶€, ì‚¬ì§„ ì—¬ë¶€, ìœ ë£Œ êµ¬ë§¤ ì•„ì´í…œ ì—¬ë¶€, í•©ë™ ë¼ì´ë¸Œ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ëƒ„
* `video_id` ì»¬ëŸ¼ì„ í†µí•´ `weverse2.video_video` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `video_id` ì»¬ëŸ¼ì„ í†µí•´ `weverse2.video_vod` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `video_id` ì»¬ëŸ¼ì„ í†µí•´ `weverse2.video_vod_audit` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `community_id` ì»¬ëŸ¼ì„ í†µí•´ `we_mart.we_artist` í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
* `photo_ids` ì»¬ëŸ¼ì€ ì‚¬ì§„ IDë¥¼ array í˜•íƒœë¡œ ì €ì¥í•˜ë©°, `cnt_photo` ì»¬ëŸ¼ì€ ì‚¬ì§„ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1. **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    * `weverse2.community_content_post` í…Œì´ë¸”: í¬ìŠ¤íŠ¸ ê¸°ë³¸ ì •ë³´ ì¶”ì¶œ
    * `weverse2.community_content_post_photo_relation` í…Œì´ë¸”: í¬ìŠ¤íŠ¸ì™€ ì‚¬ì§„ ê°„ì˜ ê´€ê³„ ì •ë³´ ì¶”ì¶œ
    * `weverse2.community_content_photo` í…Œì´ë¸”: ì‚¬ì§„ ì •ë³´ ì¶”ì¶œ
    * `weverse2.community_common_wev_id` í…Œì´ë¸”: `media_id` ì¶”ì¶œ
    * `weverse2.community_content_common_post_video_relation` í…Œì´ë¸”: í¬ìŠ¤íŠ¸ì™€ ë¹„ë””ì˜¤ ê°„ì˜ ê´€ê³„ ì •ë³´ ì¶”ì¶œ
    * `weverse2.video_video` í…Œì´ë¸”: ë¹„ë””ì˜¤ ì •ë³´ ì¶”ì¶œ
    * `weverse2.video_vod` í…Œì´ë¸”: VOD ì •ë³´ ì¶”ì¶œ
    * `weverse2.video_vod_audit` í…Œì´ë¸”: ë¹„ë””ì˜¤ ë“±ê¸‰ ì •ë³´ ì¶”ì¶œ
    * `we_mart.we_artist` í…Œì´ë¸”: ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ ì¶”ì¶œ
2. **ë°ì´í„° ì „ì²˜ë¦¬**:
    * `weverse2.community_content_post` í…Œì´ë¸”ì—ì„œ `data` ì»¬ëŸ¼ì˜ JSON ë°ì´í„°ë¥¼ íŒŒì‹±í•˜ì—¬ í•„ìš”í•œ ì •ë³´ ì¶”ì¶œ
    * `published_at`, `created_at`, `updated_at` ì»¬ëŸ¼ì„ Unix timestampì—ì„œ KSTë¡œ ë³€í™˜
    * `product_ids` ì»¬ëŸ¼ì€ JSON ë°ì´í„°ì—ì„œ ì¶”ì¶œ í›„ ì¤‘ë³µ ì œê±°
    * `media_category_ids`, `media_group_ids` ì»¬ëŸ¼ì€ JSON ë°ì´í„°ì—ì„œ ì¶”ì¶œ í›„ ì¤‘ë³µ ì œê±° ë° int í˜•ì‹ìœ¼ë¡œ ë³€í™˜
3. **ë°ì´í„° í†µí•©**:
    * ì—¬ëŸ¬ ì†ŒìŠ¤ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ ìƒì„±
4. **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    * ë°ì´í„°í”„ë ˆì„ì„ `we_mart.wv_media` í…Œì´ë¸”ì— ì €ì¥

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    * Weverse í”Œë«í¼ ë‚´ ë¯¸ë””ì–´ í˜„í™© ë¶„ì„
    * ë¯¸ë””ì–´ ìœ í˜•ë³„, ì•„í‹°ìŠ¤íŠ¸ë³„, êµ­ê°€ë³„ ë¯¸ë””ì–´ í†µê³„ ë¶„ì„
    * íŒ¬í´ëŸ½ ì „ìš© ì½˜í…ì¸  ë¶„ì„
    * ìœ ë£Œ ë¯¸ë””ì–´ ì½˜í…ì¸  ë¶„ì„
    * ë¹„ë””ì˜¤ ì¬ìƒ ìˆ˜, ëŒ“ê¸€ ìˆ˜, ì‘ì› ìˆ˜ ë“± ë°˜ì‘ ë¶„ì„
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    * `media_id` ì»¬ëŸ¼ì„ í†µí•´ `weverse2.community_common_wev_id` í…Œì´ë¸”ê³¼ ì¡°ì¸ ì‹œ, `wev1` ì»¬ëŸ¼ì´ `MEDIA`ë¡œ ì‹œì‘í•˜ëŠ” ë°ì´í„°ë§Œ ì‚¬ìš©í•´ì•¼ í•¨
    * `media_category_ids` ì»¬ëŸ¼ì€ `we_mart.wv_media_cat` í…Œì´ë¸”ê³¼ ì¡°ì¸ ì‹œ, `is_fc_only` ê°’ì´ 1ì´ê³  `section_type`ì´ `MEDIA`ì¸ ê²½ìš° -8888 IDë¥¼ ì¶”ê°€í•˜ì—¬ ì¡°ì¸í•´ì•¼ í•¨
    * `video_id` ì»¬ëŸ¼ì„ í†µí•´ `weverse2.video_vod_audit` í…Œì´ë¸”ê³¼ ì¡°ì¸ ì‹œ, `process_status`ê°€ `COMPLETE`ì¸ ë°ì´í„°ë§Œ ì‚¬ìš©í•´ì•¼ í•¨
    * `community_id` ì»¬ëŸ¼ì„ í†µí•´ `we_mart.we_artist` í…Œì´ë¸”ê³¼ ì¡°ì¸ ì‹œ, ì•„í‹°ìŠ¤íŠ¸ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ
    * `photo_ids` ì»¬ëŸ¼ì€ `weverse2.community_content_photo` í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ì‚¬ì§„ ìƒì„¸ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ

### ì¶”ê°€ ì •ë³´

* `media_type` ì»¬ëŸ¼ì€ `IMAGE`, `VIDEO`, `YOUTUBE`, `LIVE` ë“±ì˜ ê°’ì„ ê°€ì§
* `section_type` ì»¬ëŸ¼ì€ `MEDIA`, `NEWS`, `NOTICE`, `POLL`, `QNA`, `EVENT`, `SCHEDULE` ë“±ì˜ ê°’ì„ ê°€ì§
* `is_live_to_vod` ì»¬ëŸ¼ì€ ë¼ì´ë¸Œ ë°©ì†¡ì´ VODë¡œ ë³€í™˜ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ëƒ„
* `live_to_vod_status` ì»¬ëŸ¼ì€ ë¼ì´ë¸Œ ë°©ì†¡ì´ VODë¡œ ë³€í™˜ëœ ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ„
* `rate_status` ì»¬ëŸ¼ì€ ë¹„ë””ì˜¤ ë“±ê¸‰ ì •ë³´ë¥¼ ë‚˜íƒ€ëƒ„
* `part_date` ì»¬ëŸ¼ì€ ë°ì´í„° ìƒì„± ì¼ìë¥¼ ë‚˜íƒ€ëƒ„  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|post_id|string|í¬ìŠ¤íŠ¸ ê³ ìœ  ID|
|1|media_id|int|wv1ì—ì„œì˜ ë¯¸ë””ì–´ ID|
|2|section_type|string|í¬ìŠ¤íŠ¸ ì„¹ì…˜ ìœ í˜•|
|3|media_type|string|ë¯¸ë””ì–´ ìœ í˜•|
|4|media_name|string|ë¯¸ë””ì–´ ëª…|
|5|comm_id|int|ì»¤ë®¤ë‹ˆí‹° ëª…|
|6|we_art_id|int|we_art_id|
|7|we_art_name|string|we_art_name|
|8|is_fc_only|int|ë©¤ë²„ì‹­ ì „ìš© ì—¬ë¶€|
|9|is_photo|int|ì‚¬ì§„ ì—¬ë¶€|
|10|is_pitem|int|ìœ ë£Œ êµ¬ë§¤ ì•„ì´í…œ ì—¬ë¶€|
|11|is_joint_live|int|í•©ë™ë¼ì´ë¸Œ ì—¬ë¶€|
|12|media_cat_ids|array<int>|ë¯¸ë””ì–´ ì¹´í…Œê³ ë¦¬ ì•„ì´ë””ë“¤|
|13|media_group_ids|array<int>|ë¯¸ë””ì–´ ê·¸ë£¹ ì•„ì´ë””ë“¤|
|14|video_id|bigint|ë¹„ë””ì–´ ê³ ìœ  ID|
|15|infra_video_id|string|ë„¤ì´ë²„ ë™ì˜ìƒ í”Œë«í¼ ë‚´ ID|
|16|video_type|string|ë¹„ë””ì–´ íƒ€ì…|
|17|preview_type|string|í”„ë¦¬ë·° ì—¬ë¶€|
|18|video_expose_status|string|ë¹„ë””ì˜¤ ê³µê°œ ìƒíƒœ|
|19|screen_orientation|string|ê¸°ë³¸ ë·° ëª¨ì–‘|
|20|live_to_vod_status|string|ë¼ì´ë¸Œ => VOD ë³€ê²½ ìƒíƒœ|
|21|video_cre_dt|timestamp|ë¹„ë””ì–´ ìƒì„±ì¼|
|22|media_dur|int|ë¯¸ë””ì–´ ì´ ì‹œê°„|
|23|preview_start|int|ë¯¸ë¦¬ë³´ê¸° ì‹œì‘ ì§€ì |
|24|preview_end|int|ë¯¸ë¦¬ë³´ê¸° ì¢…ë£Œ ì§€ì |
|25|thumbnail_url|string|ì¸ë„¤ì¼ URL|
|26|youtube_path|string|ìœ íŠœë¸Œ URL|
|27|youtube_videoid|string|ìœ íŠœë¸Œ video id|
|28|rate_status|string|ì˜ìƒë“±ê¸‰|
|29|photo_ids|array<bigint>|í¬í•¨ëœ ì‚¬ì§„(photo) ì•„ì´ë”” ì–´ë ˆì´|
|30|cnt_photo|int|ì‚¬ì§„ ê°œìˆ˜|
|31|play_count|bigint|ì¬ìƒ ìˆ˜|
|32|comment_count|int|ëŒ“ê¸€ ìˆ˜|
|33|emotion_count|int|ì‘ì› ìˆ˜|
|34|media_cre_dt|timestamp|ë¯¸ë””ì–´ ìƒì„± ì¼ì‹œ|
|35|media_upd_dt|timestamp|ë¯¸ë””ì–´ ìˆ˜ì • ì¼ì‹œ|
|36|media_rel_dt|timestamp|ë¯¸ë””ì–´ ë…¸ì¶œ ì¼ì‹œ|
|37|part_date|string|íŒŒí‹°ì…˜ ì¼ì|
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ë¯¸ë””ì–´ ì •ë³´ë¥¼ ë‹´ì€ ë·°ë¥¼ ìƒì„±
    - ```sql
      create or replace temp view artist_media as
      select *
      from wev_prod.we_mart.wv_media
      where we_art_id = ARTIST
      and part_date = '2024-01-01'
      ```
- `wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œì˜ ëª¨ë“  ë¯¸ë””ì–´ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”ì„ ìƒì„±, íŒŒí‹°ì…˜ í‚¤ë¡œ part_date ì‚¬ìš©
    - ```sql
      create or replace table wev_prod.we_mart.daily_media as
      select *
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      ```
- `wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ìœ ë£Œ ë¯¸ë””ì–´ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”ì„ ìƒì„±, íŒŒí‹°ì…˜ í‚¤ë¡œ part_date ì‚¬ìš©, `we_meta.we_media_product` í…Œì´ë¸”ê³¼ ì¡°ì¸
    - ```sql
      create or replace table wev_prod.we_mart.artist_paid_media as
      select distinct WM.post_id, WM.media_id, WM.media_name, WM.media_type, WM.media_cat_ids, WM.is_pitem, WM.we_art_id, WM.we_art_name, WM.media_rel_dt, WM.part_date
      from wev_prod.we_mart.wv_media WM
      inner join wev_prod.we_meta.we_media_product WMP
      on WM.post_id = WMP.product_id
      where WM.we_art_id = ARTIST
      and WM.part_date = '2024-01-01'
      ```
- `wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œì˜ ëª¨ë“  ë¯¸ë””ì–´ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”ì„ ìƒì„±, íŒŒí‹°ì…˜ í‚¤ë¡œ part_date ì‚¬ìš©, `we_mart.wv_cat` í…Œì´ë¸”ê³¼ ì¡°ì¸
    - ```sql
      create or replace table wev_prod.we_mart.daily_media_with_category as
      select WM.*, WC.cat_id, WC.cat_name
      from wev_prod.we_mart.wv_media WM
      left join wev_prod.we_mart.wv_cat WC
      on array_contains(WM.media_cat_ids, WC.cat_id)
      where WM.part_date = '2024-01-01'
      ```

### Data Extraction
- íŠ¹ì • ë‚ ì§œì˜ ëª¨ë“  ë¯¸ë””ì–´ íƒ€ì… ì¡°íšŒ
    - ```sql
      select distinct media_type
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      ```
- íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ëª¨ë“  ë¯¸ë””ì–´ ì •ë³´ ì¡°íšŒ
    - ```sql
      select *
      from wev_prod.we_mart.wv_media
      where we_art_id = ARTIST
      and part_date = '2024-01-01'
      ```
- íŠ¹ì • ë‚ ì§œì— ì—…ë¡œë“œëœ ëª¨ë“  ë¯¸ë””ì–´ ì •ë³´ ì¡°íšŒ, `media_name`, `media_type`, `media_rel_dt` ì»¬ëŸ¼ë§Œ ì¶”ì¶œ
    - ```sql
      select media_name, media_type, media_rel_dt
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      ```
- íŠ¹ì • ë‚ ì§œì— ì—…ë¡œë“œëœ ë¯¸ë””ì–´ ì¤‘, `media_category_ids` ì»¬ëŸ¼ì— íŠ¹ì • ì¹´í…Œê³ ë¦¬ IDê°€ í¬í•¨ëœ ë¯¸ë””ì–´ ì •ë³´ ì¡°íšŒ
    - ```sql
      select *
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      and array_contains(media_cat_ids, CATEGORY_ID)
      ```  
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_wv_mart_daily`

### Update Interval: DAILY

### Update Type: APPEND

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/wv_media.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_wv_mart_daily.py)
  
    
---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|we_mart.we_artist|we_mart.stats_wv_d_media_activity|
|weverse2.community_common_wev_id|we_mart.stats_wv_d_media_agg_activity|
|weverse2.community_content_common_post_video_relation|we_mart.stats_wv_d_media_agg_activity_cp|
|weverse2.community_content_photo|we_mart.stats_wv_d_tv_media_play_tmp|
|weverse2.community_content_post|we_mart.stats_wv_m_video_copyright|
|weverse2.community_content_post_photo_relation|we_mart.wv_media_reaction|
|weverse2.video_video|we_mart.wv_post_view|
|weverse2.video_vod|we_mart.wv_video_play|
|weverse2.video_vod_audit|we_mart.wv_vod_play|

## ğŸ¤ Downstream Tables Info
  
### Downstream Tables
- **`we_mart.stats_wv_d_tv_media_play_tmp`**: ì¼ê°„ ìœ„ë²„ìŠ¤ TVì•± ë¯¸ë””ì–´ ì¡°íšŒ/ì¬ìƒ ìˆ˜ ì§‘ê³„ í†µê³„ í…Œì´ë¸”(ì„ì‹œ)
    - `we_mart.wv_media` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_id`, `media_name`, `media_cat_id` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_cat_name` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_video_play` í…Œì´ë¸”ì˜ `view_cnt`, `play_main_cnt`, `play_preview_cnt` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ì¡°íšŒ/ì¬ìƒ ìˆ˜ë¥¼ ì§‘ê³„í•œë‹¤.
    - `key_date`, `type`, `media_id`, `post_id`, `media_name`, `media_cat_id`, `ctry_code`, `we_art_id`, `we_art_name` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `type`, `media_id`, `post_id`, `media_name`, `media_cat_id`, `ctry_code`, `we_art_id`, `we_art_name` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ìœ í˜•, ë¯¸ë””ì–´, ì•„í‹°ìŠ¤íŠ¸, êµ­ê°€ë³„ ì¡°íšŒ/ì¬ìƒ ìˆ˜ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_wv_d_media_activity`**: ì¼ê°„ ìœ„ë²„ìŠ¤ ë¯¸ë””ì–´ ìœ ì € í™œë™ ì§‘ê³„ 
    - `we_mart.wv_media` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_id`, `media_name`, `media_type`, `media_cat_ids`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_cat_name` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_media_reaction` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `like`, `comment`, `reaction` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_video_play` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `view`, `play` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `key_date`, `is_fc`, `ctry`, `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `is_fc`, `ctry`, `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_id` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ë©¤ë²„ì‹­ ì—¬ë¶€, êµ­ê°€, ë¯¸ë””ì–´, ì•„í‹°ìŠ¤íŠ¸, ì¹´í…Œê³ ë¦¬ë³„ í™œë™ ì§€í‘œë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_wv_d_media_agg_activity`**: ì¼ê°„ ìœ„ë²„ìŠ¤ ë¯¸ë””ì–´ ìœ ì € í™œë™ ì§‘ê³„ (ì§‘ê³„)
    - `we_mart.wv_media` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_ids` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_cat_name` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_media_reaction` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `like`, `comment`, `reaction` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_video_play` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `view`, `play` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `key_date`, `is_fc`, `ctry`, `we_art_id`, `media_cat_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `is_fc`, `ctry`, `we_art_id`, `media_cat_id` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ë©¤ë²„ì‹­ ì—¬ë¶€, êµ­ê°€, ì•„í‹°ìŠ¤íŠ¸, ì¹´í…Œê³ ë¦¬ë³„ í™œë™ ì§€í‘œë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_wv_d_media_agg_activity_cp`**: ì¼ê°„ ìœ„ë²„ìŠ¤ ë¯¸ë””ì–´ ìœ ì € í™œë™ ì§‘ê³„ (ì§‘ê³„, CP)
    - `we_mart.wv_media` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_ids`, `cp_code`, `content_provider` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_cat_name` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_media_reaction` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `like`, `comment`, `reaction` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_video_play` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `view`, `play` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `key_date`, `is_fc`, `ctry`, `cp_code`, `cat_id`, `product_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `is_fc`, `ctry`, `cp_code`, `cat_id`, `product_id` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ë©¤ë²„ì‹­ ì—¬ë¶€, êµ­ê°€, CP, ì¹´í…Œê³ ë¦¬, ìƒí’ˆë³„ í™œë™ ì§€í‘œë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- **`we_mart.wv_video_play`**: ìœ ì €ë³„ ë¯¸ë””ì–´ ì¬ìƒ History
    - `we_mart.wv_media` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_id`, `media_name`, `media_type`, `media_cat_ids`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `comm_id`, `media_dur`, `media_rel_dt` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.we_user` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `user_status`, `we_member_id` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_user_ctry_history` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `first_ip_ctry` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.we_artist` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `ws_art_id`, `ws_label_id` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `service_log.weverse_server_log`, `service_log.weverse_client_log` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `view_cnt`, `play_main_cnt`, `play_preview_cnt`, `subtitle` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `key_date`, `user_id`, `post_id`, `media_type` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `user_id`, `post_id`, `media_type` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ìœ ì €, í¬ìŠ¤íŠ¸, ë¯¸ë””ì–´ ìœ í˜•ë³„ ì¡°íšŒ/ì¬ìƒ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- **`we_mart.stats_wv_d_live`**: LIVEë³„ ì¬ìƒ ì§‘ê³„ ìŠ¤íƒ¯
    - `we_mart.wv_live` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ LIVE ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_video_play` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `view`, `play` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_media_reaction` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `like`, `comment` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `key_date`, `we_art_id`, `post_id`, `media_type`, `ctry_code` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `we_art_id`, `post_id`, `media_type`, `ctry_code` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ì•„í‹°ìŠ¤íŠ¸, í¬ìŠ¤íŠ¸, ë¯¸ë””ì–´ ìœ í˜•, êµ­ê°€ë³„ LIVE ì§€í‘œë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- **`we_mart.wv_media_reaction`**: ì¼ê°„ ë¯¸ë””ì–´ ë¦¬ì•¡ì…˜ ì •ë³´ 
    - `we_mart.wv_media` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `media_id`, `media_name`, `media_type`, `media_cat_ids`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `comm_id`, `media_dur`, `media_rel_dt`, `cnt_photo` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.we_user_compact` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `we_member_id` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `we_mart.wv_user_ctry_history` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `ip_ctry` ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `weverse2.community_content_comment`, `weverse2.community_content_post_emotion_relation`, `weverse2.community_content_comment_emotion_relation` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ `like`, `comment`, `reaction` ê´€ë ¨ ì§€í‘œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - `key_date`, `media_id`, `post_id`, `wv_user_id`, `comm_id` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê·¸ë£¹í™”í•œë‹¤.
    - ì‚¬ìš©ìëŠ” `key_date`, `media_id`, `post_id`, `wv_user_id`, `comm_id` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ íŠ¹ì • ë‚ ì§œ, ë¯¸ë””ì–´, í¬ìŠ¤íŠ¸, ìœ ì €, ì»¤ë®¤ë‹ˆí‹°ë³„ ë¦¬ì•¡ì…˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

### Downstream View Tables
- **`med_cat_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `media_cat_ids` ì»¬ëŸ¼ì„ í­ë°œì‹œí‚¤ê³  `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ë¯¸ë””ì–´ ì¹´í…Œê³ ë¦¬ë³„ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”
- **`pkg_cat_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `product_keys` ì»¬ëŸ¼ì„ í­ë°œì‹œí‚¤ê³  `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ íŒ¨í‚¤ì§€ ì¹´í…Œê³ ë¦¬ë³„ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”
- **`art_total_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì•„í‹°ìŠ¤íŠ¸ë³„ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”
- **`total_total_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì „ì²´ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”
- **`cp_prod_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `product_keys` ì»¬ëŸ¼ì„ í­ë°œì‹œí‚¤ê³  `we_meta.we_media_product` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ CPë³„ ìƒí’ˆë³„ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”
- **`cp_pkgc_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ `product_keys` ì»¬ëŸ¼ì„ í­ë°œì‹œí‚¤ê³  `we_mart.wv_cat` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ CPë³„ íŒ¨í‚¤ì§€ ì¹´í…Œê³ ë¦¬ë³„ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”
- **`cp_tot_data`**: `we_mart.wv_media` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ CPë³„ í™œë™ ì§€í‘œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë·° í…Œì´ë¸”  
---