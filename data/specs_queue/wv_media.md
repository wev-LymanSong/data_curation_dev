
we_mart.wv_media
================

# BASIC INFO

|**About**| 담당자 수기 입력 필요 |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**|`part_date`|
|**Created/ Last Updated At**|2021-11-29 / 2024-07-30|
|**Created By**|박상민|
|**Last Updated By**|임혜경|
|**Collaborators**|송재영[23], 박상민[5], 임혜경[4], 윤상혁[2], 구민서[1], 이현지[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|박상민|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2022-01-04|박상민|[PR](https://github.com/benxcorp/databricks/commit/0cd91c5bd47eda12b5a4beb4580155f0aaf8df99)|
|2022-01-04|박상민|[PR](https://github.com/benxcorp/databricks/commit/657cc3e614739b94d28d3a2f8feb168b93640277)|
|2022-01-04|박상민|[PR](https://github.com/benxcorp/databricks/commit/28815d69a6d10da118e7ffe350ad3d0fcd58d77a)|
|2022-01-12|박상민|[PR](https://github.com/benxcorp/databricks/commit/24547537bfeecc9b9f0ffd90288ccf6080570e64)|
|2022-02-14|송재영|[PR](https://github.com/benxcorp/databricks/commit/ba7bcd1e0cc1a3084d8afe06c3fdd4e104bae6c8)|
|2022-02-17|송재영|[PR](https://github.com/benxcorp/databricks/commit/504d9fa4c8ff74728889eb27257d983d1fac7473)|
|2022-02-18|윤상혁|[PR](https://github.com/benxcorp/databricks/commit/26cfb9533725a5a62b87f1c50637a575d3a22581)|
|2022-03-15|송재영|[PR](https://github.com/benxcorp/databricks/commit/237ea14b8765d183d92366858f95b0f3e94b7a32)|
|2022-03-15|송재영|[PR](https://github.com/benxcorp/databricks/commit/0fe5b04368dc57ee658b11ea7efa5a21dc2ed007)|
|2022-03-16|송재영|[PR](https://github.com/benxcorp/databricks/commit/e28da897a7205713da976395612cc0716d72e490)|
|2022-03-17|송재영|[PR](https://github.com/benxcorp/databricks/commit/39fee16ecfa66b94a860e633a6bf63ff07920977)|
|2022-04-01|윤상혁|[PR](https://github.com/benxcorp/databricks/commit/eab10f64b0055f57e61daa97d3218295df39086e)|
|2022-04-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/fbcedfbe32888a06943a358ac122d0f3107dd77d)|
|2022-04-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/66a8dbf1a06a09bfd2b5e277e934f02f478cab2a)|
|2022-04-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/01e875d33d5d04826c6a7045add371c092bcd962)|
|2022-06-21|이현지|[PR](https://github.com/benxcorp/databricks/commit/4de5d0a511e4aea4096e4e68957053d954f979fb)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/5387e83c317abdd49bae9292dcaba8d2bb678171)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/efd64885f4879826fa359f0d482817c41e8d124f)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/c9c8d3c345863d76a112bc3f54d6b8ff85e8ce99)|
|2022-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/6431d379d2f752681926c82ca894169fcba52e82)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/b7f11df2a981ba8bece5a2ac2f223cd227d08cef)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/f7ea8558cfd57f5241ae6cde9d4c60014b118ff6)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/0b8ead7f2320859a7d13ea94dcd7b4d38aab49cf)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/4c35e9619158a93b94f1eb92d33eb0b206f52c3d)|
|2022-07-19|송재영|[PR](https://github.com/benxcorp/databricks/commit/453136d08d4c8f8516795dfe40e6cbe26e77ff5e)|
|2022-07-25|송재영|[PR](https://github.com/benxcorp/databricks/commit/4ae0ed46ac42092c78fd95fb2a156f779f835587)|
|2022-07-25|송재영|[PR](https://github.com/benxcorp/databricks/commit/3910dc828c7cc0ad562b492625fd96054725176e)|
|2022-07-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/842acd4f631ce140facb374d0e6581c3758d72e6)|
|2022-08-12|송재영|[PR](https://github.com/benxcorp/databricks/commit/53da1121b4fdc73055c588d254af5cbf4fb47ba0)|
|2022-08-12|송재영|[PR](https://github.com/benxcorp/databricks/commit/2f71f9da7bb26cdf0da240c816baac4f036f8a17)|
|2022-12-09|구민서|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2024-01-02|임혜경|[PR](https://github.com/benxcorp/databricks/commit/25ce09cb5ec8e3ee280edc265775b0321b5270fd)|
|2024-04-19|임혜경|[PR](https://github.com/benxcorp/databricks/commit/271d69a35739fa0a84c9a65293cff3f935bff871)|
|2024-07-03|임혜경|[PR](https://github.com/benxcorp/databricks/commit/075428504a65f49ab92bb5d5d49e004a7375cd99)|
|2024-07-30|임혜경|[PR](https://github.com/benxcorp/databricks/commit/b8d8ef804751387e3681d01dbf2fe3926a89038a)|
  
  
# TABLE NOTICE
  
### 테이블 개요

* **테이블 목적**: Weverse 플랫폼 내 미디어 정보를 담고 있는 테이블. 포스트, 비디오, 사진, 유튜브 정보를 종합적으로 제공
* **데이터 레벨**: AGGREGATED DATA(STATISTICS)
* **파티션 키**: `part_date`
* **주요 키**: `post_id`, `media_id`

### 테이블 특징

* Weverse 플랫폼 내 모든 미디어 유형에 대한 통합 정보 제공
* `media_id` 컬럼을 통해 `weverse2.community_common_wev_id` 테이블과 조인 가능
* `media_category_ids` 컬럼은 미디어 카테고리 정보를 array 형태로 저장하며, 특히 `is_fc_only` 값이 1이고 `section_type`이 `MEDIA`인 경우 -8888 ID를 추가하여 `we_mart.wv_media_cat` 테이블과 조인 가능
* `is_fc_only`, `is_photo`, `is_pitem`, `is_joint_live` 컬럼은 boolean 값으로 각각 팬클럽 전용 여부, 사진 여부, 유료 구매 아이템 여부, 합동 라이브 여부를 나타냄
* `video_id` 컬럼을 통해 `weverse2.video_video` 테이블과 조인 가능
* `video_id` 컬럼을 통해 `weverse2.video_vod` 테이블과 조인 가능
* `video_id` 컬럼을 통해 `weverse2.video_vod_audit` 테이블과 조인 가능
* `community_id` 컬럼을 통해 `we_mart.we_artist` 테이블과 조인 가능
* `photo_ids` 컬럼은 사진 ID를 array 형태로 저장하며, `cnt_photo` 컬럼은 사진 개수를 나타냄

### 데이터 추출 및 생성 과정

1. **주요 데이터 소스**:
    * `weverse2.community_content_post` 테이블: 포스트 기본 정보 추출
    * `weverse2.community_content_post_photo_relation` 테이블: 포스트와 사진 간의 관계 정보 추출
    * `weverse2.community_content_photo` 테이블: 사진 정보 추출
    * `weverse2.community_common_wev_id` 테이블: `media_id` 추출
    * `weverse2.community_content_common_post_video_relation` 테이블: 포스트와 비디오 간의 관계 정보 추출
    * `weverse2.video_video` 테이블: 비디오 정보 추출
    * `weverse2.video_vod` 테이블: VOD 정보 추출
    * `weverse2.video_vod_audit` 테이블: 비디오 등급 정보 추출
    * `we_mart.we_artist` 테이블: 아티스트 정보 추출
2. **데이터 전처리**:
    * `weverse2.community_content_post` 테이블에서 `data` 컬럼의 JSON 데이터를 파싱하여 필요한 정보 추출
    * `published_at`, `created_at`, `updated_at` 컬럼을 Unix timestamp에서 KST로 변환
    * `product_ids` 컬럼은 JSON 데이터에서 추출 후 중복 제거
    * `media_category_ids`, `media_group_ids` 컬럼은 JSON 데이터에서 추출 후 중복 제거 및 int 형식으로 변환
3. **데이터 통합**:
    * 여러 소스 테이블을 조인하여 하나의 데이터프레임 생성
4. **최종 테이블 생성**:
    * 데이터프레임을 `we_mart.wv_media` 테이블에 저장

### 테이블 활용 가이드

* **주요 활용**:
    * Weverse 플랫폼 내 미디어 현황 분석
    * 미디어 유형별, 아티스트별, 국가별 미디어 통계 분석
    * 팬클럽 전용 콘텐츠 분석
    * 유료 미디어 콘텐츠 분석
    * 비디오 재생 수, 댓글 수, 응원 수 등 반응 분석
* **조인 시 유의사항**:
    * `media_id` 컬럼을 통해 `weverse2.community_common_wev_id` 테이블과 조인 시, `wev1` 컬럼이 `MEDIA`로 시작하는 데이터만 사용해야 함
    * `media_category_ids` 컬럼은 `we_mart.wv_media_cat` 테이블과 조인 시, `is_fc_only` 값이 1이고 `section_type`이 `MEDIA`인 경우 -8888 ID를 추가하여 조인해야 함
    * `video_id` 컬럼을 통해 `weverse2.video_vod_audit` 테이블과 조인 시, `process_status`가 `COMPLETE`인 데이터만 사용해야 함
    * `community_id` 컬럼을 통해 `we_mart.we_artist` 테이블과 조인 시, 아티스트 정보를 얻을 수 있음
    * `photo_ids` 컬럼은 `weverse2.community_content_photo` 테이블과 조인하여 사진 상세 정보를 얻을 수 있음

### 추가 정보

* `media_type` 컬럼은 `IMAGE`, `VIDEO`, `YOUTUBE`, `LIVE` 등의 값을 가짐
* `section_type` 컬럼은 `MEDIA`, `NEWS`, `NOTICE`, `POLL`, `QNA`, `EVENT`, `SCHEDULE` 등의 값을 가짐
* `is_live_to_vod` 컬럼은 라이브 방송이 VOD로 변환되었는지 여부를 나타냄
* `live_to_vod_status` 컬럼은 라이브 방송이 VOD로 변환된 상태를 나타냄
* `rate_status` 컬럼은 비디오 등급 정보를 나타냄
* `part_date` 컬럼은 데이터 생성 일자를 나타냄  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|post_id|string|포스트 고유 ID|
|1|media_id|int|wv1에서의 미디어 ID|
|2|section_type|string|포스트 섹션 유형|
|3|media_type|string|미디어 유형|
|4|media_name|string|미디어 명|
|5|comm_id|int|커뮤니티 명|
|6|we_art_id|int|we_art_id|
|7|we_art_name|string|we_art_name|
|8|is_fc_only|int|멤버십 전용 여부|
|9|is_photo|int|사진 여부|
|10|is_pitem|int|유료 구매 아이템 여부|
|11|is_joint_live|int|합동라이브 여부|
|12|media_cat_ids|array<int>|미디어 카테고리 아이디들|
|13|media_group_ids|array<int>|미디어 그룹 아이디들|
|14|video_id|bigint|비디어 고유 ID|
|15|infra_video_id|string|네이버 동영상 플랫폼 내 ID|
|16|video_type|string|비디어 타입|
|17|preview_type|string|프리뷰 여부|
|18|video_expose_status|string|비디오 공개 상태|
|19|screen_orientation|string|기본 뷰 모양|
|20|live_to_vod_status|string|라이브 => VOD 변경 상태|
|21|video_cre_dt|timestamp|비디어 생성일|
|22|media_dur|int|미디어 총 시간|
|23|preview_start|int|미리보기 시작 지점|
|24|preview_end|int|미리보기 종료 지점|
|25|thumbnail_url|string|썸네일 URL|
|26|youtube_path|string|유튜브 URL|
|27|youtube_videoid|string|유튜브 video id|
|28|rate_status|string|영상등급|
|29|photo_ids|array<bigint>|포함된 사진(photo) 아이디 어레이|
|30|cnt_photo|int|사진 개수|
|31|play_count|bigint|재생 수|
|32|comment_count|int|댓글 수|
|33|emotion_count|int|응원 수|
|34|media_cre_dt|timestamp|미디어 생성 일시|
|35|media_upd_dt|timestamp|미디어 수정 일시|
|36|media_rel_dt|timestamp|미디어 노출 일시|
|37|part_date|string|파티션 일자|
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `wv_media` 테이블을 사용하여 특정 아티스트의 미디어 정보를 담은 뷰를 생성
    - ```sql
      create or replace temp view artist_media as
      select *
      from wev_prod.we_mart.wv_media
      where we_art_id = ARTIST
      and part_date = '2024-01-01'
      ```
- `wv_media` 테이블을 사용하여 특정 날짜의 모든 미디어 정보를 담은 테이블을 생성, 파티션 키로 part_date 사용
    - ```sql
      create or replace table wev_prod.we_mart.daily_media as
      select *
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      ```
- `wv_media` 테이블을 사용하여 특정 아티스트의 유료 미디어 정보를 담은 테이블을 생성, 파티션 키로 part_date 사용, `we_meta.we_media_product` 테이블과 조인
    - ```sql
      create or replace table wev_prod.we_mart.artist_paid_media as
      select distinct WM.post_id, WM.media_id, WM.media_name, WM.media_type, WM.media_cat_ids, WM.is_pitem, WM.we_art_id, WM.we_art_name, WM.media_rel_dt, WM.part_date
      from wev_prod.we_mart.wv_media WM
      inner join wev_prod.we_meta.we_media_product WMP
      on WM.post_id = WMP.product_id
      where WM.we_art_id = ARTIST
      and WM.part_date = '2024-01-01'
      ```
- `wv_media` 테이블을 사용하여 특정 날짜의 모든 미디어 정보를 담은 테이블을 생성, 파티션 키로 part_date 사용, `we_mart.wv_cat` 테이블과 조인
    - ```sql
      create or replace table wev_prod.we_mart.daily_media_with_category as
      select WM.*, WC.cat_id, WC.cat_name
      from wev_prod.we_mart.wv_media WM
      left join wev_prod.we_mart.wv_cat WC
      on array_contains(WM.media_cat_ids, WC.cat_id)
      where WM.part_date = '2024-01-01'
      ```

### Data Extraction
- 특정 날짜의 모든 미디어 타입 조회
    - ```sql
      select distinct media_type
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      ```
- 특정 아티스트의 모든 미디어 정보 조회
    - ```sql
      select *
      from wev_prod.we_mart.wv_media
      where we_art_id = ARTIST
      and part_date = '2024-01-01'
      ```
- 특정 날짜에 업로드된 모든 미디어 정보 조회, `media_name`, `media_type`, `media_rel_dt` 컬럼만 추출
    - ```sql
      select media_name, media_type, media_rel_dt
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      ```
- 특정 날짜에 업로드된 미디어 중, `media_category_ids` 컬럼에 특정 카테고리 ID가 포함된 미디어 정보 조회
    - ```sql
      select *
      from wev_prod.we_mart.wv_media
      where part_date = '2024-01-01'
      and array_contains(media_cat_ids, CATEGORY_ID)
      ```  
---
# PIPELINE INFO

## ⌛️ BATCH

### DAG: `analytics_wv_mart_daily`

### Update Interval: DAILY

### Update Type: APPEND

## 📍 LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/wv_media.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_wv_mart_daily.py)
  
    
---
# DEPENDENCIES

## 👨‍👩‍👧‍👦 Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|we_mart.we_artist|we_mart.stats_wv_d_media_activity|
|weverse2.community_common_wev_id|we_mart.stats_wv_d_media_agg_activity|
|weverse2.community_content_common_post_video_relation|we_mart.stats_wv_d_media_agg_activity_cp|
|weverse2.community_content_photo|we_mart.stats_wv_d_tv_media_play_tmp|
|weverse2.community_content_post|we_mart.stats_wv_m_video_copyright|
|weverse2.community_content_post_photo_relation|we_mart.wv_media_reaction|
|weverse2.video_video|we_mart.wv_post_view|
|weverse2.video_vod|we_mart.wv_video_play|
|weverse2.video_vod_audit|we_mart.wv_vod_play|

## 🐤 Downstream Tables Info
  
### Downstream Tables
- **`we_mart.stats_wv_d_tv_media_play_tmp`**: 일간 위버스 TV앱 미디어 조회/재생 수 집계 통계 테이블(임시)
    - `we_mart.wv_media` 테이블을 조인하여 `media_id`, `media_name`, `media_cat_id` 정보를 가져온다.
    - `we_mart.wv_cat` 테이블을 조인하여 `media_cat_name` 정보를 가져온다.
    - `we_mart.wv_video_play` 테이블의 `view_cnt`, `play_main_cnt`, `play_preview_cnt` 컬럼을 사용하여 조회/재생 수를 집계한다.
    - `key_date`, `type`, `media_id`, `post_id`, `media_name`, `media_cat_id`, `ctry_code`, `we_art_id`, `we_art_name` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `type`, `media_id`, `post_id`, `media_name`, `media_cat_id`, `ctry_code`, `we_art_id`, `we_art_name` 컬럼을 이용하여 특정 날짜, 유형, 미디어, 아티스트, 국가별 조회/재생 수를 조회할 수 있다.
- **`we_mart.stats_wv_d_media_activity`**: 일간 위버스 미디어 유저 활동 집계 
    - `we_mart.wv_media` 테이블을 조인하여 `media_id`, `media_name`, `media_type`, `media_cat_ids`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name` 정보를 가져온다.
    - `we_mart.wv_cat` 테이블을 조인하여 `media_cat_name` 정보를 가져온다.
    - `we_mart.wv_media_reaction` 테이블을 조인하여 `like`, `comment`, `reaction` 관련 지표 정보를 가져온다.
    - `we_mart.wv_video_play` 테이블을 조인하여 `view`, `play` 관련 지표 정보를 가져온다.
    - `key_date`, `is_fc`, `ctry`, `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_id` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `is_fc`, `ctry`, `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_id` 컬럼을 이용하여 특정 날짜, 멤버십 여부, 국가, 미디어, 아티스트, 카테고리별 활동 지표를 조회할 수 있다.
- **`we_mart.stats_wv_d_media_agg_activity`**: 일간 위버스 미디어 유저 활동 집계 (집계)
    - `we_mart.wv_media` 테이블을 조인하여 `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_ids` 정보를 가져온다.
    - `we_mart.wv_cat` 테이블을 조인하여 `media_cat_name` 정보를 가져온다.
    - `we_mart.wv_media_reaction` 테이블을 조인하여 `like`, `comment`, `reaction` 관련 지표 정보를 가져온다.
    - `we_mart.wv_video_play` 테이블을 조인하여 `view`, `play` 관련 지표 정보를 가져온다.
    - `key_date`, `is_fc`, `ctry`, `we_art_id`, `media_cat_id` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `is_fc`, `ctry`, `we_art_id`, `media_cat_id` 컬럼을 이용하여 특정 날짜, 멤버십 여부, 국가, 아티스트, 카테고리별 활동 지표를 조회할 수 있다.
- **`we_mart.stats_wv_d_media_agg_activity_cp`**: 일간 위버스 미디어 유저 활동 집계 (집계, CP)
    - `we_mart.wv_media` 테이블을 조인하여 `media_id`, `media_name`, `media_type`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `media_cat_ids`, `cp_code`, `content_provider` 정보를 가져온다.
    - `we_mart.wv_cat` 테이블을 조인하여 `media_cat_name` 정보를 가져온다.
    - `we_mart.wv_media_reaction` 테이블을 조인하여 `like`, `comment`, `reaction` 관련 지표 정보를 가져온다.
    - `we_mart.wv_video_play` 테이블을 조인하여 `view`, `play` 관련 지표 정보를 가져온다.
    - `key_date`, `is_fc`, `ctry`, `cp_code`, `cat_id`, `product_id` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `is_fc`, `ctry`, `cp_code`, `cat_id`, `product_id` 컬럼을 이용하여 특정 날짜, 멤버십 여부, 국가, CP, 카테고리, 상품별 활동 지표를 조회할 수 있다.
- **`we_mart.wv_video_play`**: 유저별 미디어 재생 History
    - `we_mart.wv_media` 테이블을 조인하여 `media_id`, `media_name`, `media_type`, `media_cat_ids`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `comm_id`, `media_dur`, `media_rel_dt` 정보를 가져온다.
    - `we_mart.we_user` 테이블을 조인하여 `user_status`, `we_member_id` 정보를 가져온다.
    - `we_mart.wv_user_ctry_history` 테이블을 조인하여 `first_ip_ctry` 정보를 가져온다.
    - `we_mart.we_artist` 테이블을 조인하여 `ws_art_id`, `ws_label_id` 정보를 가져온다.
    - `service_log.weverse_server_log`, `service_log.weverse_client_log` 테이블을 조인하여 `view_cnt`, `play_main_cnt`, `play_preview_cnt`, `subtitle` 정보를 가져온다.
    - `key_date`, `user_id`, `post_id`, `media_type` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `user_id`, `post_id`, `media_type` 컬럼을 이용하여 특정 날짜, 유저, 포스트, 미디어 유형별 조회/재생 정보를 조회할 수 있다.
- **`we_mart.stats_wv_d_live`**: LIVE별 재생 집계 스탯
    - `we_mart.wv_live` 테이블을 사용하여 LIVE 정보를 가져온다.
    - `we_mart.wv_video_play` 테이블을 조인하여 `view`, `play` 관련 지표 정보를 가져온다.
    - `we_mart.wv_media_reaction` 테이블을 조인하여 `like`, `comment` 관련 지표 정보를 가져온다.
    - `key_date`, `we_art_id`, `post_id`, `media_type`, `ctry_code` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `we_art_id`, `post_id`, `media_type`, `ctry_code` 컬럼을 이용하여 특정 날짜, 아티스트, 포스트, 미디어 유형, 국가별 LIVE 지표를 조회할 수 있다.
- **`we_mart.wv_media_reaction`**: 일간 미디어 리액션 정보 
    - `we_mart.wv_media` 테이블을 조인하여 `media_id`, `media_name`, `media_type`, `media_cat_ids`, `is_pitem`, `is_fc_only`, `we_art_id`, `we_art_name`, `comm_id`, `media_dur`, `media_rel_dt`, `cnt_photo` 정보를 가져온다.
    - `we_mart.we_user_compact` 테이블을 조인하여 `we_member_id` 정보를 가져온다.
    - `we_mart.wv_user_ctry_history` 테이블을 조인하여 `ip_ctry` 정보를 가져온다.
    - `weverse2.community_content_comment`, `weverse2.community_content_post_emotion_relation`, `weverse2.community_content_comment_emotion_relation` 테이블을 조인하여 `like`, `comment`, `reaction` 관련 지표 정보를 가져온다.
    - `key_date`, `media_id`, `post_id`, `wv_user_id`, `comm_id` 컬럼을 사용하여 데이터를 그룹화한다.
    - 사용자는 `key_date`, `media_id`, `post_id`, `wv_user_id`, `comm_id` 컬럼을 이용하여 특정 날짜, 미디어, 포스트, 유저, 커뮤니티별 리액션 정보를 조회할 수 있다.

### Downstream View Tables
- **`med_cat_data`**: `we_mart.wv_media` 테이블을 사용하여 `media_cat_ids` 컬럼을 폭발시키고 `we_mart.wv_cat` 테이블을 조인하여 미디어 카테고리별 활동 지표를 계산하는 데 사용되는 뷰 테이블
- **`pkg_cat_data`**: `we_mart.wv_media` 테이블을 사용하여 `product_keys` 컬럼을 폭발시키고 `we_mart.wv_cat` 테이블을 조인하여 패키지 카테고리별 활동 지표를 계산하는 데 사용되는 뷰 테이블
- **`art_total_data`**: `we_mart.wv_media` 테이블을 사용하여 아티스트별 활동 지표를 계산하는 데 사용되는 뷰 테이블
- **`total_total_data`**: `we_mart.wv_media` 테이블을 사용하여 전체 활동 지표를 계산하는 데 사용되는 뷰 테이블
- **`cp_prod_data`**: `we_mart.wv_media` 테이블을 사용하여 `product_keys` 컬럼을 폭발시키고 `we_meta.we_media_product` 테이블을 조인하여 CP별 상품별 활동 지표를 계산하는 데 사용되는 뷰 테이블
- **`cp_pkgc_data`**: `we_mart.wv_media` 테이블을 사용하여 `product_keys` 컬럼을 폭발시키고 `we_mart.wv_cat` 테이블을 조인하여 CP별 패키지 카테고리별 활동 지표를 계산하는 데 사용되는 뷰 테이블
- **`cp_tot_data`**: `we_mart.wv_media` 테이블을 사용하여 CP별 활동 지표를 계산하는 데 사용되는 뷰 테이블  
---