
we_mart.ws_order
================

# BASIC INFO

|**About**| ë‹´ë‹¹ì ìˆ˜ê¸° ì…ë ¥ í•„ìš” |
| :--- | :--- |
|**Database**|**we_mart**|
|**Table Type**|MART PRIMARY|
|**Partitioned by**|`part_month`|
|**Created/ Last Updated At**|2021-11-29 / 2024-05-03|
|**Created By**|ë°•ìƒë¯¼|
|**Last Updated By**|ì´í˜„ì§€|
|**Collaborators**|ì´í˜„ì§€[42], ì†¡ì¬ì˜[2], ë°•ìƒë¯¼[2], ì„ì§€ì—°[1], ê¹€ë¯¼ì •[1], êµ¬ë¯¼ì„œ[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2021-11-29|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/8dc809154614d40353684e2d2023adee4ec47cef)|
|2021-12-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/17e39a2a6a3b58d32d2943fb5344034cabe6f96a)|
|2021-12-09|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/2380d7ad14ce4dd84cae43804df09d8e6fc21ceb)|
|2021-12-13|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/5aee833cefc072ff168d384bb4ca12e9486fb0df)|
|2022-01-05|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/8a072028ef98a99ab92d7b24ceb71c055e8626e5)|
|2022-01-12|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/3f87b072a8786324f51778a86776b521a933ec22)|
|2022-01-13|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/6d01c03cb147fff791fdef4ff76fb59461b57aee)|
|2022-01-13|ë°•ìƒë¯¼|[PR](https://github.com/benxcorp/databricks/commit/d4cb6787c476418e7b480ea8663cd861a0fe7a17)|
|2022-01-13|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/6653f7f5c8f6cd5fe98f4474db6782d267afa5a4)|
|2022-01-19|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/6945399dd17fca7cf2abaa925b45a874ad4d7b6a)|
|2022-03-24|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/1ab5cd1e8fd28be7a6c8d51f8b82b58a5c732022)|
|2022-03-31|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/99b89bbd07f724f47ae87e25a3a65f422fe3b628)|
|2022-05-19|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/600c36cca235a57008c8e53f0df5498e1f11b04a)|
|2022-06-09|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/d1805b6860086326e04ba7cdccec621cb219fc09)|
|2022-07-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/4af476b556e4d91a7df527a3d8b8d0886bec1ac4)|
|2022-07-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/93806cc61fd2b5b1353c65fc4670a9df2bf75f09)|
|2022-07-01|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/a85d56f15a85f23fab5b43c376ff132723778297)|
|2022-07-04|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/f20547c57a3c2eb877ea7c9b24a05324338ae1da)|
|2022-07-25|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/3f3e0ac3b50c035ecb27d8b15ac0d8fe49323979)|
|2022-10-13|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/e20206b5f52659e7804267878c32568a89278683)|
|2022-10-14|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/c689c32ad22f9fd4abcda98f2b65d3948e6a3196)|
|2022-11-09|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/f223510bb8f86608ce344ed9d8ea9291ccf83143)|
|2022-11-16|ì†¡ì¬ì˜|[PR](https://github.com/benxcorp/databricks/commit/7c5ab12d2ed3461252d484e62a3e494391ee2d6c)|
|2022-12-09|êµ¬ë¯¼ì„œ|[PR](https://github.com/benxcorp/databricks/commit/bd183779c84e616084e05627330a1c8b98ca44bd)|
|2022-12-12|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/826680a217711a14844d4970c26e1f1f5d34b0a4)|
|2022-12-12|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/224c76fda4efedf027b236a2857575e1c426a25f)|
|2022-12-22|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/c1d918ef362e46ea23d4a14be2f8694abc985ff0)|
|2022-12-22|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/c9b19b2c04f21aa081635fd4cdfb22dab6ac3310)|
|2023-01-30|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/3329db11a3ac8d5b4dbc16869289b061f8d7451b)|
|2023-02-02|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/5a943b91e72f7f105dce9f7f55ce393d2248e5e4)|
|2023-02-03|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/13fe0c2dc9eb154afa455de977af2e2911aa0f07)|
|2023-02-03|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/e1700376c258ff23f3a3ffda6bd049ca2d570ec9)|
|2023-02-03|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/ec29fb73dbaa8762e8905cd08fa65636677149d4)|
|2023-02-03|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/1ee15351ddea9bf6e1fe5365b67dc272dbfb6f6f)|
|2023-03-06|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/9bd817820b41548476ef3f458d80e5db724cdf3c)|
|2023-09-13|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/c881a709360da4152072f58a5b1fa27f1b5ad6ae)|
|2023-09-18|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/1ab3a6b086402d48b0056e2c899e401ef495444f)|
|2023-09-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/a0a52ec622c06737ea76ed9a0e1a07377e143fbd)|
|2023-09-21|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/6cda9d7ee5bb6387ed250db599aabce0ec86ada9)|
|2023-11-14|ê¹€ë¯¼ì •|[PR](https://github.com/benxcorp/databricks/commit/1a8600c29277eb2f98f7601f08478367c27b3b67)|
|2023-12-28|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/a45b71880622807a2772bc2c9c0c8e9f3755453c)|
|2024-02-02|ì„ì§€ì—°|[PR](https://github.com/benxcorp/databricks/commit/19d90ee6d6b71316423df597a01937443bf3c5c6)|
|2024-03-19|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/498fef12c553ef095d33b8d20e2e1f49ca085bbc)|
|2024-03-19|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/ee962a3adc6b02e130aad954ffc6efe1e389808b)|
|2024-03-19|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/8970cec2866970653e77476c8973ede1cd0e137b)|
|2024-03-19|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/b82956bad73156ca3144949d6a48c4d5ff3057d5)|
|2024-03-19|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/2bf4c67f4cbb6f64c7f841908e60914cc3b9271a)|
|2024-04-18|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/92ee41a9e2781464649945ca17c39ac82a255901)|
|2024-05-03|ì´í˜„ì§€|[PR](https://github.com/benxcorp/databricks/commit/bda74be725f67d3254b1d9dd0321838e8a4c2f7a)|
  
  
# TABLE NOTICE
  
### í…Œì´ë¸” ê°œìš”

* **í…Œì´ë¸” ëª©ì **: ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ì£¼ë¬¸, ê²°ì œ, ë°°ì†¡, ì·¨ì†Œ/í™˜ë¶ˆ ì •ë³´ì™€ ìƒí’ˆ, ì•„í‹°ìŠ¤íŠ¸, ë©¤ë²„ì‹­ ì •ë³´ë¥¼ í†µí•©í•˜ì—¬ ë¶„ì„ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì œê³µ
* **ë°ì´í„° ë ˆë²¨**: TRANSACTIONAL DATA
* **íŒŒí‹°ì…˜ í‚¤**: `part_month`
* **ì£¼ìš” í‚¤**: `ord_item_id`

### í…Œì´ë¸” íŠ¹ì§•

* `we_member_id`ì™€ `ws_user_id`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ë²„ìŠ¤ í”Œë«í¼ê³¼ ìœ„ë²„ìŠ¤ìƒµ ì‚¬ìš©ì ê°„ì˜ ì—°ê²°ì„±ì„ íŒŒì•…
* `is_fc`, `pay_seq`, `pay_ok_seq`ë¥¼ í†µí•´ ë©¤ë²„ì‹­ ìƒíƒœ, ê²°ì œ ì„±ê³µ ìˆœë²ˆ, ê²°ì œ ì„±ê³µ ë° ì£¼ë¬¸ ì™„ë£Œ ìˆœë²ˆì„ ì¶”ì 
* `ord_item_amt_krw`, `ord_item_cx_amt_krw`ì™€ ê°™ì€ ì»¬ëŸ¼ì„ í†µí•´ KRW ê¸°ì¤€ ì£¼ë¬¸/ì·¨ì†Œ ê¸ˆì•¡ì„ í™•ì¸
* `ship_cost_type` ì»¬ëŸ¼ì„ í†µí•´ ë°°ì†¡ ë¹„ìš© ìœ í˜•(ë¬´ë£Œ/ìœ ë£Œ)ì„ êµ¬ë¶„

### ë°ì´í„° ì¶”ì¶œ ë° ìƒì„± ê³¼ì •

1.  **ì£¼ìš” ë°ì´í„° ì†ŒìŠ¤**:
    *   `we_mart.ods_ws_order_item`: ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ìƒí’ˆ ì •ë³´
    *   `we_mart.ods_ws_payment_transaction`: ìœ„ë²„ìŠ¤ìƒµ ê²°ì œ ì •ë³´
    *   `we_mart.ods_ws_order_sheet`: ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ì •ë³´
    *   `we_mart.ods_ws_shipping_group`: ìœ„ë²„ìŠ¤ìƒµ ë°°ì†¡ ê·¸ë£¹ ì •ë³´
    *   `weverseshop.delivery_service`: ìœ„ë²„ìŠ¤ìƒµ ë°°ì†¡ ì„œë¹„ìŠ¤ ì •ë³´
    *   `weverseshop.express_courier`: ìœ„ë²„ìŠ¤ìƒµ íŠ¹ì†¡ì‚¬ ì •ë³´
    *   `we_mart.ws_goods_stock`: ìœ„ë²„ìŠ¤ìƒµ ìƒí’ˆ ì¬ê³  ì •ë³´
    *   `we_mart.ods_ws_user`: ìœ„ë²„ìŠ¤ìƒµ ì‚¬ìš©ì ì •ë³´
    *   `we_mart.we_id_mapping`: ìœ„ë²„ìŠ¤ í”Œë«í¼ê³¼ ìœ„ë²„ìŠ¤ìƒµ ì‚¬ìš©ì ID ë§¤í•‘ ì •ë³´
    *   `weverseshop.order_item_release`: ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ìƒí’ˆ ë°œë§¤ ì •ë³´
    *   `we_mart.ws_fc_user_history`: ìœ„ë²„ìŠ¤ìƒµ ë©¤ë²„ì‹­ ì •ë³´
    *   `we_meta.currency_rate`: í™˜ìœ¨ ì •ë³´
    *   `wev_prod.weverseshop.order_item_history`: ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ìƒí’ˆ ì´ë ¥ ì •ë³´
2.  **ë°ì´í„° ì „ì²˜ë¦¬**:
    *   `order_item`, `payment_transaction`, `user_ctry_history`, `currency_rate`, `order_sheet`, `fc_user_history`, `cx_order_item` ë“±ì˜ ë·° í…Œì´ë¸” ìƒì„±
    *   `we_mart.ods_ws_order_item`ì—ì„œ `part_date`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìµœê·¼ 2ë…„ì¹˜ ë°ì´í„°ë§Œ ì¶”ì¶œ
    *   `wev_prod.weverseshop.order_item_history`ì—ì„œ `status`ê°€ íŠ¹ì • ê°’ì¸ ë°ì´í„° ì¤‘ ìµœì´ˆ ìƒì„±ëœ ë°ì´í„°ë§Œ ì¶”ì¶œ
    *   `we_mart.ods_ws_order_sheet`ì™€ `user_ctry_history`ë¥¼ `user_id`ì™€ `created_at`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¡°ì¸í•˜ì—¬ ì‚¬ìš©ìì˜ êµ­ê°€ ì •ë³´ë¥¼ ì¶”ê°€
    *   `we_mart.ws_fc_user_history`ì—ì„œ `is_cx_by_restore`ê°€ 0ì´ê³  `ord_status`ê°€ `PAYMENT_FAILED`ê°€ ì•„ë‹Œ ë°ì´í„°ë§Œ ì¶”ì¶œ
3.  **ë°ì´í„° í†µí•©**:
    *   ìœ„ì˜ ë·° í…Œì´ë¸”ë“¤ì„ `order_item_id`, `order_sheet_id`, `we_member_id`, `sale_id`, `goods_id`, `goods_option_code`, `created_at` ë“±ì˜ ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì¡°ì¸
    *   `is_pay`, `is_pay_waiting`, `is_pay_waiting_exceed`, `is_status_ok`, `is_cx`, `is_admin_ord`, `is_exch_ord` ë“±ì˜ ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ì—¬ ì£¼ë¬¸ ìƒíƒœ ì •ë³´ë¥¼ í‘œí˜„
    *   `ord_item_amt_krw`, `ord_item_cx_amt_krw` ì»¬ëŸ¼ì„ ìƒì„±í•˜ì—¬ KRW ê¸°ì¤€ ì£¼ë¬¸/ì·¨ì†Œ ê¸ˆì•¡ì„ ê³„ì‚°
    *   `ship_cost_type` ì»¬ëŸ¼ì„ ìƒì„±í•˜ì—¬ ë°°ì†¡ ë¹„ìš© ìœ í˜•ì„ êµ¬ë¶„
4.  **ìµœì¢… í…Œì´ë¸” ìƒì„±**:
    *   ìœ„ì˜ ë°ì´í„° í†µí•© ê²°ê³¼ë¥¼ `we_mart.ws_order` í…Œì´ë¸”ì— ì €ì¥
    *   `part_month` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ ì‚¬ìš©

### í…Œì´ë¸” í™œìš© ê°€ì´ë“œ

* **ì£¼ìš” í™œìš©**:
    *   ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ë°ì´í„° ë¶„ì„
    *   ë©¤ë²„ì‹­ êµ¬ë§¤ ë¶„ì„
    *   ìƒí’ˆë³„ íŒë§¤ ë¶„ì„
    *   êµ­ê°€ë³„ ì£¼ë¬¸ ë¶„ì„
    *   ê²°ì œ ì„±ê³µë¥  ë¶„ì„
    *   ì·¨ì†Œ/í™˜ë¶ˆ ë¶„ì„
* **ì¡°ì¸ ì‹œ ìœ ì˜ì‚¬í•­**:
    *   `we_member_id`ì™€ `ws_user_id`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ë²„ìŠ¤ í”Œë«í¼ê³¼ ìœ„ë²„ìŠ¤ìƒµ ì‚¬ìš©ì ê°„ì˜ ì—°ê²°ì„±ì„ ê³ ë ¤í•´ì•¼ í•¨
    *   `is_fc` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë©¤ë²„ì‹­ ìƒíƒœë¥¼ ê³ ë ¤í•´ì•¼ í•¨
    *   `pay_seq`, `pay_ok_seq` ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ê²°ì œ ì„±ê³µ ìˆœë²ˆ ë° ê²°ì œ ì„±ê³µ & ì£¼ë¬¸ ì™„ë£Œ ìˆœë²ˆì„ ê³ ë ¤í•´ì•¼ í•¨

### ì¶”ê°€ ì •ë³´

*   `we_mart.ws_order` í…Œì´ë¸”ì€ `part_month` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê´€ë¦¬
*   `we_mart.ws_order` í…Œì´ë¸”ì€ `we_member_id`, `ws_user_id`, `ord_item_id`, `sale_id`, `goods_id`, `goods_option_code` ë“±ì˜ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ í…Œì´ë¸”ê³¼ ì¡°ì¸ ê°€ëŠ¥
*   `we_mart.ws_order` í…Œì´ë¸”ì€ ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” ë° ìœ ìš©í•œ ì •ë³´ë¥¼ ì œê³µ
*   `we_mart.ws_order` í…Œì´ë¸”ì€ ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ ë°ì´í„° ë¶„ì„ ì‹œ í•„ìˆ˜ì ìœ¼ë¡œ ì°¸ì¡°í•´ì•¼ í•˜ëŠ” í…Œì´ë¸”  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|run_timestamp|timestamp| |
|1|ord_cre_dt|timestamp|ì£¼ë¬¸ìƒì„±ì¼|
|2|ord_upd_dt|timestamp|ì£¼ë¬¸ì—…ë°ì´íŠ¸ì¼|
|3|pay_dt|timestamp|ê²°ì œì—…ë°ì´íŠ¸ì¼(ê²°ì œì™„ë£Œì¼ë¡œ ê°„ì£¼)|
|4|cx_dt|timestamp|ì·¨ì†Œì¼ì‹œ|
|5|deliv_completed_dt|timestamp|ë°°ì†¡ì™„ë£Œì¼|
|6|we_member_id|bigint|we_member_id|
|7|ws_user_id|bigint|ìœ„ë²„ìŠ¤ìƒµ user id|
|8|is_fc|int|êµ¬ë§¤ì‹œ ë©¤ë²„ì‹­ ìƒíƒœ ì—¬ë¶€|
|9|pay_seq|int|ê²°ì œì„±ê³µ ìˆœë²ˆ|
|10|pay_ok_seq|int|ê²°ì œì„±ê³µ & ì£¼ë¬¸ì™„ë£Œìƒíƒœ ìˆœë²ˆ|
|11|shop|string|shop|
|12|ord_sheet_id|bigint|ì£¼ë¬¸ id|
|13|ord_sheet_number|bigint|ì£¼ë¬¸ë²ˆí˜¸|
|14|ord_item_id|bigint|ì£¼ë¬¸ìƒí’ˆ id|
|15|sale_id|bigint|íŒë§¤ id|
|16|sale_stock_id|bigint|íŒë§¤ìƒí’ˆ ì˜µì…˜ id|
|17|goods_id|bigint|ìƒí’ˆ id|
|18|goods_code|string|ìƒí’ˆ code|
|19|goods_option_id|bigint|ìƒí’ˆ ì˜µì…˜ id|
|20|goods_option_code|string|ìƒí’ˆ ì˜µì…˜ code|
|21|sap_code|string|sap code|
|22|project_code|string|POD í”„ë¡œì íŠ¸ ì½”ë“œ|
|23|we_art_id|int|ì•„í‹°ìŠ¤íŠ¸ id|
|24|goods_upr_cat_id|bigint|ìƒìœ„ì¹´í…Œê³ ë¦¬ id|
|25|goods_lwr_cat_id|bigint|í•˜ìœ„ì¹´í…Œê³ ë¦¬ id|
|26|ship_group_id|bigint|ë°°ì†¡ê·¸ë£¹ id|
|27|deliv_service_id|bigint|ë°°ì†¡ì‚¬ id|
|28|we_art_name|string|ì•„í‹°ìŠ¤íŠ¸ëª…|
|29|goods_upr_cat_name|string|ìƒìœ„ì¹´í…Œê³ ë¦¬|
|30|goods_lwr_cat_name|string|í•˜ìœ„ì¹´í…Œê³ ë¦¬|
|31|goods_cat|string|ìƒí’ˆêµ¬ë¶„|
|32|logi_cat|string|ë¬¼ë¥˜ ì¹´í…Œê³ ë¦¬|
|33|goods_name|string|ìƒí’ˆëª…|
|34|goods_option_name|string|ìƒí’ˆ ì˜µì…˜ëª…|
|35|is_pay|int|ê²°ì œì—¬ë¶€|
|36|is_pay_waiting|int|í¸ì˜ì  ê²°ì œ íœë”© ì—¬ë¶€|
|37|is_pay_waiting_exceed|int|í¸ì˜ì  ê²°ì œ ì…ê¸ˆì¼ ì´ˆê³¼ ì—¬ë¶€|
|38|is_status_ok|int|ì£¼ë¬¸ì™„ë£Œìƒíƒœ ì—¬ë¶€|
|39|is_cx|int|ì·¨ì†Œ/í™˜ë¶ˆ ì—¬ë¶€|
|40|is_admin_ord|int|ìˆ˜ê¸°ì£¼ë¬¸ ì—¬ë¶€ (1: ìˆ˜ê¸° ì£¼ë¬¸, 0: ì •ìƒ ì£¼ë¬¸ )|
|41|is_exch_ord|int|êµí™˜ì£¼ë¬¸ ì—¬ë¶€ (1: êµí™˜ ì£¼ë¬¸, 0: ì •ìƒ ì£¼ë¬¸)|
|42|ord_status|string|ì£¼ë¬¸ìƒíƒœ|
|43|ord_item_qty|int|ì£¼ë¬¸ìƒí’ˆ ìˆ˜ëŸ‰|
|44|ord_item_cx_qty|int|ì·¨ì†Œ/í™˜ë¶ˆìƒí’ˆ ìˆ˜ëŸ‰|
|45|ord_item_amt|double|ì£¼ë¬¸ìƒí’ˆ ê¸ˆì•¡|
|46|ord_item_amt_krw|double|ì£¼ë¬¸ìƒí’ˆ ê¸ˆì•¡ (KRW)|
|47|ord_item_cx_amt|double|ì·¨ì†Œ/í™˜ë¶ˆìƒí’ˆ ê¸ˆì•¡|
|48|ord_item_cx_amt_krw|double|ì·¨ì†Œ/í™˜ë¶ˆìƒí’ˆ ê¸ˆì•¡ (KRW)|
|49|sale_price|double|íŒë§¤ê¸ˆì•¡|
|50|album_qty|int|ì•¨ë²”ìˆ˜ëŸ‰|
|51|currency_code|string|í†µí™”|
|52|currency_rate|double|í™˜ìœ¨|
|53|device_type|string|í´ë¼ì´ì–¸íŠ¸ í”Œë«í¼|
|54|ship_ctry_code|string|ë°°ì†¡êµ­ê°€ì½”ë“œ|
|55|ship_prov_area|string|ë°°ì†¡ state / Province|
|56|ship_group_name|string|ë°°ì†¡ê·¸ë£¹ ì´ë¦„|
|57|deliv_service_name|string|ë°°ì†¡ì‚¬ ì´ë¦„|
|58|deliv_express_code|string|íŠ¹ì†¡ì‚¬ ì½”ë“œ|
|59|logi_type|string|ë¬¼ë¥˜ì‚¬|
|60|ship_postal_code|string|ìš°í¸ë²ˆí˜¸|
|61|deliv_status|string|ë°°ì†¡ìƒíƒœ|
|62|ship_cost_type|string|ë°°ì†¡ êµ¬ë¶„|
|63|pay_gateway|string|ê²°ì œ PGì‚¬ (KCP, PAYPAL)|
|64|pay_method|string|ê²°ì œ ìˆ˜ë‹¨|
|65|pay_card_type|string|ê²°ì œ ì‹ ìš©ì¹´ë“œ ì¢…ë¥˜|
|66|pay_mobile_provider|string|ê²°ì œ ëª¨ë°”ì¼ í†µì‹ ì‚¬|
|67|ctry_code|string|user êµ­ê°€ì½”ë“œ|
|68|ip|string|user ip|
|69|trade_co_name|string|ê±°ë˜ì²˜|
|70|bm_option|string|bm_option|
|71|pod_option_sell_code|string|POD ìƒí’ˆ ì˜µì…˜ íŒë§¤ ì½”ë“œ|
|72|pod_template_code|string|POD í…œí”Œë¦¿ ì½”ë“œ|
|73|part_month|string| |
  
    
---
# HOW TO USE
  
### Downstream Table/View
- `we_member_id` ì»¬ëŸ¼ì„ íŒŒí‹°ì…˜ í‚¤ë¡œ í™œìš©í•˜ì—¬ `we_mart.ws_order` í…Œì´ë¸”ì„ íŒŒí‹°ì…˜
    - ```sql
      create or replace table we_mart.ws_order_by_member
      (
      run_timestamp	timestamp
      ,	ord_cre_dt	timestamp	comment	'ì£¼ë¬¸ìƒì„±ì¼'
      ,	ord_upd_dt	timestamp	comment	'ì£¼ë¬¸ì—…ë°ì´íŠ¸ì¼'
      ,	pay_dt	timestamp	comment	'ê²°ì œì—…ë°ì´íŠ¸ì¼(ê²°ì œì™„ë£Œì¼ë¡œ ê°„ì£¼)'
      ,	cx_dt	timestamp	comment	'ìµœì´ˆ ì·¨ì†Œì¼ì‹œ'
      ,	deliv_completed_date	timestamp	comment	'ë°°ì†¡ì™„ë£Œì¼'
      ,	we_member_id	bigint	comment	'we_member_id'
      ,	ws_user_id	bigint	comment	'ìœ„ë²„ìŠ¤ìƒµ user id'
      ,	is_fc	int	comment	'êµ¬ë§¤ì‹œ ë©¤ë²„ì‹­ ìƒíƒœ ì—¬ë¶€'
      ,	pay_seq	int	comment	'ê²°ì œì„±ê³µ ìˆœë²ˆ'
      ,	pay_ok_seq	int	comment	'ê²°ì œì„±ê³µ & ì£¼ë¬¸ì™„ë£Œìƒíƒœ ìˆœë²ˆ'
      ,	shop	string	comment	'shop'
      ,	ord_sheet_id	bigint	comment	'ì£¼ë¬¸ id'
      ,	ord_sheet_number	bigint	comment	'ì£¼ë¬¸ë²ˆí˜¸'
      ,	ord_item_id	bigint	comment	'ì£¼ë¬¸ìƒí’ˆ id'
      ,	sale_id	bigint	comment	'íŒë§¤ id'
      ,	sale_stock_id bigint comment 'íŒë§¤ìƒí’ˆ ì˜µì…˜ id'
      ,	goods_id	bigint	comment	'ìƒí’ˆ id'
      ,	goods_code	string	comment	'ìƒí’ˆ code'
      ,	goods_option_id	bigint	comment	'ìƒí’ˆ ì˜µì…˜ id'
      ,	goods_option_code	string	comment	'ìƒí’ˆ ì˜µì…˜ code'
      ,	sap_code	string	comment	'sap code'
      ,	we_art_id	int	comment	'ì•„í‹°ìŠ¤íŠ¸ id'
      ,	goods_upr_cat_id	bigint	comment	'ìƒìœ„ì¹´í…Œê³ ë¦¬ id'
      ,	goods_lwr_cat_id	bigint	comment	'í•˜ìœ„ì¹´í…Œê³ ë¦¬ id'
      ,	ship_group_id	bigint	comment	'ë°°ì†¡ê·¸ë£¹ id'
      ,	deliv_service_id	bigint	comment	'ë°°ì†¡ì‚¬ id'
      ,	we_art_name	string	comment	'ì•„í‹°ìŠ¤íŠ¸ëª…'
      ,	goods_upr_cat_name	string	comment	'ìƒìœ„ì¹´í…Œê³ ë¦¬'
      ,	goods_lwr_cat_name	string	comment	'í•˜ìœ„ì¹´í…Œê³ ë¦¬'
      ,	goods_cat	string	comment	'ìƒí’ˆêµ¬ë¶„'
      ,	logi_cat	string	comment 'ë¬¼ë¥˜ ì¹´í…Œê³ ë¦¬'
      ,	goods_name	string	comment	'ìƒí’ˆëª…'
      ,	goods_option_name string comment 'ìƒí’ˆ ì˜µì…˜ëª…'
      ,	is_pay	int	comment	'ê²°ì œì—¬ë¶€'
      ,	is_pay_waiting int comment 'í¸ì˜ì  ê²°ì œ íœë”© ì—¬ë¶€'
      ,	is_pay_waiting_exceed int comment 'í¸ì˜ì  ê²°ì œ ì…ê¸ˆì¼ ì´ˆê³¼ ì—¬ë¶€'
      ,	is_status_ok	int	comment	'ì£¼ë¬¸ì™„ë£Œìƒíƒœ ì—¬ë¶€'
      ,	is_cx	int comment 'ì·¨ì†Œ/í™˜ë¶ˆ ì—¬ë¶€'
      ,	is_admin_ord	int	comment	'ìˆ˜ê¸°ì£¼ë¬¸ ì—¬ë¶€ (1: ìˆ˜ê¸° ì£¼ë¬¸, 0: ì •ìƒ ì£¼ë¬¸ )'
      ,	is_exch_ord	int	comment	'êµí™˜ì£¼ë¬¸ ì—¬ë¶€ (1: êµí™˜ ì£¼ë¬¸, 0: ì •ìƒ ì£¼ë¬¸)'
      ,	ord_status	string	comment	'ì£¼ë¬¸ìƒíƒœ'
      ,	ord_item_qty	int	comment	'ì£¼ë¬¸ìƒí’ˆ ìˆ˜ëŸ‰'
      ,	ord_item_cx_qty	int	comment	'ì·¨ì†Œ/í™˜ë¶ˆìƒí’ˆ ìˆ˜ëŸ‰'
      ,	ord_item_amt	double	comment	'ì£¼ë¬¸ìƒí’ˆ ê¸ˆì•¡'
      ,	ord_item_amt_krw	double	comment	'ì£¼ë¬¸ìƒí’ˆ ê¸ˆì•¡ (KRW)'
      ,	ord_item_cx_amt	double	comment	'ì·¨ì†Œ/í™˜ë¶ˆìƒí’ˆ ê¸ˆì•¡'
      ,	ord_item_cx_amt_krw	double	comment	'ì·¨ì†Œ/í™˜ë¶ˆìƒí’ˆ ê¸ˆì•¡ (KRW)'
      ,	sale_price	double	comment	'íŒë§¤ê¸ˆì•¡'
      ,	album_qty	int	comment	'ì•¨ë²”ìˆ˜ëŸ‰'
      ,	currency_code	string	comment	'í†µí™”'
      ,	currency_rate	double	comment	'í™˜ìœ¨'
      ,	device_type	string	comment	'í´ë¼ì´ì–¸íŠ¸ í”Œë«í¼'
      ,	ship_ctry_code	string	comment	'ë°°ì†¡êµ­ê°€ì½”ë“œ'
      ,	ship_prov_area	string	comment	'ë°°ì†¡ state / Province'
      ,	ship_group_name	string	comment	'ë°°ì†¡ê·¸ë£¹ ì´ë¦„'
      ,	deliv_service_name	string	comment	'ë°°ì†¡ì‚¬ ì´ë¦„'
      ,	deliv_express_code	string	comment	'íŠ¹ì†¡ì‚¬ ì½”ë“œ'
      ,	logistics_type	string	comment	'ë¬¼ë¥˜ì‚¬'
      ,	shipping_postal_code	string	comment	'ìš°í¸ë²ˆí˜¸'
      ,	delivery_status	string	comment	'ë°°ì†¡ìƒíƒœ'
      ,	ship_cost_type 	string	comment	'ë°°ì†¡ êµ¬ë¶„'
      ,	payment_gateway	string	comment	'ê²°ì œ PGì‚¬ (KCP, PAYPAL)'
      ,	payment_method	string	comment	'ê²°ì œ ìˆ˜ë‹¨'
      ,	pay_card_type	string	comment	'ê²°ì œ ì‹ ìš©ì¹´ë“œ ì¢…ë¥˜'
      ,	pay_mobile_provider string comment  'ê²°ì œ ëª¨ë°”ì¼ í†µì‹ ì‚¬'
      ,	ctry_code	string	comment	'user êµ­ê°€ì½”ë“œ'
      ,	ip	string	comment	'user ip'
      ,	trade_co_name	string	comment	'ê±°ë˜ì²˜'
      ,	bm_option                                         as bm_option
      ,	pod_option_sell_code                              as pod_option_sell_code
      ,	pod_template_code                                 as pod_template_code
      ,	part_month                                        as part_month
      )
      using DELTA
      partitioned by (we_member_id)
      comment 'ìœ„ë²„ìŠ¤ìƒµ ì£¼ë¬¸ìƒí’ˆì •ë³´ ë§ˆíŠ¸'
      ```
- `we_mart.ws_order` í…Œì´ë¸”ê³¼ `we_mart.ws_goods_stock` í…Œì´ë¸”ì„ `sale_id` ì™€ `goods_option_code` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ ì¡°ì¸
    - ```sql
      select o.ord_sheet_number, g.goods_name, g.goods_upr_cat_name, g.goods_lwr_cat_name
      from we_mart.ws_order o
      join we_mart.ws_goods_stock g on o.sale_id = g.sale_id and o.goods_option_code = g.goods_option_code
      where o.shop = 'GL'
      ```
- `we_mart.ws_order` í…Œì´ë¸”ê³¼ `we_mart.ws_fc_user_history` í…Œì´ë¸”ì„ `we_member_id` ì™€ `we_art_id` ì»¬ëŸ¼ì„ ì´ìš©í•˜ì—¬ ì¡°ì¸
    - ```sql
      select o.ord_sheet_number, f.fc_name, f.create_dt, f.expire_dt
      from we_mart.ws_order o
      join we_mart.ws_fc_user_history f on o.we_member_id = f.we_member_id and o.we_art_id = f.we_art_id
      where o.shop = 'GL'
      and o.is_fc = 1
      ```

### Data Extraction
- `we_art_id` ê°€ "ARTIST" ì´ê³  `goods_cat` ì´ "MEMBERSHIP" ì¸ ìƒí’ˆë“¤ì˜ ì£¼ë¬¸ ì •ë³´ë¥¼ ì¶”ì¶œ
    - ```sql
      select ord_sheet_number, ord_item_id, goods_name, ord_item_qty, ord_item_amt, ord_cre_dt, pay_dt
      from we_mart.ws_order
      where we_art_id = 'ARTIST'
      and goods_cat = 'MEMBERSHIP'
      ```
- "2024-01-01" ì´í›„ "2024-01-15" ê¹Œì§€ì˜ ì£¼ë¬¸ ì¤‘, `is_pay` ê°€ 1 ì´ê³  `is_cx` ê°€ 0 ì¸ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ì¶”ì¶œ
    - ```sql
      select ord_sheet_number, ord_item_id, goods_name, ord_item_qty, ord_item_amt, ord_cre_dt, pay_dt
      from we_mart.ws_order
      where ord_cre_dt >= '2024-01-01'
      and ord_cre_dt <= '2024-01-15'
      and is_pay = 1
      and is_cx = 0
      ```
- "2024-01-01" ì´í›„ "2024-01-15" ê¹Œì§€ì˜ ì£¼ë¬¸ ì¤‘, `is_pay` ê°€ 1 ì´ê³  `is_cx` ê°€ 1 ì¸ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ì¶”ì¶œ
    - ```sql
      select ord_sheet_number, ord_item_id, goods_name, ord_item_qty, ord_item_amt, ord_cre_dt, pay_dt, cx_dt
      from we_mart.ws_order
      where ord_cre_dt >= '2024-01-01'
      and ord_cre_dt <= '2024-01-15'
      and is_pay = 1
      and is_cx = 1
      ```
- "2024-01-01" ì´í›„ "2024-01-15" ê¹Œì§€ì˜ ì£¼ë¬¸ ì¤‘, `is_pay` ê°€ 1 ì´ê³  `is_cx` ê°€ 0 ì´ë©°, `shop` ì´ "GL" ì¸ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ì¶”ì¶œ
    - ```sql
      select ord_sheet_number, ord_item_id, goods_name, ord_item_qty, ord_item_amt, ord_cre_dt, pay_dt
      from we_mart.ws_order
      where ord_cre_dt >= '2024-01-01'
      and ord_cre_dt <= '2024-01-15'
      and is_pay = 1
      and is_cx = 0
      and shop = 'GL'
      ```
- "2024-01-01" ì´í›„ "2024-01-15" ê¹Œì§€ì˜ ì£¼ë¬¸ ì¤‘, `is_pay` ê°€ 1 ì´ê³  `is_cx` ê°€ 0 ì´ë©°, `shop` ì´ "GL" ì´ê³ , `goods_cat` ì´ "MEMBERSHIP" ì¸ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ì¶”ì¶œ
    - ```sql
      select ord_sheet_number, ord_item_id, goods_name, ord_item_qty, ord_item_amt, ord_cre_dt, pay_dt
      from we_mart.ws_order
      where ord_cre_dt >= '2024-01-01'
      and ord_cre_dt <= '2024-01-15'
      and is_pay = 1
      and is_cx = 0
      and shop = 'GL'
      and goods_cat = 'MEMBERSHIP'
      ```  
---
# PIPELINE INFO

## âŒ›ï¸ BATCH

### DAG: `analytics_ws_mart_daily`

### Update Interval: DAILY

### Update Type: OVERWRITE

## ğŸ“ LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/mart/we_mart/ws_order.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_ws_mart_daily.py)
  
    
---
# DEPENDENCIES

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|we_mart.ods_ws_order_item|we_mart.stats_wa_d_album_reg_smry|
|we_mart.ods_ws_order_sheet|we_mart.stats_we_d_integ_visit|
|we_mart.ods_ws_payment_transaction|we_mart.stats_we_m_order_first|
|we_mart.ods_ws_shipping_group|we_mart.stats_we_m_order_first_seq|
|we_mart.ods_ws_user|we_mart.stats_ws_d_album_cross_ord_by_art|
|we_mart.we_id_mapping|we_mart.stats_ws_d_album_cumul|
|we_mart.ws_fc_user_history|we_mart.stats_ws_d_album_cumul_age|
|we_mart.ws_goods_stock|we_mart.stats_ws_d_album_cumul_kpi|
|we_mart.ws_order|we_mart.stats_ws_d_album_retention|
|we_mart.ws_user_ctry_history|we_mart.stats_ws_d_deliv|
|we_meta.currency_rate|we_mart.stats_ws_d_deliv_days|
|weverseshop.delivery_service|we_mart.stats_ws_d_deliv_ok|
|weverseshop.express_courier|we_mart.stats_ws_d_funnel_detail|
|weverseshop.order_item_history|we_mart.stats_ws_d_ord_amt|
|weverseshop.order_item_release|we_mart.stats_ws_d_ord_rate|
| |we_mart.stats_ws_d_ord_shop_integ|
| |we_mart.stats_ws_d_ord_us|
| |we_mart.stats_ws_d_survey_user_acqr|
| |we_mart.stats_ws_d_survey_user_order|
| |we_mart.stats_ws_d_user_platform|
| |we_mart.stats_ws_h_ord_product_concert|
| |we_mart.stats_ws_h_ord_product_detail|
| |we_mart.stats_ws_m_ord_deliv_complete|
| |we_mart.stats_wv_d_media_sale|
| |we_mart.stats_wv_d_media_sale_cp|
| |we_mart.view_ipx_ws_order|
| |we_mart.view_wej_ws_order|
| |we_mart.view_ws_pod_order|
| |we_mart.we_fan_order|
| |we_mart.we_l2s_order|
| |we_mart.we_order|
| |we_mart.we_user_dic_engaged_by_project|
| |we_mart.ws_album_sale|
| |we_mart.ws_l2s_order|
| |we_mart.ws_ord_raffle|
| |we_mart.ws_order|
| |we_mart.ws_platform_daily|
| |we_mart.ws_pod_order_history|
| |we_mart.ws_pod_order_resource|

## ğŸ¤ Downstream Tables Info
  
### Downstream Tables
- **we_order** : Weverse í†µí•© ì£¼ë¬¸ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”
    - ws_order í…Œì´ë¸”ì—ì„œ ì£¼ë¬¸, ê²°ì œ, ì·¨ì†Œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ ê°€ê³µí•˜ì—¬ ì €ì¥í•¨
    - `product_source`, `is_pay`, `is_cx`, `is_fc`, `pay_dt`, `cx_dt`, `pay_amt_krw`, `pay_amt`, `cx_amt_krw`, `cx_amt`, `we_art_id`, `we_art_name`, `shop`, `product_type`, `ord_sheet_number`, `transaction_id`, `ord_item_id`, `sale_id`, `sale_price`, `sale_currency_code`, `wbs_code`, `sap_code`, `pay_system`, `pay_method`, `goods_code`, `goods_option_id`, `goods_option_code`, `goods_name`, `goods_option_name`, `goods_upr_cat_id`, `goods_lwr_cat_id`, `goods_upr_cat_name`, `goods_lwr_cat_name`, `dur_type`, `dur_unit`, `dur_value`, `promotion_type`, `promotion_unit`, `promotion_value`, `album_qty`, `logi_cat`, `ship_ctry_code`, `ship_cost_type`, `device_type`, `trade_co_name`, `pay_card_type`, `pay_mobile_provider`, `pay_seq`, `we_pay_seq`, `fc_id`, `fc_name` ì»¬ëŸ¼ì„ ì‚¬ìš©
    - íŠ¹ì • ê¸°ê°„ ë™ì•ˆ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ì˜ ìƒí’ˆ êµ¬ë§¤ ì •ë³´ë¥¼ ì¶”ì¶œí•  ë•Œ ì‚¬ìš©
- **we_l2s_order** : L2S ê´€ë ¨ ìƒí’ˆ íŒë§¤ ë° ë¼ì´ë¸Œ ì‹œì²­ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”
    - ws_order í…Œì´ë¸”ì—ì„œ L2S ìƒí’ˆì— ëŒ€í•œ ì£¼ë¬¸ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ ê°€ê³µí•˜ì—¬ ì €ì¥í•¨
    - `live_post_id`, `live_title`, `live_view_type`, `date_type`, `trx_type`, `we_member_id`, `ctry_code`, `ord_sheet_number`, `ord_item_id`, `shop`, `sale_id`, `sale_stock_id`, `goods_name`, `goods_option_name`, `we_art_id`, `we_art_name`, `album_qty`, `currency_code`, `pay_qty`, `pay_amt`, `pay_krw`, `cx_qty`, `cx_amt`, `cx_krw`, `is_sale_pu`, `is_sale_net_pu`, `is_live_pu`, `is_live_net_pu`, `live_start_dt`, `live_end_dt`, `l2s_sale_start_dt`, `l2s_sale_end_dt` ì»¬ëŸ¼ì„ ì‚¬ìš©
    - íŠ¹ì • ë¼ì´ë¸Œ ë°©ì†¡ ê¸°ê°„ ë™ì•ˆ ìƒí’ˆ êµ¬ë§¤ ì •ë³´ì™€ ë¼ì´ë¸Œ ì‹œì²­ ì •ë³´ë¥¼ í•¨ê»˜ ì¶”ì¶œí•  ë•Œ ì‚¬ìš©
- **ws_pod_order_resource** : ì£¼ë¬¸ìƒí’ˆë³„ ì‚¬ìš© ë¦¬ì†ŒìŠ¤ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”
    - ws_order í…Œì´ë¸”ì—ì„œ POD ìƒí’ˆì— ëŒ€í•œ ì£¼ë¬¸ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ ê°€ê³µí•˜ì—¬ ì €ì¥í•¨
    - `pod_resource_id`, `resource_category`, `resource_category_code`, `type`, `sub_type`, `keyword`, `resource_qty` ì»¬ëŸ¼ì„ ì‚¬ìš©
    - íŠ¹ì • POD ìƒí’ˆì— ëŒ€í•œ ì£¼ë¬¸ ê±´ ë³„ ì‚¬ìš©ëœ ë¦¬ì†ŒìŠ¤ ì •ë³´ë¥¼ ì¶”ì¶œí•  ë•Œ ì‚¬ìš©

### Downstream View Tables
- **None** : í•´ë‹¹ í…Œì´ë¸”ì€ view í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ  
---