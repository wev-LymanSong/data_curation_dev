
we_meta.ws_album
================

# BASIC INFO

|**About**| 담당자 수기 입력 필요 |
| :--- | :--- |
|**Database**|**we_meta**|
|**Table Type**|META PRIMARY|
|**Partitioned by**|`part_date`|
|**Created/ Last Updated At**|2022-11-15 / 2024-09-11|
|**Created By**|송재영|
|**Last Updated By**|송재영|
|**Collaborators**|송재영[40], 구민서[1], 이현지[1]|
  
#### Change History
|**Date**|**By**|**LINK**|
| :--- | :--- | :--- |
|2022-11-15|송재영|[PR](https://github.com/benxcorp/databricks/commit/9fbde08e235e8eba8229a9da66f15370d1335865)|
|2022-11-25|송재영|[PR](https://github.com/benxcorp/databricks/commit/2770e9fda94536cec2f45e2419a9c468a339726c)|
|2022-11-25|이현지|[PR](https://github.com/benxcorp/databricks/commit/60ea38cf517849d2485bcefe77f5688cb8b17205)|
|2022-11-25|송재영|[PR](https://github.com/benxcorp/databricks/commit/0176556a6c2f3e5cda65645ab2fbb616f6b976be)|
|2022-12-12|구민서|[PR](https://github.com/benxcorp/databricks/commit/84b36e9af61538ef2350e9eb200b0e4201115c5a)|
|2022-12-14|송재영|[PR](https://github.com/benxcorp/databricks/commit/9d82b8b8af6515649bad70defc8c32408bed107e)|
|2023-01-08|송재영|[PR](https://github.com/benxcorp/databricks/commit/3b936ca2cab487137177c384cc121ec16385d94f)|
|2023-01-16|송재영|[PR](https://github.com/benxcorp/databricks/commit/6f74272a9dfeb68da1f9d04adfe1d852ad18659c)|
|2023-01-17|송재영|[PR](https://github.com/benxcorp/databricks/commit/9b54e1e3826f0119fbc2ad0c975c3e6751135088)|
|2023-01-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/5b82769dd35750f21dbd129d0eccebff10ae2d64)|
|2023-02-06|송재영|[PR](https://github.com/benxcorp/databricks/commit/77568161a6c5b1b66a3be9ff26617b052c1891bd)|
|2023-04-03|송재영|[PR](https://github.com/benxcorp/databricks/commit/65e038cf18a8962c170afd66ee1687b49a999b57)|
|2023-04-03|송재영|[PR](https://github.com/benxcorp/databricks/commit/ee6f4e578599564d4ce28dd810c23d2442112d83)|
|2023-07-10|송재영|[PR](https://github.com/benxcorp/databricks/commit/3d6efbce589f558480cd54e3db4c4f940a884b25)|
|2023-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/0df00a2ed3232888b261a5cab2a9368f681562a3)|
|2023-07-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/ba0b36a59e559e7392257c9dc9c8fd845b887cbd)|
|2023-07-24|송재영|[PR](https://github.com/benxcorp/databricks/commit/b90d54260f332e970a11afeca1e3d960be69141d)|
|2023-08-10|송재영|[PR](https://github.com/benxcorp/databricks/commit/cf8e35eb5e00737da0c3bd8f60c9c60ce1765ea9)|
|2023-11-09|송재영|[PR](https://github.com/benxcorp/databricks/commit/9cc0866a5e12ae7acb9c43e45a02fc321795cb28)|
|2023-11-28|송재영|[PR](https://github.com/benxcorp/databricks/commit/ac65bb6aafb3daf04f286b67731c8d044025ed85)|
|2023-12-05|송재영|[PR](https://github.com/benxcorp/databricks/commit/8382167311795bb02430ab3fa21e54dc93edb94a)|
|2023-12-06|송재영|[PR](https://github.com/benxcorp/databricks/commit/46fd18593811fb0da0631d03d45463bd85e6543d)|
|2023-12-06|송재영|[PR](https://github.com/benxcorp/databricks/commit/178365913f8ce920d84182238029ff95ff6f11ac)|
|2023-12-22|송재영|[PR](https://github.com/benxcorp/databricks/commit/3cbb388260e84f6906e9ecfc80e74ef79f094ab4)|
|2024-01-18|송재영|[PR](https://github.com/benxcorp/databricks/commit/31d6dad40b2a2fbadbf1a3c04468c5212907b345)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/92bfbafa78a8a9f92f51600f91cf2c1cb802c65c)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/7895d81a3f653dafe31494b400dd6ea3596c83a6)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/3088b6f0cacb39b3d79bd07b42fc37b3f3b3f65c)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/824608a1e618d81df839ecbb6cd78f760bdd57f7)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/4255dbad44c750136a7cd771669fd282af328111)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/08f2d9a5e6e8e34a82db475175a1e5c388006741)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/bebc98dfde69013a7d81e9a371732504ac306760)|
|2024-01-29|송재영|[PR](https://github.com/benxcorp/databricks/commit/0bfce2b41407d8afac279c151a2a9a0f10b0e8fa)|
|2024-01-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/c9069eb99e85027446319aaa50ffc916fb565596)|
|2024-01-30|송재영|[PR](https://github.com/benxcorp/databricks/commit/8f92dfd75e6a5cca490aa7066beaed8fdda4cc34)|
|2024-02-20|송재영|[PR](https://github.com/benxcorp/databricks/commit/766d7b2eef166387b7de30b0d08cf383101c1dff)|
|2024-02-23|송재영|[PR](https://github.com/benxcorp/databricks/commit/6ea3dc08ed3a1f38fac892a0285bcb9f6418efe2)|
|2024-02-28|송재영|[PR](https://github.com/benxcorp/databricks/commit/46f2719d9c25d04ea579ceb487ad5742218f6cff)|
|2024-04-06|송재영|[PR](https://github.com/benxcorp/databricks/commit/a6d82bc9ad102f6cfc48d44d6924a3c5f35f2a1a)|
|2024-07-23|송재영|[PR](https://github.com/benxcorp/databricks/commit/0c338393af4591a2d25497f2250a3ce8ba33f5bd)|
|2024-09-02|송재영|[PR](https://github.com/benxcorp/databricks/commit/ebcd3ffe83009bdd34820ea57fce2104e475d7a1)|
|2024-09-11|송재영|[PR](https://github.com/benxcorp/databricks/commit/510c5593b7f9aba61dad8d0ec9d176f950489260)|
  
  
# TABLE NOTICE
  
### 테이블 개요

*   **테이블 목적**: 위버스샵에서 판매되는 앨범 상품에 대한 메타 정보를 담고 있는 테이블
*   **데이터 레벨**: META DATA
*   **파티션 키**: `part_date`
*   **주요 키**: `album_id`

### 테이블 Sources

*   내부 데이터
    *   `we_meta.ws_album_not_null_list`: 앨범 상품에 대한 필수 메타 정보를 담고 있는 테이블. 필수 입력 항목과 자동 생성 항목으로 구성됨.
    *   `we_mart.we_artist`: 아티스트 정보를 담고 있는 테이블. `we_art_id`, `we_art_name` 등의 컬럼을 제공.
    *   `weverseshop.goods`: 위버스샵 상품 정보를 담고 있는 테이블. `goods_id`와 `goods_name` 컬럼을 제공.
    *   `weverseshop.goods_option`: 위버스샵 상품 옵션 정보를 담고 있는 테이블. `goods_option_id`, `goods_option_code`, `goods_option_name` 컬럼을 제공.
    *   `weverseshop.goods_option_group`: 위버스샵 상품 옵션 그룹 정보를 담고 있는 테이블. `album_quantity` 컬럼을 제공.
    *   `weverseshop.stock`: 위버스샵 재고 정보를 담고 있는 테이블. `stock_id` 컬럼을 제공.
    *   `weverseshop.sale`: 위버스샵 판매 정보를 담고 있는 테이블. `sale_id` 컬럼을 제공.
    *   `weverseshop.goods_translation`: 위버스샵 상품 번역 정보를 담고 있는 테이블. `goods_name` 컬럼을 제공.
    *   `weverseshop.sale_stock`: 위버스샵 판매 재고 정보를 담고 있는 테이블. `sale_stock_id` 컬럼을 제공.
    *   `weverseshop.goods_goods_category`: 위버스샵 상품 카테고리 정보를 담고 있는 테이블. `goods_category_id` 컬럼을 제공.
    *   `weverseshop.goods_category`: 위버스샵 카테고리 정보를 담고 있는 테이블. `label_artist_id` 컬럼을 제공.
    *   `we_meta.ws_album_id`: 앨범에 대한 고유 ID를 담고 있는 테이블. `album_name`과 `we_art_id`로 ID를 생성.

### 데이터 추출 및 생성 과정

1.  **앨범 상품 정보 가져오기**:
    *   `weverseshop.goods` 테이블에서 `goods_id`, `goods_name` 등의 정보를 가져온다.
    *   `weverseshop.goods_option_group` 테이블에서 `album_quantity` 컬럼을 가져온다.
    *   `weverseshop.sale` 테이블에서 `sale_id`를 가져온다.
    *   `weverseshop.goods_translation` 테이블에서 `goods_name` 컬럼을 가져온다.
    *   `we_mart.we_artist` 테이블에서 `we_art_id`, `we_art_name` 등의 정보를 가져온다.
    *   `weverseshop.sale_stock` 테이블에서 `sale_stock_id` 컬럼을 가져온다.
    *   `weverseshop.goods_goods_category` 테이블에서 `goods_category_id` 컬럼을 가져온다.
    *   `weverseshop.goods_category` 테이블에서 `label_artist_id` 컬럼을 가져온다.
    *   `we_meta.ws_album_not_null_list` 테이블에서 앨범 메타 정보를 가져온다.
    *   `we_meta.ws_album_id` 테이블에서 앨범 ID를 가져온다.
2.  **데이터 전처리**:
    *   앨범 명, 아티스트 명 등의 컬럼을 기준으로 중복 제거를 수행한다.
    *   `album_scm_option_type` 컬럼을 `MapType`으로 변환한다.
    *   `is_wev_exclusive` 컬럼을 `tinyint`로 변환한다.
    *   `is_wa_included` 컬럼을 `tinyint`로 변환한다.
    *   `is_enable` 컬럼을 `tinyint`로 변환한다.
3.  **데이터 통합**:
    *   위 과정에서 가져온 데이터를 `we_meta.ws_album` 테이블에 통합한다.
    *   앨범 ID가 없는 경우 `we_meta.ws_album_id` 테이블에서 새 ID를 생성하여 추가한다.
    *   `sale_id`, `goods_id`, `goods_option_id`, `stock_id` 등의 컬럼을 `array` 타입으로 변환한다.
4.  **최종 테이블 생성**:
    *   데이터를 `we_meta.ws_album` 테이블에 `append` 모드로 저장한다.
    *   `part_date` 컬럼을 파티션 키로 사용하여 데이터를 분할 저장한다.

### 테이블 활용 가이드

*   **주요 타겟 분야**: 위버스샵 앨범 상품의 메타 정보를 분석하고, 앨범 판매 현황, 아티스트별 앨범 정보 등을 파악하는 데 사용
*   **조인 시 유의사항**:
    *   `we_meta.ws_album` 테이블은 `we_meta.ws_album_not_null_list` 테이블에서 가져온 데이터를 기반으로 생성된다. 따라서 `we_meta.ws_album_not_null_list` 테이블에 없는 정보는 포함되지 않는다.
    *   `sale_id` 컬럼을 사용하여 `weverseshop.sale` 테이블과 조인하여 앨범 상품의 판매 정보를 추가로 얻을 수 있다.
    *   `goods_id` 컬럼을 사용하여 `weverseshop.goods` 테이블과 조인하여 앨범 상품의 상세 정보를 추가로 얻을 수 있다.
    *   `we_art_id` 컬럼을 사용하여 `we_mart.we_artist` 테이블과 조인하여 아티스트 정보를 추가로 얻을 수 있다.

### 추가 정보

*   `we_meta.ws_album` 테이블은 `we_meta.ws_album_id` 테이블에서 앨범 ID를 가져와 사용한다. `we_meta.ws_album_id` 테이블은 `we_meta.ws_album_not_null_list` 테이블에서 가져온 앨범 정보를 기반으로 앨범 ID를 생성한다.
*   `is_wa_included` 컬럼은 위버스 앨범 포함 여부를 나타내는 컬럼으로, `weverseshop.sale` 테이블의 `shop_tags` 컬럼에서 'WEVERSE_ALBUM' 값이 있는 경우 `1`을, 그렇지 않으면 `0`을 할당한다.
*   `album_scm_option_type` 컬럼은 SCM팀에서 사용하는 앨범 판매 단위 종류를 나타내는 컬럼으로, `MapType`으로 저장된다.
*   `part_date` 컬럼은 데이터 파티션을 위한 컬럼으로, `yyyy-MM-dd` 형식의 문자열로 저장된다.  
---
# COLUMN INFO

|#|Column Name|Data Type|Comment|
| :--- | :--- | :--- | :--- |
|0|ws_label_id|bigint|아티스트 소속 레이블 ID|
|1|ws_label_name|string|아티스트 소속 레이블명|
|2|we_art_id|int|we_art_id|
|3|we_art_name|string|we_art_name|
|4|ws_art_id|bigint|위버스 샵 레이블/아티스트 ID|
|5|artist_name|string|위버스 샵 기준 아티스트명|
|6|album_performer_type|string|앨범 참여 아티스트 구성 유형 (그룹, 유닛, 솔로)|
|7|album_performer_name|string|앨범 참여 아티스트 명(nvl(별칭, 그룹명))|
|8|project_name|string|프로젝트 명|
|9|album_content_type|string|앨범 유형 (싱글, 정규, 미니.. )|
|10|album_content_seq|int|앨범 유형 별 순번(ex, BTS 정규 3집 => 3)|
|11|album_id|int|앨범 고유 번호|
|12|album_name|string|정식 앨범명|
|13|album_alias_list|array<string>|앨범명이 온전한 영어가 아닐 경우 대신 사용 가능한 앨범 별칭 어레이|
|14|album_option_type|string|앨범 패키지 및 형태 구분 (디럭스, 일반, 위버스앨범, 스페셜, 콤팩트, KiT..)|
|15|album_physical_type|string|앨범 물리 형태 구분(실물 앨범 유형)|
|16|album_qty_type|string|앨범 판매 단위 종류 (랜덤, 세트, 옵션 등)|
|17|album_scm_option_type|map<string,int>|SCM팀 사용 앨범 판매 단위 종류|
|18|album_release_date|date|앨범 발매일|
|19|album_cumulative_date|date|앨범 초동 판매 마감일|
|20|album_qty|int|판매 단위당 앨범 수량|
|21|shop|string|판매 숍|
|22|target_ctry|string|타깃국가 (글로벌, 일본)|
|23|sale_id|bigint|판매 ID|
|24|stock_ids|array<bigint>|입고 ID list|
|25|sale_stock_ids|array<bigint>|판매 상품 옵션 ID list|
|26|is_wev_exclusive|tinyint|위버스 독점 판매 여부|
|27|sale_start_date|date|상품 판매 시작일|
|28|goods_id|int|상품 ID|
|29|goods_name|string|상품명|
|30|sap_codes|array<string>|SAP 코드 리스트|
|31|goods_option_values|array<struct>|상품 옵션 ID, CODE, 명|
|32|is_wa_included|int|위버스 앨범 여부|
|33|is_enable|int|상품 사용가능 여부|
|34|upd_by|string|마지막 입력자|
|35|upd_date|date|마지막 입력일|
|36|run_timestamp|timestamp|데이터 입력 일시|
|37|part_date|string|파티션 일자|
  
    
---
# HOW TO USE
  
`
### Downstream Table/View
- `ws_album` 테이블을 이용하여 해당 아티스트의 앨범 정보를 조회하는 뷰를 생성
    - ```sql
      create or replace view wev_prod.we_mart.view_artist_album_info as
      select
      a.we_art_id, a.we_art_name, a.ws_art_id, a.artist_name, a.album_id, a.album_name, a.album_release_date, a.album_cumulative_date, a.album_qty_type, a.album_option_type, a.album_physical_type, a.is_wev_exclusive, a.is_wa_included, a.target_ctry, a.sale_id, a.goods_id, a.goods_name, a.sap_codes, a.goods_option_values, a.is_enable, a.upd_by, a.upd_date
      from wev_prod.we_meta.ws_album a
      where a.we_art_id = ARTIST
      and a.part_date = '2024-01-01'
      ```

- `ws_album` 테이블을 이용하여 해당 앨범의 판매 정보를 조회하는 뷰를 생성
    - ```sql
      create or replace view wev_prod.we_mart.view_album_sales_info as
      select
      a.album_id, a.album_name, a.album_release_date, a.album_cumulative_date, a.sale_id, a.goods_id, a.goods_name, a.is_wev_exclusive, a.is_wa_included, a.target_ctry, a.album_qty, a.album_qty_type, a.album_option_type, a.album_physical_type, a.shop, a.is_enable, a.upd_by, a.upd_date
      from wev_prod.we_meta.ws_album a
      where a.album_id = ALBUM_ID
      and a.part_date = '2024-01-01'
      ```

- `ws_album` 테이블을 이용하여 해당 아티스트의 최신 앨범 정보를 조회하는 뷰를 생성
    - ```sql
      create or replace view wev_prod.we_mart.view_artist_latest_album_info as
      select
      a.we_art_id, a.we_art_name, a.ws_art_id, a.artist_name, a.album_id, a.album_name, a.album_release_date, a.album_cumulative_date, a.album_qty_type, a.album_option_type, a.album_physical_type, a.is_wev_exclusive, a.is_wa_included, a.target_ctry, a.sale_id, a.goods_id, a.goods_name, a.sap_codes, a.goods_option_values, a.is_enable, a.upd_by, a.upd_date
      from wev_prod.we_meta.ws_album a
      where a.we_art_id = ARTIST
      and a.part_date = (select max(part_date) from wev_prod.we_meta.ws_album)
      ```

### Data Extraction
- `ws_album` 테이블에서 해당 아티스트의 앨범 정보를 추출
    - ```sql
      select we_art_id, we_art_name, album_id, album_name, album_release_date, album_cumulative_date, album_qty_type, album_option_type, album_physical_type, is_wev_exclusive, is_wa_included, target_ctry
      from wev_prod.we_meta.ws_album
      where we_art_id = ARTIST
      and part_date = '2024-01-01'
      ```

- `ws_album` 테이블에서 해당 앨범의 판매 정보를 추출
    - ```sql
      select album_id, album_name, album_release_date, album_cumulative_date, sale_id, goods_id, goods_name, is_wev_exclusive, is_wa_included, target_ctry, album_qty, album_qty_type, album_option_type, album_physical_type, shop, is_enable, upd_by, upd_date
      from wev_prod.we_meta.ws_album
      where album_id = ALBUM_ID
      and part_date = '2024-01-01'
      ```

- `ws_album` 테이블에서 최신 앨범 발매 정보를 추출 (최신 앨범 정보는 `part_date` 컬럼을 통해 파악)
    - ```sql
      select we_art_id, we_art_name, album_id, album_name, album_release_date, album_cumulative_date, album_qty_type, album_option_type, album_physical_type, is_wev_exclusive, is_wa_included, target_ctry
      from wev_prod.we_meta.ws_album
      where part_date = (select max(part_date) from wev_prod.we_meta.ws_album)
      ```

- `ws_album` 테이블에서 해당 아티스트의 앨범 발매 정보를 추출 (앨범 발매일 기준으로 정렬)
    - ```sql
      select we_art_id, we_art_name, album_id, album_name, album_release_date, album_cumulative_date, album_qty_type, album_option_type, album_physical_type, is_wev_exclusive, is_wa_included, target_ctry
      from wev_prod.we_meta.ws_album
      where we_art_id = ARTIST
      and part_date = '2024-01-01'
      order by album_release_date
      ```  
---
# PIPELINE INFO

## ⌛️ BATCH

### DAG: `analytics_we_mart_hourly`

### Update Interval: HOURLY

### Update Type: APPEND

## 📍 LINK URLs

### Github: [Source Code](https://github.com/benxcorp/databricks/blob/main/src/data_analytics/meta/we_meta/ws_album.py)

### Airflow: [DAG](https://github.com/benxcorp/dp-airflow/blob/main/dags/utils/dynamic_dag/wev/task_list/analytics_we_mart_hourly.py)
  
    
---
# DEPENDENCIES

## 👨‍👩‍👧‍👦 Up/Downstream Table List

|Upstream Tables|Downstream Tables|
| :--- | :--- |
|we_mart.we_artist|we_mart.stats_wa_d_album_reg_smry|
|we_meta.ws_album|we_mart.stats_ws_d_album_cross_ord_by_art|
|we_meta.ws_album_id|we_mart.stats_ws_d_album_cumul|
|we_meta.ws_album_not_null_list|we_mart.stats_ws_d_album_cumul_age|
|weverseshop.goods|we_mart.stats_ws_d_album_cumul_kpi|
|weverseshop.goods_category|we_mart.stats_ws_d_album_retention|
|weverseshop.goods_goods_category|we_mart.stats_ws_d_album_sale|
|weverseshop.goods_option|we_mart.stats_ws_d_album_sale_scm|
|weverseshop.goods_option_group|we_mart.stats_ws_d_bulk_user_sales|
|weverseshop.goods_stock|we_mart.stats_wv_d_ops_sales|
|weverseshop.goods_translation|we_mart.ws_album_sale|
|weverseshop.sale|we_mart.ws_d_bulk_user_sales|
|weverseshop.sale_stock|we_meta.ws_album|
|weverseshop.stock|we_meta.ws_album_info|
| |we_meta.ws_album_latest|

## 🐤 Downstream Tables Info
  
### Downstream Tables
- **`we_mart.ws_album_sale`**: 위버스샵 앨범 판매 데이터를 담은 테이블. `ws_album` 테이블을 조인하여 앨범 정보를 추가하고, `ws_order` 테이블을 조인하여 주문 정보를 추가하여 앨범 판매 데이터를 생성.
    - `ws_album` 테이블의 `sale_id` 컬럼을 사용하여 `ws_order` 테이블과 조인하고, `album_id`, `album_name`, `we_art_id`, `we_art_name` 등 앨범 관련 정보를 추가.
    - 위버스샵 앨범 판매 데이터를 추출할 때, `we_member_id`, `sale_id`, `album_id`, `album_name`, `goods_name` 등의 컬럼을 사용하여 원하는 조건에 맞는 데이터를 추출 가능.
- **`we_mart.wa_album`**: 위버스 앨범 정보를 담은 테이블. `ws_album` 테이블을 조인하여 위버스샵 앨범 정보를 추가.
    - `ws_album` 테이블의 `album_id`, `album_name`, `we_art_id`, `we_art_name` 등 앨범 관련 정보를 조인하여 사용.
    - 위버스 앨범 정보를 추출할 때, `wa_album_id`, `wa_album_name`, `we_art_id`, `we_art_name`, `album_id`, `album_name` 등의 컬럼을 사용하여 원하는 조건에 맞는 데이터를 추출 가능.
- **`we_mart.stats_ws_d_album_sale`**: 일간 앨범 판매 통계를 담은 테이블. `ws_album` 테이블을 조인하여 앨범 정보를 추가하고, `ws_album_sale` 테이블을 사용하여 일별 앨범 판매 데이터를 집계.
    - `ws_album` 테이블의 `album_id`, `album_name`, `we_art_id`, `we_art_name` 등 앨범 관련 정보를 조인하여 사용.
    - 위버스샵 앨범 판매 통계를 추출할 때, `key_date`, `ctry_code`, `album_id`, `album_name`, `ord_pur_cnt`, `ord_pur_amt`, `album_pur_cnt` 등의 컬럼을 사용하여 원하는 조건에 맞는 데이터를 추출 가능.
- **`we_mart.wa_user_album_reg`**: 위버스 앨범 등록 정보를 담은 테이블. `ws_album` 테이블을 조인하여 앨범 정보를 추가.
    - `ws_album` 테이블의 `album_id`, `album_name`, `we_art_id`, `we_art_name` 등 앨범 관련 정보를 조인하여 사용.
    - 위버스 앨범 등록 정보를 추출할 때, `we_member_id`, `wa_album_id`, `wa_album_name`, `album_id`, `album_name`, `cre_dt`, `upd_dt` 등의 컬럼을 사용하여 원하는 조건에 맞는 데이터를 추출 가능.
- **`we_mart.stats_ws_d_album_scm`**: SCM 앨범 판매 통계를 담은 테이블. `ws_album` 테이블을 조인하여 앨범 정보를 추가하고, `ws_album_sale` 테이블을 사용하여 일별 앨범 판매 데이터를 집계.
    - `ws_album` 테이블의 `album_id`, `album_name`, `we_art_id`, `we_art_name`, `album_scm_option_type` 등 앨범 관련 정보를 조인하여 사용.
    - 위버스샵 SCM 앨범 판매 통계를 추출할 때, `key_date`, `shop`, `album_id`, `album_name`, `album_scm_option_name`, `net_pay_album_qty`, `net_pay_scm_qty` 등의 컬럼을 사용하여 원하는 조건에 맞는 데이터를 추출 가능.

### Downstream View Tables
- **`we_meta.ws_album_latest`**: `ws_album` 테이블에서 가장 최근 파티션 날짜의 데이터만 추출한 뷰 테이블.
    - `ws_album` 테이블에서 `part_date` 컬럼을 사용하여 최근 파티션 날짜를 찾고, 해당 날짜의 데이터만 추출.
    - 위버스샵 앨범 메타 정보를 추출할 때, `ws_album_latest` 뷰 테이블을 사용하여 가장 최근의 데이터를 효율적으로 추출 가능.
- **`we_meta.ws_album_info`**: `ws_album` 테이블에서 앨범별 종합 정보를 추출한 뷰 테이블.
    - `ws_album` 테이블에서 `album_id`, `album_name`, `we_art_id`, `we_art_name`, `target_ctry`, `is_wa_included` 등의 컬럼을 사용하여 앨범별 정보를 집계.
    - 위버스샵 앨범 종합 정보를 추출할 때, `ws_album_info` 뷰 테이블을 사용하여 앨범별 정보를 효율적으로 추출 가능.  
---